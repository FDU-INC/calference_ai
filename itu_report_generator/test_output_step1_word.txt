=== R-REC-F.1336-5-201901-I!!MSW-E.docx ===
Foreword
The role of the Radiocommunication Sector is to ensure the rational, equitable, efficient and economical use of the radio-frequency spectrum by all radiocommunication services, including satellite services, and carry out studies without limit of frequency range on the basis of which Recommendations are adopted.
The regulatory and policy functions of the Radiocommunication Sector are performed by World and Regional Radiocommunication Conferences and Radiocommunication Assemblies supported by Study Groups.
Policy on Intellectual Property Right (IPR)
ITU-R policy on IPR is described in the Common Patent Policy for ITU-T/ITU-R/ISO/IEC referenced in Resolution ITU-R 1. Forms to be used for the submission of patent statements and licensing declarations by patent holders are available from http://www.itu.int/ITU-R/go/patents/en where the Guidelines for Implementation of the Common Patent Policy for ITU-T/ITU-R/ISO/IEC and the ITU-R patent information database can also be found.
Electronic Publication
, 2019
ITU 2019
All rights reserved. No part of this publication may be reproduced, by any means whatsoever, without written permission of ITU.
RECOMMENDATION  ITU-R  F.1336-5*
Reference radiation patterns of omnidirectional, sectoral and other antennas for the fixed and mobile services for use in sharing studies in the frequency range from 400 MHz to about 70 GHz
(Question ITU-R 242-2/5)
(1997-2000-2007-2012-2014-2019)
Scope
This Recommendation gives reference models of antennas used in the fixed service and in the mobile service. It gives peak and average patterns of omnidirectional and sectoral antennas in the frequency range 400 MHz to about 70 GHz, as well as of low gain directional antennas in the frequency range 1 GHz to about 3 GHz, to be used in sharing studies in the relevant frequency range. The reference radiation patterns should be used in interference assessments, when particular information concerning the real antennas are not available.
Keywords
Fixed service, land mobile service, reference radiation pattern, sectoral antenna, omni-directional antenna, peak side-lobe pattern, average side-lobe pattern, azimuth and elevation beamwidths, cross polarization, RF sharing studies
The ITU Radiocommunication Assembly,
considering
a)	that, for coordination studies and for the assessment of mutual interference between point-to-multipoint (P-MP) fixed wireless systems (FWSs) or systems in the land mobile service (LMS), and between stations of such systems and stations of space radiocommunication services sharing the same frequency band, it may be necessary to use reference radiation patterns for FWS or LMS base station antennas;
b)	that, depending on the sharing scenario, it may be appropriate to consider the peak envelope or average side-lobe patterns in the sharing studies;
c)	that it may be appropriate to use the antenna radiation pattern representing average side-lobe levels in the following cases:
–	to predict the aggregate interference to a geostationary or non-geostationary satellite from numerous fixed wireless stations or LMS base stations;
–	to predict the aggregate interference to a fixed wireless station or LMS base stations from many geostationary satellites;
–	to predict interference to a fixed wireless station or LMS base stations from one or more non-geostationary-satellites under continuously varying angles;
–	in any other cases where the use of the radiation pattern representing average side-lobe levels is appropriate;
d)	that reference radiation patterns may be required in situations where information concerning the actual radiation pattern is not available;
e)	that the use of antennas with the best available radiation patterns will lead to the most efficient use of the radio-frequency spectrum;
f)	that at large angular distances from the main beam pattern gain may not fully represent the antenna emissions because of local ground reflections,
noting
that Recommendations ITU-R F.699 and ITU-R F.1245 provide the peak and average reference patterns respectively, for directional antennas to be used in coordination studies and interference assessment in cases not referred to in recommends 1 to 4 below,
recommends
1	that, in the absence of particular information concerning the radiation pattern of the P-MP FWS or LMS base station antenna involved (see Note 1), the reference radiation pattern as stated below should be used for:
1.1	interference assessment between P-MP FWSs or LMS base stations;
1.2	interference assessment between P-MP FWSs or LMS base stations and other stations of services sharing the same frequency band;
2	that, in the frequency range from 400 MHz to about 70 GHz, the following reference radiation patterns should be used in cases involving stations that use omnidirectional (in azimuth) antennas:
2.1	in the case of peak side-lobe patterns referred to in considering b), the following equations should be used for elevation angles that range from −90° to 90° (see Annex 1):
(1a)
with:
(1b)
(1c)
where:
G():	gain relative to an isotropic antenna (dBi)
G0:	the maximum gain in the azimuth plane (dBi)
:	elevation angle relative to the angle of the maximum gain (degrees)
3:	the 3 dB beamwidth in the elevation plane (degrees)
k:	parameter which accounts for increased side-lobe levels above what would be expected for an antenna with improved side-lobe performance (see recommends 2.3 and 2.4).
Figure 13 in Annex 1 compares (1a) equations with elevation measurement of omnidirectional (azimuth) antenna, with improved side-lobe performance (k = 0).
2.2	in the case of average side-lobe patterns referred to in considering c), the following equations should be used for elevation angles that range from −90° to 90° (see Annex 1 and Annex 4):
(1d)
with:
where , 3, G0 and k are defined and expressed in recommends 2.1;
2.3	in cases involving typical antennas operating in the 400 MHz to 3 GHz range, the parameter k should be 0.7;
2.4	in cases involving antennas with improved side-lobe performance in the 400 MHz to 3 GHz range, and for all antennas operating in the 3-70 GHz range, the parameter k should be 0;
2.5	in cases where the antennas in recommends 2.1 through 2.2 operate with a downward electrical tilt, all of the equations in those recommends are valid with the definitions of the following variables (see § 3 in Annex 5):
e:	elevation angle (degrees) by which the tilted radiation patterns are calculated using equations in recommends 2.1 and 2.2
h:	elevation angle (degrees) measured from the horizontal plane at the site of the antenna (−90° ≤ h ≤ 90°: where 90° is the zenith and −90° is the nadir)
:	downward tilt angle, the positive angle (degrees) that the main beam axis is below the horizontal plane at the site of the antenna.
These are interrelated as follows:
for 	(1e)
for
An electrically tilted radiation gain at h is calculated by using e of equation (1e) instead of  at the equations in recommends 2.1 and 2.2, respectively;
3	that, in the frequency range from 400 MHz to about 70 GHz, the following reference radiation patterns should be used in cases involving stations that use sectoral antennas;
3.1	in the frequency range from 400 MHz to about 6 GHz (see Annex 7):
3.1.1	in the case of peak side-lobe patterns referred to in considering b), the following equations should be used for elevation angles that range from −90° to 90° and for azimuth angles that range from −180° to 180°:
G(,) = G0 + Ghr(xh) + R·Gvr(xv)                (dBi)	(2a1)
where:
Ghr(xh):	relative reference antenna gain in the azimuth plane at the normalized direction of (xh,0) (dB)
xh = 	|φ|/φ3
: 	azimuth angle relative to the angle of the maximum gain in the horizontal plane (degrees)
3: 	the 3 dB beamwidth in the azimuth plane (degrees) (generally equal to the sectoral beamwidth)
Gvr(xv): 	relative reference antenna gain in the elevation plane at the normalized direction of (0, xv) (dB)
xv = 	|θ|/θ3
R: 	horizontal gain compression ratio as the azimuth angle is shifted from 0° to , as shown below:
(2a2)
Other variables are as defined in recommends 2.1;
3.1.1.1	the relative minimum gain (dB), G180, can be calculated as follows:
(2b1)
where:
kp: 	parameter which accomplishes the relative minimum gain for peak side-lobe patterns
3.1.1.1.1	in cases involving typical antennas the parameter kp should be 0.7 (see Note 2);
3.1.1.1.2	in cases involving antennas with improved side-lobe performance the parameter kp should be also 0.7, which also applies for IMT base station antennas (see Note 2);
3.1.1.2	the relative reference antenna gain in the azimuth plane;
for	xh  0.5
for	0.5 < xh 	(2b2)
Ghr(xh)  G180
where:
kh: 	azimuth pattern adjustment factor based on leaked power (0 ≤ kh ≤ 1)
3.1.1.2.1	in cases involving typical antennas the parameter kh should be 0.8 (see Note 2);
3.1.1.2.2	in cases involving antennas with improved side-lobe performance the parameter kh should be 0.7, which also applies for IMT base station antennas (see Note 2);
3.1.1.3	the relative reference antenna gain in the elevation plane:
for  xv < xk
for  xk ≤ xv < 4	(2b3)
for  4 ≤ xv < 90°/3
Gvr (xv) = G180	for  xv ≥90°/3
where:
kv: 	elevation pattern adjustment factor based on leaked power (0 ≤ kv ≤ 1)
xk =
λkv =	12 – Clog(4) –10log(4–1.5 + kv)
the attenuation incline factor of C is represented as follows (see Note 3):
3.1.1.3.1	in cases involving typical antennas the parameter kv should be 0.7 (see Note 2);
3.1.1.3.2	in cases involving antennas with improved side-lobe performance the parameter kv should be 0.3, which also applies for IMT base station antennas (see Note 2);
3.1.2	in the case of average side-lobe patterns referred to in considering c), for use in a statistical interference assessment, the following equations should be used for elevation angles that range from −90° to 90° and for azimuth angles that range from −180° to 180°:
G(,) = G0 + Ghr(xh) + R·Gvr(xv)                (dBi)
3.1.2.1	the relative minimum gain, G180, calculated as follows:
(2c1)
where:
ka: 	parameter which accomplishes the relative minimum gain for average side-lobe patterns
3.1.2.1.1	in cases involving typical antennas the parameter ka should be 0.7 (see Note 2);
3.1.2.1.2	in cases involving antennas with improved side-lobe performance the parameter ka should be also 0.7, which also applies for IMT base station antennas (see Note 2);
3.1.2.2	the relative reference antenna gain in the azimuth plane:
for	xh  0.5
for	0.5 < xh	(2c2)
Ghr(xh) ≥ G180
where:
.
3.1.2.2.1	in cases involving typical antennas the parameter kh should be 0.8 (see Note 2);
3.1.2.2.2	in cases involving antennas with improved side-lobe performance the parameter kh should be 0.7, which also applies for IMT base station antennas (see Note 2);
3.1.2.3	the relative reference antenna gain in the elevation plane:
for  xv < xk
for  xk ≤ xv < 4	(2c3)
for  4 xv < 90°/3
Gvr (xv)  = G180	for  xv ≥ 90°/3
where:
λkv = 12 – Clog(4) –10log(4–1.5 + kv)
the attenuation incline factor of C is represented as follows (see Note 3):
3.1.2.3.1	in cases involving typical antennas the parameter kv should be 0.7 (see Note 2):
3.1.2.3.2	in cases involving antennas with improved side-lobe performance the parameter kv should be 0.3, which also applies for IMT base station antennas (see Note 2);
3.2 	in the frequency range from 6 GHz to about 70 GHz (see Annex 6):
3.2.1	in the case of peak side-lobe patterns referred to in considering b), the following equations should be used for elevation angles that range from −90° to 90° and for azimuth angles that range from –180° to 180°:
(2d1)
(2d2)
for    	(2d3)
for
,      	(2d4)
(2d5)
where:
3m:	the equivalent 3 dB beamwidth in the azimuth plane for an adjustment of horizontal gains (degrees)
for   	(2d6)
for   	(2d7)
th: 	the boundary azimuth angle (degrees)
th = 3
Other variables and parameters are as defined in recommends 2.1 and 3.1.1;
for	0 ≤ x < 1	(2e)
for	1 ≤ x
3.2.2	in the case of average side-lobe patterns referred to in considering c), for use in a statistical interference assessment, the following equations should be used for elevation angles that range from –90° to 90° and for azimuth angles that range from –180° to 180° (see Note 4):
for	0 ≤ x  < 1.152	(2f)
for	1.152 ≤ x
In this case, as for th in equations (2d6) and (2d7), th = 1.1523.
3.3	in cases involving sectoral antennas with a 3 dB beamwidth in the azimuth plane less than about 120°, the relationship between the maximum gain and the 3 dB beamwidth in both the azimuth plane and the elevation plane, on a provisional basis, is (see Annex 2 and Notes 5 and 6):
(3a)
where all parameters are as defined under recommends 3.1;
3.4	in cases where the antennas in recommends 3.1 through 3.2 operate with a downward mechanical tilt, all of the equations in those recommends are valid with the definitions and redefinitions of the following variables (see § 2 in Annex 5):
:	elevation angle (degrees) measured from the plane defined by the axis of maximum gain of the antenna and the axis about which the pattern is tilted (3 is also measured from this plane)
φ:	azimuth (degrees) measured from the azimuth of maximum gain in the plane defined by the axis of maximum gain of the antenna and the axis about which the pattern is tilted
h:	elevation angle (degrees) measured from the horizontal plane at the site of the antenna (−90°≤ h ≤ 90°)
φh:	azimuth angle (degrees) in the horizontal plane at the site of the antenna measured from the azimuth of maximum gain (−180° ≤ h ≤ 180°)
:	downward tilt angle, the positive angle (degrees) that the main beam axis is below the horizontal plane at the site of the antenna
These are interrelated as follows:
,     	(3b)
, (see Note 1 in Annex 5)	(3c)
3.5	in cases where the antennas in recommends 3.1 through 3.2 operate with a downward electrical tilt, an electrically tilted radiation gain at h is also calculated by using e of equation (1e) in recommends 2.5 instead of  at the equations in recommends 3.1 and 3.2, respectively;
4	that, in the frequency range from 1 GHz to about 3 GHz, the following reference radiation patterns should be used in cases involving stations that use low-gain antennas with circular symmetry about the 3 dB beamwidth and with a main lobe antenna gain less than about 20 dBi; see Recommendation ITU-R F.699 for cases where the antenna gain is above 20 dBi.
4.1	the following equations should be used in the case of peak side-lobe patterns referred to in considering b) (see Note 7):
(4)
where:
G():	gain relative to an isotropic antenna (dBi)
G0:	the main lobe antenna gain (dBi)
:	off-axis angle (degrees) (0° ≤  ≤ 180°)
3:	the 3 dB beamwidth in azimuth and elevation of the low-gain antenna (degrees):
(degrees)
1	 1.9 3 (degrees);
2	 1  10(G0 – 6)/32 (degrees)
4.2	in the case of average side-lobe patterns referred to in considering c), the antenna pattern given in Recommendation ITU-R F.1245 should be used;
5	that the following Notes should be regarded as part of this Recommendation:
Note 1 – It is essential that every effort be made to utilize the actual antenna pattern in coordination studies and interference assessment.
NOTE 2 – The values of parameter kh, kv, ka and kp in recommends 3.1 were based on statistical data which were derived from many measured sectoral antenna patterns in the 700 MHz to around 6 GHz frequency range.
NOTE 3 – The formula for the calculation of the incline factor C can be applied only for a 3 dB beamwidth lower than 20 degrees in the elevation plane.
NOTE 4 – Measured results of a specially designed sectoral antenna for use around 20 GHz indicate the possibility of compliance with a more restrictive reference side-lobe radiation pattern. Further studies are required to develop such an optimized pattern.
NOTE 5 – In a case involving an antenna whose 3 dB beamwidth in the elevation or azimuth plane is already known, it is recommended to use the known 3 or φ3 as an input parameter.
NOTE 6 – As discussed in Annex 2, an exponential factor has been replaced by unity. As a result, the theoretical error introduced by this approximation will be less than 6% for 3 dB beamwidths in the elevation plane less than 45 degrees.
NOTE 7 – The reference radiation pattern given in recommends 4.1 primarily applies in situations where the main lobe antenna gain is less than or equal to 20 dBi and the use of Recommendation ITU-R F.699 may produce in some cases inadequate results. Further study is required to establish the full range of frequencies and gain over which the equations are valid.
Annex 1

Reference radiation pattern for omnidirectional antennas
as used in P-MP fixed wireless systems
1	Introduction
An omnidirectional antenna is frequently used for transmitting and receiving signals at central stations of P-MP fixed wireless systems. Studies involving sharing between these types of fixed-wireless systems and space service systems in the 2 GHz bands have used the reference radiation pattern described here.
2	Analysis
The reference radiation pattern is based on the following assumptions concerning the omnidirectional antenna:
–	that the antenna is an n-element linear array radiating in the broadside mode;
–	the elements of the array are assumed to be dipoles;
–	the array elements are spaced 3/4.
The 3 dB beamwidth 3 (degrees) of the array in the elevation plane is related to the directivity D, where the directivity is the ratio of the radiation intensity in a given direction from the antenna to the radiation intensity averaged over all directions (see Annex 2 for more information):
(5a)
Equation (5a) may be solved for 3 when the directivity is known:
(5b)
(5c)
The relationship between the 3 dB beamwidth in the elevation plane and the directivity was derived on the assumption that the radiation pattern in the elevation plane was adequately approximated by:
where m is an arbitrary parameter used to relate the 3 dB beamwidth and the radiation pattern in the elevation plane. At the 3 dB beamwidth the numeric gain f(θ) equals 0.5; therefore, the above equation and exponent m can be calculated as:
and
Using this approximation, the directivity was obtained by integrating the pattern over the elevation and azimuth planes.
The intensity of the far-field of a linear array is given by:
(6)
where:
ET () :	total E-field at an angle of  normal to the axis of the array
Ee() :	E-field at an angle of  normal to the axis of the array caused by a single array element
AF() :	array factor at an angle  normal to the axis of the array.
The normalized E-field of a dipole element is:
(7)
The array factor is:
(8)
where:
N :	number of elements in the array
d :	spacing of the radiators
:	wavelength.
The following procedure has been used to estimate the number of elements N in the array. It is assumed that the maximum gain of the array is identical to the directivity of the array.
–	Given the maximum gain of the omnidirectional antenna in the elevation plane, compute the 3 dB beamwidth, 3, using equations (5b) and (5c);
–	Ignore the small reduction in off-axis gain caused by the dipole element, and note that the array factor, AFN, evaluates to 0.707 (–3 dB) when  and
–	N is then determined as the integer value of:
(9)
where | x | means the maximum integer value not exceeding x.
The normalized off-axis discrimination D is given by:
dB	(10)
Equation (10) has been evaluated as a function of the off-axis angle (i.e. the elevation angle) for several values of maximum gain. For values in the range of 8 dBi to 13 dBi, it has been found that the envelope of the radiation pattern in the elevation plane may be adequately approximated by the following equations:
(11a)
dBi	(11b)
dBi	(11c)
k is a parameter which accounts for increased side-lobe levels above what would be expected for an antenna with improved side-lobe performance.
Figures 1 to 4 compare the reference radiation envelopes with the theoretical antenna patterns generated from equation (11), for gains from 8 dBi to 13 dBi, using a factor of k = 0. Figures 5 to 8 compare the reference radiation envelopes with actual measured antenna patterns using a factor of k = 0. In Figs 7 and 8, it can be seen that the side lobes are about 15 dB or more below the level of the main lobe, allowing for a small percentage of side-lobe peaks which might exceed this value. However practical factors such as the use of electrical downtilt, pattern degradations at band-edges and production variations would further increase the side lobes to about 10 dB below the main lobe in actual field installations. The k factor, mentioned above, in equation (11), is intended to characterize this variation in side-lobe levels. Figures 9 and 10 provide a comparison of a 10 dBi and a 13 dBi gain antenna, at 2.4 GHz, with the reference radiation pattern envelope, using k = 0.5. A factor of k = 0.5 represents side-lobe levels about 15 dB below the main-lobe peak. However, to account for increases in side-lobe levels which may be found in field installations, for typical antennas a factor of k = 0.7 should be used, representing side-lobe levels about 13.5 dB below the level of the main lobe. Finally, Figs 11 and 12 illustrate the effect on elevation patterns of using various values of k.
FIGURE 1
Normalized radiation pattern of a linear array of dipole elements compared
with the approximate envelope of the radiation pattern
G0  10 dBi, k  0
FIGURE 2
Normalized radiation pattern of a linear array of dipole elements compared
with the approximate envelope of the radiation pattern
G0  11 dBi, k  0
FIGURE 3
Normalized radiation pattern of a linear array of dipole elements compared
with the approximate envelope of the radiation pattern
G0  12 dBi, k  0
FIGURE 4
Normalized radiation pattern of a linear array of dipole elements compared
with the approximate envelope of the radiation pattern
G0  13 dBi, k  0
FIGURE 5
Comparison of measured pattern and reference radiation pattern envelope for an omnidirectional
antenna with 11 dBi gain and operating in the band 928-944 MHz, k = 0
FIGURE 6
Comparison of measured pattern and the reference radiation pattern envelope for an omnidirectional
antenna with 8 dBi gain and operating in the band 1 850-1 990 MHz, k = 0
FIGURE 7
Comparison of measured pattern and the reference radiation pattern envelope with k = 0 
for an omnidirectional antenna with 10 dBi gain and operating in the 1.4 GHz band
FIGURE 8
Comparison of measured pattern and the reference radiation pattern envelope with k = 0 
for an omnidirectional antenna with 13 dBi gain and operating in the 1.4 GHz band
figure 9
Comparison of measured pattern and the reference radiation pattern envelope with k = 0.5 
for an omnidirectional antenna with 10 dBi gain and operating in the 2.4 GHz band
figure 10
Comparison of measured pattern and the reference radiation pattern envelope with k = 0.5 
for an omnidirectional antenna with 13 dBi gain and operating in the 2.4 GHz band
FIGURE 11
Reference radiation pattern envelopes for various values of k for an omnidirectional antenna with 10 dBi gain
FIGURE 12
Reference radiation pattern envelopes for various values of k for an omnidirectional antenna with 13 dBi gain
For an antenna with improved side-lobe performance k = 0, Fig. 13 compares the measured elevation pattern of the MT-482016 omnidirectional antenna 5.8 GHz 9.4 dBi (= 8.7) gain, to recommends 2.1 (equation (1a)):  = .
FIGURE 13
Measured elevation pattern versus the reference radiation envelope,
for omnidirectional (in azimuth) antenna, 9.4 dBi gain
3	Summary, conclusions and further analyses
A reference radiation pattern has been presented for omnidirectional antennas exhibiting a gain between 8 dBi and 13 dBi. The reference radiation pattern has been derived on the basis of theoretical considerations of the radiation pattern of a collinear array of dipoles. The proposed pattern has been shown to adequately represent the theoretical patterns and measured patterns over the range from 8 dBi to 13 dBi. Further work is required to determine the range of gain over which the reference radiation pattern is appropriate especially with regard to antennas operating in frequency bands above 3 GHz.
Annex 2

Relationship between gain and beamwidth for omnidirectional
and sectoral antennas
1	Introduction
The purpose of this Annex is to derive the relationship between the gain of omnidirectional and sectoral antennas and their beamwidth in the azimuthal and elevation planes. Section 2 is an analysis of the directivity of omnidirectional and sectoral antennas assuming two different radiation intensity functions in the azimuthal plane. For both cases, the radiation intensity in the elevation plane was assumed to be an exponential function. Section 3 provides a comparison between the gain-beamwidth results obtained using the methods of § 2 and results contained in the previous versions of this Recommendation for omnidirectional antennas. Section 4 summarizes the results, proposes a provisional equation for gain-beamwidth for omnidirectional and sectoral antennas, and suggests areas for further study.
2	Analysis
The far-field pattern of the sectoral antenna in the elevation plane is assumed to conform to an exponential function, whereas the far-field pattern in the azimuth plane is assumed to conform to either a rectangular function or an exponential function. With these assumptions, the directivity, D, of the sectoral antenna may be derived from the following formulation in (spherical coordinates):
(12)
(13)
where:
UM:	maximum radiation intensity
U0:	radiation intensity relative to an isotropic source
:	angle in the azimuthal plane
:	angle in the elevation plane
F():	radiation intensity in the azimuthal plane
F():	radiation intensity in the elevation plane.
The directivity of omnidirectional and sector antennas is evaluated in the following sub-sections assuming the radiation intensity in the azimuthal plane is either a rectangular function or an exponential function.
2.1	Rectangular sectoral radiation intensity
Rectangular sectoral radiation intensity function, F(), is assumed to be:
(14)
where:
s:	beamwidth of the sector
U(x) = 1         for    x  0
(15)
		U(x) = 0         for   x < 0
For either rectangular or exponential sectoral radiation intensity functions, it is assumed that the radiation intensity in the elevation plane is given by:
(16)
where:
(17)
3:	3 dB beamwidth of the antenna in the elevation plane (degrees).
Substituting equations (14) and (16) into equation (13) results in:
(18)
This double integral may be solved as the product of two independent integrals. The integral over  is evaluated in a straightforward way. However, evaluating the integral over  is somewhat more difficult. The integral over  could be evaluated numerically with the results either tabulated or a polynomial fitted to the data. However, it is noted that if the limits of integration are changed to  , the integral over  is given in closed-form by:
(19)
This is a rather simple and flexible formulation that, depending on its accuracy, could be quite useful in evaluating the directivity of sector antennas as well as omnidirectional antennas.
The accuracy with which the infinite integral approximates the finite integral has been evaluated. The finite integral, i.e. the integral on the left-hand side of equation (19), has been evaluated for several values of 3 dB beamwidth using the 24 point Gaussian Quadrature method and compared with the value obtained using the formula corresponding to the infinite integral on the right-hand side of equation (19). (Actually, because of its symmetry, the finite integral has been numerically evaluated over the range 0 to /2 and the result doubled.) The results for a range of example values of the 3 dB beamwidth in the elevation plane are shown in Table 1. The Table shows that for a 3 dB beamwidth of 45°, the difference between the values produced by the finite integral and the infinite integral approximation is less than 0.03%. At 25° and below, the error is essentially zero. Equation (18) is now readily evaluated:
(20)
TABLE 1
Relative accuracy of the infinite integral in equation (19) in the evaluation
of the average radiation intensity
From equations (14) and (16), UM = 1. Substituting these values and equation (20) into equation (12) yields the directivity of a sector antenna given the beamwidth in the elevation and azimuthal planes:
(21)
where the angles are given in radians. When the angles are expressed in degrees, equation (21) becomes:
(22)
Note that for an omnidirectional antenna, equation (22) reduces to:
(23a)
If it is assumed that the radiation efficiency is 100% and that the antenna losses are negligible, then the gain, , and the directivity, D, of the omnidirectional antenna are identical. Additionally, for omnidirectional antennas with a 3 dB elevation beamwidth less than about 45°, the relationship between the gain and the 3 dB beamwidth in the elevation plane may be simplified by setting the exponential factor equal to unity. The resulting error is less than 6%.
(23b)
2.2	Exponential sectoral radiation intensity
The second case considered for the sectoral radiation intensity is that of an exponential function. Specifically:
(24)
where:
(25)
and s is the 3 dB beamwidth of the sector.
Substituting equations (16) and (24) into equation (13), changing the limits of integration so that the finite integrals become infinite integrals, integrating and then substituting the result into equation (12) yields the following approximation:
(26)
where the angles are as defined previously and are expressed in radians. Converting the angles to degrees transforms equation (26) into:
(27)
Comparing equations (22) and (27), it is seen that the difference between the directivity computed using either of the equations is less than 0.3 dB.
The results given by equation (27) should be compared to a number of measured patterns to determine the inherent effect of the radiation efficiency of the antenna and other losses on the coefficient. At this time, only two sets of measurements are available for sectoral antennas designed to operate in the 25.25 GHz to 29.5 GHz band. Measured patterns in the azimuthal and elevation planes are given, respectively, in Figs 14 and 15 for one set of antennas and Figs 16 and 17, respectively, for the second set. From Figs 14 and 15, the 3 dB beamwidth in the azimuthal plane is 90° and the 3 dB beamwidth in the elevation plane is 2.5°. From equation (27), the directivity is 22.1 dBi. This is to be compared with a measured gain of 20.5-21.4 dBi for the antenna over the range 25.5-29.5 GHz. Assuming the gain G0 of the antenna in the band around 28 GHz is 0.7 dB less than its directivity, and the exponential factor is replaced by unity which introduces an increasing error with increasing beamwidth. The error reaches 6% at 45°. A larger beamwidth leads to a larger error. Based on these considerations, the semi-empirical relationship between the gain and the beamwidth of a sectoral antenna is given by:
(28a)
Similarly, from Figs 16 and 17, the semi-empirical relationship between the gain and the beamwidth of that sectoral antenna is:
(28b)
FIGURE 14
Measured pattern in the azimuthal plane of a 90° sector antenna. 
Pattern measured over the band 27.5 GHz to 29.5 GHz.
The band drawn cross marks on the left side of the Figure correspond to values obtained from equation (24)
(when expressed in dB) for an assumed 3 dB beamwidth of 90° in the azimuthal plane
FIGURE 15
Measured pattern in the elevation plane of a 90° sector antenna.
Pattern measured over the band 27.5 GHz to 29.5 GHz
FIGURE 16
Azimuth pattern of typical 90° sectoral antenna (V-polarization)
15 dBi half-value angle: 90° (horn type antenna at 26 GHz)
FIGURE 17
Elevation pattern of typical 90° sectoral antenna (V-polarization)
15 dBi half-value angle: 12° (horn type antenna at 26 GHz)
3	Comparison with previous results for omnidirectional antennas
The purpose of this section is to compare the results obtained for an omnidirectional antenna given by equation (23) with previous results reported in and summarized in Annex 1 of this Recommendation.
The radiation intensity in the elevation plane used in for an omnidirectional antenna was of the form:
(29)
Substituting equation (29) into equation (13), and assuming that F() = 1, yields:
(30)
This double integral evaluates to:
(31)
where (2N)!! is the double factorial defined as (246...(2N)), and (2N + 1)!! is also a double factorial defined as (135...(2N + 1)).
Thus, the directivity becomes:
(32)
The 3 dB beamwidth in the elevation plane is given by:
(33)
A comparison between the directivity computed using the assumptions and methods embodied in equation (23) and those used in the derivation of equations (32) and (33) is given in Table 2. It is shown that results obtained using equation (23a) compare favourably with the results using equations (32) and (33). In all cases equation (23a) slightly underestimates the directivity obtained using equations (32) and (33). The relative error (%) of the estimates, when expressed in dB, is greatest for a 3 dB beamwidth in the elevation plane of 65°, amounting to −2.27%. The error (dB) for this case, expressed in dB, is −0.062 dB. For 3 dB beamwidth angles less than 65°, the relative error (%) and the error (dB), are monotonically decreasing functions as the 3 dB beamwidth decreases. For a 16° 3 dB beamwidth, the relative error (%) is about −0.01% and the error (dB) is less than about −0.0085 dB. An evaluation similar to that shown in Table 2 for values of 2N up to 10 000 (corresponds to a 3 dB beamwidth of 1.35° and a directivity of 19.02 dB) confirms that the results of the two approaches converge.
TABLE 2
Comparison of the directivity of omnidirectional antennas computed using equation (23a)
with the directivity computed using equations (32) and (33)
TABLE 2 (end)
4	Summary and conclusions
Equations have been developed that permit easy calculation of the directivity and the relationship between the beamwidth and gain of omnidirectional and sectoral antennas as used in P-MP radio-relay systems. It is proposed to use the following equations to determine the directivity of sectoral antennas:
(34)
where:
(35)
and s = 3 dB beamwidth of the sectoral antenna in the azimuthal plane (degrees) for an assumed exponential radiation intensity in azimuth and 3 is the 3 dB beamwidth of the sectoral antenna in the elevation plane (degrees).
For omnidirectional antennas, it is proposed to use the following simplified equation to determine the 3 dB beamwidth in the elevation plane given the gain in dBi (see equation (23b)):
It is proposed to use, on a provisional basis, the following semi-empirical equation relating the gain of a sectoral antenna (dBi) to the 3 dB beamwidths in the elevation plane and the azimuthal plane, where the sector is on the order of 120° or less and the 3 dB beamwidth in the elevation plane is less than about 45° (see equation (28a)):
Further study is required to determine how to handle the transition region implicit in equation (35), and to determine the accuracy of these approximations as they apply to measured patterns of sectoral and omnidirectional antennas designed for use in P-MP radio-relay systems for bands in the range from 1 GHz to about 70 GHz.
Annex 3

Procedure for determining the gain of a sectoral antenna at an arbitrary 
off-axis angle specified by an azimuth angle and an elevation angle 
referenced to the boresight of the antenna
1	Analysis
The basic geometry for determining the gain of a sectoral antenna at an arbitrary off-axis angle is shown in Fig. 18. It is assumed that the antenna is located at the centre of the spherical coordinate system; the direction of maximum radiation is along the x-axis; the x-y plane is the local horizontal plane; the elevation plane contains the z-axis; and, u0 is a unit vector whose direction is used to determine the gain of the sectoral antenna. In analysing sectoral antennas in particular, it is important to observe the range of validity of the azimuth and elevation angles:
Also observe that the range of validity of the angle  is
Figure 18
Determining the off-boresight angle given the azimuth and elevation angle of interest
The two fundamental assumptions regarding this procedure are that:
–	the –3 dB gain contour of the far-field pattern when plotted in two-dimensions as a function of the azimuth and elevation angles will be an ellipse as shown in Fig. 19; and
–	the gain of the sectoral antenna at an arbitrary off-axis angle is a function of the 3 dB beamwidth and the beamwidth of the antenna when measured in the plane containing the x-axis and the unit vector u0 (see Fig. 18).
Given the 3 dB beamwidth (degrees) of the sectoral antenna in the azimuth and elevation planes, 3 and 3, the numerical value of the boresight gain is given, on a provisional basis, by (see recommends 3.3 and equation (28a)).
(36)
The first step in evaluating the gain of the sectoral antenna at an arbitrary off-axis angle,  and , is to determine the value of . Referring to Fig. 18 and recognizing that abc is a right-spherical triangle,  is given by:
,       	(37a)
and the off-axis angle in the plane adc is given by:
,      	(37b)
Figure 19
Determination of the 3 dB beamwidth of an elliptical beam at an arbitrary inclination angle
Given that the beam is elliptical, the 3 dB beamwidth of the sectoral antenna in the plane adc in Fig. 18 is determined from:
(38)
Based on this calculation method, the alternative approach (see Annex 6) provides the reference radiation pattern in the frequency range from 6 GHz to about 70 GHz (see recommends 3.2).
2	Conclusion
A procedure has been given to evaluate the gain of a sectoral antenna at an arbitrary off-axis angle as referenced to the direction of the maximum gain of the antenna. The importance of observing the range of validity of the azimuth and elevation angles in modelling the radiation pattern of a sectoral antenna has been emphasized. Further study is required to demonstrate the range of gain and beamwidths in the azimuth and elevation planes over which the reference gain representation used here; equations in the main part (2d1)-(2f), (3a) and (36) are valid for sectoral antennas.
Annex 4

Mathematical model of generic average radiation patterns of omnidirectional for P-MP FWSs for use in statistical interference assessment
1	Introduction
The main text of this Recommendation (in recommends 2.2) gives reference radiation patterns, representing average side-lobe levels for omnidirectional (in azimuth) antennas, which can be applied in the case of multiple interference entries or time-varying interference entries.
On the other hand, for use in spatial statistical analysis of the interference, e.g. from a few GSO satellite systems into a large number of interfered-with FWS, a mathematical model is required for generic radiation patterns as given in the later sections in this Annex.
It should be noted that these mathematical models based on the sinusoidal functions, when applied in multiple entry interference calculations, may lead to biased results unless the interference sources are distributed over a large range of azimuth/elevation angles. Therefore, use of these patterns is recommended only in the case stated above.
2	Mathematical model for omnidirectional antennas
In case of spatial analysis of the interference from one or a few GSO satellite systems into a large number of FS stations, the following average side-lobe patterns should be used for elevation angles that range from −90° to 90° (see Annex 1):
(39a)
with:
(39b)
where , 3, 4, G0 and k are defined and expressed in recommends 2.1 in the main text.
The parameter 0.1 is introduced in equation (39b) in order to avoid the situation that F(θ) falls below −10 dB.
NOTE 1 – In cases involving typical antennas operating in the 1-3 GHz range, the parameter k should be 0.7.
NOTE 2 – In cases involving antennas with improved side-lobe performance in the 1-3 GHz range, and for all antennas operating in the 3-70 GHz range, the parameter k should be 0.
Annex 5

Procedure for determining the radiation pattern of an antenna at an arbitrary
off-axis angle when the boresight of the antenna is mechanically
or electrically tilted downward
1	Introduction
This Annex presents methods to account for the radiation pattern of a sectoral antenna when tilted downwardly by either mechanical or electrical means. The analysis of the mechanical means is presented in § 2 and the electrical means in § 3.
2	Analysis of mechanical tilt
The basic geometry for determining the gain of a sectoral antenna at an arbitrary off-axis angle is shown in Fig. 20. It is assumed that the antenna is located at the centre of the spherical coordinate system; the direction of maximum radiation is along the x-axis. If the antenna is tilted downward, it becomes necessary to distinguish between the antenna-based coordinates (, ) and the coordinates referenced to the horizontal plane (h, h). The relationship between these coordinate systems is best determined by considering the rectangular coordinate systems attached to them.
If the antenna is down-tilted to a specified tilt angle by rotating the coordinate system about the y-axis, the x-y plane contains the main beam axis of the sectoral antenna, and this plane intersects the local horizontal plane along the y-axis. The tilt angle β is defined as the positive angle (degrees) that the main beam axis is below the horizontal plane at the site of the antenna.
Figure 20
Right-handed coordinate systems used to account for the radiation pattern
of a tilted sectoral antenna
In a rectangular coordinate system located at the antenna, with its x-axis in the vertical plane containing the maximum gain of the antenna, the coordinates of the unit vector are given as follows:
(40)
Note that this is a non-standard spherical coordinate system in that the elevation is measured in the range from –90 to +90 degrees. This is the same convention that was used in recommends in the main text and in the previous annexes.
Consider the rectangular coordinate system of Fig. 20, which contains the main beam axis of the antenna and is rotated downward about the y-axis by an angle of  degrees. The unit vector in this system has the coordinates x, y, and z given by:
(41)
In the corresponding spherical coordinate system referenced to the plane defined by the main beam axis and the y-axis, the spherical angles are related to the coordinates x, y and z by sin = z and tan = y/x. The determination of the value of , which lies between –180 and +180 degrees, is given by the arctan(y/x) with possible corrections depending on the algebraic sign of x and y.
Alternatively, making use of the fact that the sum of the squares of x, y and z is unity, it can be shown that cos = x/cos over a restricted range of values of . Substituting equations (40) into (41) and then substituting the resultant values of z and x for the relationships z = sin and x = coscos, the following expressions for the values of the spherical coordinates are obtained (see Note 1):
(42)
NOTE 1 – The range of the function “arccos” is from 0° to 180°. However, this does not limit the applicability of the methodology because the antenna patterns used exhibit mirror symmetry with respect to the x-z plane and the x-y plane.
The equations in recommends 3.4 come from equation (42).
3	Application of the radiation pattern equations in recommends 2.5 and 3.5 to electrical tilt antennas
In the case of the electrical tilt, the radiation pattern equations should be theoretically a function of the tilt angle , which depends on the phase shift amount of the flux radiated from the vertically placed antenna elements. However, taking into account that  is actually a small value in general (e.g., within 15°), the following assumption could be applied for simplification.
Since the tilted radiation gains at the zenith and the nadir have to remain the same values respectively regardless of the tilt angle  (see Fig. 21), the actual radiation pattern, compared to the pattern before tilting, slightly expands or contracts above the maximum gain axis or below that axis, respectively, as shown in the solid line pattern in Fig. 21.
This radiation pattern’s gains (illustrated by the solid line) could be approximated by those of another pattern (illustrated by the broken line in Fig. 21) using a parameter conversion. This broken line pattern is derived from an ideal uniform elevation angle shift of  for the original pattern calculated from the equations in recommends 2.1, 2.2, 3.1 and 3.2 in the respective cases.
Thus, the electrically tilted radiation patterns are derived using the parameter conversion in the equations in recommends (in 2.1, 2.2, 3.1 and 3.2) as follows:
The elevation angle  from the maximum gain axis can be described as:
= h + 	(43)
where:
h:	elevation angle (degrees) measured from the horizontal plane at the site of the antenna for the tilted radiation pattern (−90° ≤ h ≤ 90°)
:	electrical tilt angle as defined in § 2 of this Annex or recommends 2.5 and 3.4.
In order to apply the reference radiation pattern equations in recommends 2.1, 2.2, 3.1 and 3.2 to the electrically tilt antennas, based on the above assumption, a compression/extension ratio RCE is introduced. The compression/extension ratio can be defined as:
(44)
Elevation angle e, by which the tilted radiation gain at h are calculated using equations in recommends 2.1, 2.2, 3.1, and 3.2, can be expressed as follows:
for
for   	(45)
The electrically tilted radiation patterns are calculated by using e of equations of (45) instead of  in the equations in recommends 3.1 and 3.2 for sectoral antennas and also in recommends 2.1 and 2.2 for omnidirectional antennas.
Figure 21
Approximation of the reference radiation pattern for an electrically tilted antenna
Annex 6

The approach to calculate the sectoral antenna reference patterns
for the frequency range from 6 GHz to about 70 GHz
defined in recommends 3.2 in the main part
1	Introduction
This Annex provides the definition and supplementary explanation of the parameters used in equations for the sectoral antenna reference radiation patterns for the frequency range from 6 GHz to about 70 GHz specified in recommends 3.2 in the main text of this Recommendation. The equations presented in this Annex have been derived from the practical analysis based on the measured data of the sectoral antennas.
2	Consideration
The sectoral antenna reference radiation patterns specified in the former versions of this Recommendation did not well fit to the measured patterns in particular outside the main lobe in the azimuth plane, while for the elevation plane the specified patterns represent fairly good approximation to the measured data.
Due to a difference between the 3 dB beamwidth values, i.e. 3 and 3, in the azimuth and the elevation planes, the calculated patterns based on these values result in different gains at the cross point of (, ) = (±180, 0), although the gain values in the both planes should be theoretically equal at this cross point.
It is therefore noted that, as a cause of such inconsistency, the basic mathematical model and the associated assumptions (as illustrated in Figs. 18 and 19 in Annex 3), which is adopted in the algorithm deriving the sectoral antenna patterns, may not applicable to the entire 3-dimension angles.
Taking into account the above points, the current algorithms, as explained below, has been adopted to overcome the inconsistency between the calculated and the measured patterns.
In the angle range where  is greater than about 90°, it is proposed to modify the 3 dB beamwidth values, 3 and 3, to variable parameters 3m and 3m, respectively, so as to gradually get to a single value 3(180) at the cross point (±180, 0) since the inconsistency at this point is caused by the difference between 3 and 3.
As a possible value of 3(180), the existing constant 3 could be adopted assuming that there is no more discrimination at the cross point between elevation and azimuth planes, and it is the simplest selection as far as we consider the cross point being included in the elevation plane.
Therefore,
3(180)  θ3 (see Note 1)	(46)
NOTE 1 – When a front-to-back ratio (FBR) of the reference antenna is available, it may also be possible to adopt 3(180) as follows:
3(180)  	(47)
Regarding the azimuth plane, since the difference of the patterns starts from the angle corresponding to x = 1 for the peak side-lobe patterns and x = 1.152 for the average side-lobe, the azimuth angle at this point th is expressed as follows:
(for peak side-lobe patterns)	(48a)
(for average side-lobe patterns) 	(48b)
The newly defined 3 dB beamwidth variable 3m gradually changes from 3 at ±th to 3(180) at the azimuth angle of ±180°. Given that the changing locus is a part of ellipse, the difference between azimuth angles of || and th is compressed by the factor of 90/(180 − th) as shown in Fig. 22. Then 3m is generally expressed by the following equation, i.e. equation (2d7) in the main part:
for     	(49)
Figure 22
Determining the compression factor for the ellipse equation
Since the value of 3m in the range  is described as equation (49), a consequential modification to equation (2a3) in recommends 3.1 of the previous versions of this Recommendation is required as follows:
for     	(50)
where:
for
Furthermore, within the angle  between 90° and 180° in the elevation plane (in this case  = 180 − ), the following new variable 3m is defined which gradually changes from 3 at 90° to 3(180) at 180°. Given that the changing locus is a part of ellipse, 3m is generally expressed by the following equation (it is noted that, in the case of 3(180)  3, 3m is a constant value 3):
for   	(51)
In the same manner, taking into account equation (51), in the range  greater than 90°, the value of  is not dependent on  but on  and is represented by the following equation:
for   	(52)
The above equations (50) and (52) are referred to by equation (2d3) in the main text.
Annex 7

The approach to calculate the sectoral antenna reference patterns 
for the frequency range from 400 MHz to about 6 GHz 
defined in recommends 3.1 in the main part
1	Introduction
This Annex provides the definition and supplementary explanation of the equations and the parameters for the sectoral antenna reference radiation patterns for the frequency range from 400 MHz to about 6 GHz specified in recommends 3.1.
The former versions of this Recommendation adopted the algorithm which calculated the reference radiation patterns by using the same equations and the same k parameter in both azimuth and elevation planes. Consequently, it was difficult for the reference radiation patterns to fit well those of measured data in both azimuth and elevation planes.
In order to overcome this problem, the current version has adopted a new approach, where calculation of each reference radiation pattern in the azimuth or the elevation plane uses separate equations which are not based on the assumption of the 3 dB beamwidth of an elliptical beam defined in Annex 3 of this Recommendation.
2	Consideration
In order to introduce new fundamental equations of the reference radiation patterns, the following points are assumed for sectoral antenna structure:
–	antenna elements are put in an array in the vertical direction like omnidirectional antennas;
–	the antenna elements are sectoral directional in the horizontal direction.
On the basis of omnidirectional antenna structure, the vertical overall radiation pattern of radiating elements in an array is as a function of the only elevation angle since the array orientation is exactly vertical. Accordingly, vertical radiation patterns are not affected by the variation of the azimuth angle. For omnidirectional antennas using dipole radiating elements, the vertical antenna patterns are identical regardless of azimuth angles. On the other hand, for sectoral antennas whose radiating elements are directional, the radiation pattern at an arbitrary azimuth angle, , is relatively reduced from the radiation pattern at  = 0° by a compression ratio, R, which means an extent of horizontal gain compression as the azimuth angle is shifted from 0° to .
Meanwhile, horizontal radiation patterns are not affected by the variation of the elevation angle and then a relative horizontal antenna dB gain (a negative gain) is the same value at an arbitrary azimuth angle in spite of any elevation angles. Accordingly, a relative horizontal gain at an arbitrary point, Gar(,), is expressed as follows:
Gar(,) = Gar(,0°)                (dB)	(53)
where:
:	azimuth angle relative to the angle of the maximum gain in the horizontal plane (degrees) (–180° ≤  ≤ 180°)
:	elevation angle relative to the local horizontal plane when the maximum gain is in that plane (degrees) (–90° ≤  ≤ 90°).
Therefore, the above-mentioned compression ratio, R, could be described as:
R:	horizontal gain compression ratio as the azimuth angle is shifted from 0° to ,
and a vertical relative gain at an arbitrary point, Ger(,), is expressed as follows:
Ger(,) = R·Ger(0°,)                (dB)	(54)
As a result, the relative gain of the sectoral antenna at an arbitrary point is described as the dB sum of equations (53) and (54), and the gain relative to an isotropic antenna, G(,), as a function of normalised direction by the 3 dB beamwidths, i.e. equation (2a1) in the main part, is shown as the following equation:
G(,) = G0 + Ghr(xh) +R·Gvr(xv)                (dBi)	(55)
where:
G0:	the maximum gain in the azimuth plane (dBi)
Ghr(xh):	relative antenna gain in the azimuth plane at the normalized direction of (xh, 0) (dB)
xh:	|φ|/φ3
3:	the 3 dB beamwidth in the azimuth plane (degrees) (generally estimated by the sectoral beamwidth)
Gvr(xv):	relative antenna gain in the elevation plane at the normalized direction of (0, xv) (dB)
xv:	|θ|/θ3
θ3:	the 3 dB beamwidth in the elevation plane (degrees).
in this case, R, i.e. equation (2a2) in the main text, can be depicted below:
(56)
Moreover, by using antenna elements with sectoral direction, radiation patterns of the main-lobe in the azimuth plane can be especially revealed as  in dB since this equation has shown a good approximation within the 3 dB beamwidth to measured antenna radiation data in the azimuth plane in the past study.
Furthermore, it is assumed that the relative reference radiation gains, Ghr(xh) and Gvr(xv), have the relative minimum value. The minimum is revealed in the vicinity of ±180° in the azimuth plane and at ±90° in the elevation plane on the basis of sectoral antenna structures, and both values of the minimum gain are theoretically the same. As for the relative minimum gain, G180, it should be appropriate to select a value calculated at the point of (,) = (0°, 180°) in the elevation plane using the following equations, since the calculated value had fitted very well elevation patterns of many sets of measured data in the past study:
G180 = k  15log(180°/3)   (dB)     for peak side-lobe patterns	(57)
where:
k = 	12  10log(1 + 8kp)
kp: 	parameter which accomplishes the relative minimum gain for peak side-lobe patterns
G180 = k  3  15log(180°/3)   (dB)   for average side-lobe patterns	(58)
where:
k = 	12  10log(1 + 8ka)
ka: 	parameter which accomplishes the relative minimum gain for average side-lobe patterns.
3	Derivation of the reference pattern equations
In this section, the relative reference radiation gains, Ghr(xh) and Gvr(xv), are revealed particularly in the case of peak side-lobe patterns in the frequency range from 400 MHz to about 6 GHz. On the other hand, regarding the average side-lobe patterns, the relevant equations can be easily derived from the method below:
–	equation (59) is replaced with equation (58) which is decreased by 3 dB from equation (57);
–	equation (60) is the same and equation (61) is used almost as it is except for –3 dB difference outside the main-lobe part.
These reference gains have the relative minimum value, G180, and based on equation (57), the value, i.e. equation (2b1) in the main part, is expressed as the following equation:
(59)
where:
kp: 	parameter which accomplishes the relative minimum gain for peak side-lobe patterns.
3.1	Relative reference antenna equations in the azimuth plane
The relative reference antenna gain, Ghr(xh), i.e. equation (2b2) in the main text, is expressed as follows:
for     xh  0.5
for      0.5 < xh	(60)
Ghr(xh)  ≥  G180
where:
xh 	= |φ|/φ3
kh: 	azimuth pattern adjustment factor based on leaked power (0 ≤ kh ≤ 1)
kh = 	.
3.2	Relative reference antenna equations in the elevation plane
The equations for the relative reference antenna gain mostly follow the equations specified in the former version of this Recommendation since the calculated reference patterns mostly had shown a good approximation to measured antenna radiation data by around the first side-lobe in the elevation plane in the past study. However, the relative reference gain is not also smaller than G180 as well as Ghr(xh) and the minimum value is located at the point of  = 90°. Regarding the equation calculating around the minimum point, therefore, the attenuation incline factor of 15 is changed to C so as to reach the minimum point.
The relative reference antenna gain, Gvr(xv), i.e. equation (2b3) in the main part, is expressed as follows:
for  xv < xk
for  xk ≤ xv < 4	(61)
Gvr(xv)  = – kv – Clog(xv)		for   4 ≤ xv < 90°/3
Gvr(xv)  = G180		for  xv ≥ 90°/3
where:
xv = 	|θ|/θ3
kv: 	elevation pattern adjustment factor based on leaked power (0 ≤ kv ≤ 1)
xk =
kv = 	12 – Clog(4) –10log(4–1.5+ kv);
the attenuation incline factor of C is presented as follows (see Note 3):
4	Comparison between measured data and calculated reference patterns
In order to select the appropriate values of kh, kv, kp and ka above-mentioned for typical antennas, comparisons for peak and average patterns were made between the calculated reference patterns by using the equations above-mentioned in § 3 and the measured side-lobe patterns. The antenna side-lobe patterns were measured for different set-ups by varying tilt and transmission frequency.
Such measurements were statistically analysed and the 95th percentile of the measurements is presented as the peak side-lobe measured data and the average performance of the measurements is shown as the average side-lobe measured data. When tilt was used during measurements, these data were compensated for in the figures by a translation of the measurement data in the angular dimension to place the maximum gain at the elevation angle zero.
During the development of the latest revision of this Recommendation, a number of measured data for sectoral antennas were reported to the ITU-R in the frequency range down to 698 MHz. Through the examination of calculated data which indicated the applicability of these reference radiation patterns down to 400 MHz, it is also noted that there is no physical reason that the antenna characteristics would drastically change in the lower band.
The comparisons for typical antenna patterns are shown in Figs 23 through 26.
The measured pattern characteristics are represented in Table 3.
TABLE 3
The measured pattern characteristics
Figure 23
Comparison between the statistical peak measured patterns and the calculated peak side-lobe patterns
(f: 790-960 MHz)
Figure 24
Comparison between the statistical peak measured patterns and the calculated peak side-lobe patterns
(f: 1.71-2.7 GHz)
Figure 25
Comparison between the statistical average measured patterns and the calculated average side-lobe
(f: 790-960 MHz)
Figure 26
Comparison between the statistical average measured patterns and the calculated average side-lobe
(f: 1.71-2.7 GHz)
5	Summary of various k parameter values
The selected values of appropriate kh, kv, kp, and ka parameters are presented in the following Table 4 (see the relevant parts of recommends 3.1.1 and 3.1.2 in the main text).
TABLE 4
The values of kh, kv, kp and ka parameters for reference peak/average
side-lobe patterns

=== R-REC-S.1325-3-200310-I!!MSW-E.docx ===
RECOMMENDATION  ITU-R  S.1325-3
Simulation methodologies for determining statistics of short-term interference between co-frequency, codirectional non-geostationary-satellite orbit
fixed-satellite service systems in circular orbits and other
non-geostationary fixed-satellite service systems in
circular orbits or geostationary-satellite orbit
fixed-satellite service networks
(Questions ITU-R 206/4 and ITU-R 231/4)
(1997-2000-2001-2003)
The ITU Radiocommunication Assembly,
considering
a)	that emissions from the earth stations as well as from the space station of a satellite network (GSO FSS; non-GSO FSS; non-GSO mobile-satellite service (MSS) feeder links) in the FSS may result in interference to another such network when both networks operate in the same bands;
b)	that it is desirable to have a common methodology of simulation for assessing interference between systems that have co-frequency, codirectional feeder links when one of the systems is non-GSO;
c)	that it is possible to make some simplifying assumptions for these systems;
d)	that the simplifications in considering c) should not adversely affect the output results;
e)	that it would be desirable to have a common set of input parameters for each of the two communication systems;
f)	that it is necessary for the methodology to consider the type of fade compensation to counteract signal fading such as adaptive power control;
g)	that the methodology should have the ability to accurately calculate the time dependence of a single interference event in order to more accurately assess the impact on the interfered system;
h)	that the vast majority of the non-GSO FSS systems are in circular orbits;
j)	that information on the numbers and precise locations of earth stations is usually unavailable from ITU sources,
recommends
1	that the methodology given in Annex 1 may be used to obtain cumulative probability statistics for assessing short-term interference between systems that have co-frequency, codirectional links with one system employing a non-GSO MSS feeder link or non-GSO FSS system;
2	that the output should be evaluated against an agreed set of common output statistics;
3	that the methodology given in Annex 2 may be used to compute the aggregate total interference produced by a non-GSO system into a GSO satellite network and may be used to calculate the cumulative density function of the equivalent power flux-density (epfd) for a given antenna diameter of the GSO earth station or the epfd of the non-GSO system in the uplink direction;
4	that the methodology given in Annex 2 may be used to compute the epfd produced by a non-GSO system into an operational GSO earth station to assess compliance with additional operational limits contained in Article 22 of the Radio Regulations (RR);
5	that the following Notes should be regarded as part of this Recommendation.
NOTE 1 – Short-term interference refers to cumulative probability distribution of those bit error ratios (or C/N values) that are calculated for 1% of the time or less.
NOTE 2 – The methodology of Annex 1 also can be used to evaluate the time dependent nature of the interference during a single near in-line event.
NOTE 3 – Annex 2 provides a methodology for computing the epfd and epfd of a non-GSO system. Annex 3 provides approaches to relate the methodology of Annex 1 to compute epfd and epfd of a non-GSO system.
NOTE 4 – It should be assumed that the noise is thermal in nature and is referenced to the total system noise power including the antenna thermal noise at the input to the demodulator.
NOTE 5 – There is need to develop a methodology for characterizing and calculating the long-term interference between non-GSO FSS systems and GSO FSS networks.
NOTE 6 – Annex 3 is the description and example of computational methodology.
NOTE 7 – Annex 4 provides a list of subjects for continuing work on this Recommendation.
NOTE 8  Software meeting Recommendation ITU-R S.1503 would be used by the Radiocommunication Bureau to validate compliance with epfd limits in Article 22 of the RR.
NOTE 9  The Annexes to this Recommendation apply to non-GSO systems having circular orbit.
Annex  1

Methodology for determining statistics of short-term interference between
co-frequency, codirectional non-GSO FSS systems in circular orbits and 
other non-GSO FSS systems in circular orbits or GSO FSS networks
1	Method and simulation approach description
The framework for this methodology is to model the satellite systems in their orbits and allow each space station and earth station to track their respective aimpoints while taking into account the Earth's rotation. A simulation of this framework is sampled over a period of time at a relatively fine rate. At each sample the range gain product is computed. The raw data is a time history of the interference level versus time. It can be shown that if power control is not used on either system then the range gain product (defined in equation (2)) can be directly related to the interference level. The raw data can be evaluated to compute the per cent of time that the range gain product for all interference paths is above a certain level. The interference geometry is shown in Fig. 1, and the interference paths considered are those below:
To compute the interference to noise ratio, I0/N0, the following equation can be used:
(1)
where:
Pt :	available transmit power (W)
BWtx :	transmit bandwidth (Hz)
Gt (1) :	transmit gain (relative intensity) (numerical ratio)
Gr (2) :	receiver gain (relative intensity) (numerical ratio)
1 :	off bore-sight angle of the transmitter in the direction of the receiver (degrees)
2 :	off bore-sight angle of the receiver in the direction of the transmitter (degrees)
:	wavelength of transmitter (m)
Ri :	length of the interfering path (m)
k :	Boltzmann's constant (1.38  10–23 W/(Hz · K))
T :	noise temperature (K)
Lp :	polarization isolation factor (numerical ratio  1).
If there is no range compensating power control on the links between the space station and the earth station, the only elements of equation (1) that are dependent variables for the time varying simulation are the receiver gain angle, the transmitter gain angle and the range between transmitter and receiver. To compute I0/N0 the range gain product can be multiplied by the constant:
For example the range gain product for space station 1 downlink into earth station 2 downlink is computed as (Fig. 1):
(2)
For interference assessment from satellite networks with multiple ground terminals, the interference from all of the ground terminals (for the uplink case) or from all of the space stations (for the  downlink case) must be combined to determine the total interference. The interference data can be combined at each simulation time step during the simulation, or by combining the data from a set of individual simulations. In either case the receive satellite antenna discrimination in the direction of each earth terminal must be considered when calculating the total uplink interference, epfd, and the receive earth station antenna discrimination in the direction of each non-GSO space station must be considered when calculating the total downlink interference epfd.
The epfd is defined as the sum of the power flux-densities produced at a receive station of the interfered system, on the Earth's surface or in an orbit, as appropriate, by all the transmit stations within the interfering system, taking into account the off-axis discrimination of a reference receiving antenna assumed to be pointing in its nominal direction.
(2a)
where:
Na :	number of transmit stations in the interfering satellite system that are visible from the receive station of the interfered satellite system, considered on the Earth's surface or in an orbit as appropriate
i :	the index of the transmit station considered in the interfering satellite system
Pi :	RF power at the input of the antenna of the transmit station, considered in the non-GSO satellite system (dBW)
:	transmit antenna gain of the station considered in the non-GSO satellite system in the direction of the receive station (relative intensity, numerical ratio)
:	receive antenna gain of the receive station in the direction of the i-th transmit station considered in the non-GSO satellite system (relative intensity, numerical ratio)
:	maximum gain of the receive station antenna (numerical ratio)
1 :	off bore-sight angle of the transmit station considered in the non-GSO satellite system in the direction of the receive station
2 :	off bore-sight angle of the receive station in the direction of the i-th transmit station considered in the non-GSO satellite system
Ri :	distance between the transmit station considered in the non-GSO satellite system and the receive station (m).
In terms of I0/N0, epfd can be expressed as:
(2b)
(2c)
(2d)
where epfd is in dB(W/(m2 · Hz)),  is in W, and BWtx is the transmit bandwidth in Hz.
Substituting I0/N0 (equation (1)):
(2e)
so:
(2f)
(2g)
2	Simulation assumptions
2.1	Orbit model
The orbit model to simulate the space stations in their orbits is for circular orbits only accounting for precession of the line of nodes in the equatorial plane due to asphericity of the Earth.
2.1.1	Discussion
The orbit model represents satellite motion in a geocentric inertial coordinate frame shown in Fig. 2. The origin of this inertial frame is at the centre of the Earth. The x-axis points to the first point in the constellation Aries (i.e., vernal equinox), the z-axis is the mean rotation axis of the Earth, and the y-axis is determined as the cross product of the unit vectors in the z and x direction, i.e. .
The orbital model is based on Newton's equation of motion for a satellite orbiting a perfectly spherical Earth in a circle. The characteristics of this motion that make it easy to model is that the satellite orbital radius and velocity are constant. These parameters are connected by Newton's second law. The equation of motion is:
(3)
where:
msv :	mass of the space station
v :	constant velocity of the space station
G :	Newtonian gravitational constant (6.673  10–11 N · m2/kg2)
r :	radius of orbit
Me :	mass of the Earth (5.974  1024 kg).
Equation (3) can be written in the form:
(4)
where Re is the radius of a perfectly spherical Earth (6 378 km). Since at the surface of the Earth:
(5)
where g is the acceleration due to gravity at the surface of the Earth is:
(6)
we find that (4) can be written as:
(7)
or:
(8)
The period of the orbit, T, is given by the expression:
(9)
These equations completely describe the dynamics of circular orbit motion about a perfectly spherical Earth.
The description of this motion in the geocentric coordinate system shown in Fig. 2 is based on specifying the satellite position using the Keplerian orbital parameters. These variables are defined as:
 :	the right ascension of the ascending node (RAAN) of the orbit. The angle as measured from the x-axis in the equatorial plane (x-y plane).
I :	the inclination of the orbit. The angle as measured from the equatorial plane to the orbital plane of the space station.
E :	the argument of latitude (true anomaly). The angle as measured from the line of nodes to the radius vector at the position of the space vehicle.
It should be noted that the true anomaly is a function of the angular position of the space station at time t0 and the angular velocity of the space station. It can be expressed as:
(10)
where:
E0 :	angular position of the space station at time t0 (rad)
:	angular velocity of the space station (rad/s)
	v/r.
To account for orbital precession the RAAN of the orbit is also a function of the RAAN at time t0 and the orbital precession rate. It can be expressed as:
(11)
where:
0 :	RAAN of the space station at time t0 (rad)
r :	orbital precession rate of the space station (rad/s).
(12)
where:
:	Earth attraction constant (3.986  105 km3/s2)
J2 :	second harmonic Earth potential constant (1 082.6  10–6).
The representation of the space station position in terms of the geocentric inertial coordinate system is:
(13)
The representation of the space station velocity in terms of the geocentric inertial coordinate system, ignoring the relatively long-term variation in , is:
(14)
2.1.2	Perturbations
For GSO satellites:
The orbit inclination of the satellite
The slight inclination of the satellite orbit may occur for satellites that have been in orbit for a period of time. A deviation generally takes place, with a limit in the deviation not to be exceeded.
The deviation of the antenna beam from its nominal pointing direction
The following factors contribute to the total variation on the area on the surface of the Earth illuminated by the satellite beam:
–	variations on satellite station-keeping;
–	variations caused by the pointing tolerances, which become more significant for coverage areas with low angles of elevation;
–	effect of yaw error, which increases as the beam ellipse lengthens.
The effect of these possible variations should be assessed on a case-by-case basis, since their total effect on the area covered will vary with the geometry of the satellite beam, and it would not be reasonable to indicate a single value of shift on the area covered for all situations.
For non-GSO satellites, the exact longitude precession rate would be affected by a slight drift due to longitudinal station-keeping errors. This effect should be modelled and integrated in the simulations.
2.2	Consideration of polarization isolation
The polarization isolation factor, Lp, is the amount of polarization isolation that can be assumed between the transmitter and receiver (see Annex 4).
2.3	Operational assumptions
2.3.1	Non-GSO earth stations location
The identification of beams used at any given location and time from a non-GSO satellite is dependent on both the tracking strategy and the location of non-GSO earth stations. The tracking strategies are described in § 2.3.2. The following sections describe techniques to determine non-GSO earth station locations. The non-GSO systems should use the most accurate approach that applies to their system.
The simulation requires geographical location of the non-GSO earth stations on the Earth's surface which could operate co-frequency, co-polarized. In some cases information on the number and exact location of non-GSO earth stations may be unavailable.
If every non-GSO earth station whose uplink and/or downlink would interfere with the uplink and/or the downlink of a given victim earth station is modelled, the running time of the simulation may become excessive. In many cases it will be possible to limit the number of non-GSO earth stations included in the model, and thus substantially reduce the simulation runtime, without significant loss of accuracy in the epfd statistics computed. In most cases, the links to and from non-GSO earth stations nearest to the victim earth station will make the largest contributions to the epfd, and the contributions of links to and from other non-GSO earth stations will be progressively smaller as their distance from the victim earth station increases. One way of minimizing the necessary time of a definitive simulation is to perform an initial short run with a limited number of non-GSO earth stations disposed symmetrically around the victim earth station, and then add a concentric ring of non-GSO earth stations and perform a further short run, and repeat this process until the epfd statistics produced by successive short runs do not increase significantly. Use the resulting model for the definitive simulation.
2.3.1.1	Known distribution of non-GSO earth stations
There are cases where the exact locations of all the non-GSO earth stations are known. In those cases, the non-GSO systems should use those locations, which constitute the most accurate configuration of their system.
2.3.1.2	Uniform distribution of non-GSO earth stations
Each cell is assumed to have a uniform distribution of non-GSO earth stations.
For the purpose of the simulation, the non-GSO earth stations’ position could be specified with regard to a predicted number of the earth stations located on a unit Earth area in a specific geographical region.
The distribution of non-GSO earth stations should be done uniformly on the Earth’s surface, knowing the density of co-frequency, co-polarized non-GSO earth station per km2, and the average distance between the centre of the cells created by the non-GSO system.
To produce the uniform distribution of non-GSO earth stations for the uplink, the following method should be used:
Step 1:	Calculate the number, nes, of actual operating non-GSO earth stations that the representative earth station will represent using:
nes  des  des  es
where:
des :	average distance between the co-frequency, co-polarized non-GSO earth stations (km)
es :	density of co-frequency, co-polarized non-GSO earth station per km2.
Then to perform the interference calculation, an equivalent e.i.r.p. level should be affected to each equivalent non-GSO earth station as follows:
Step 2:	Calculate e.i.r.p. to use for each representative non-GSO earth station using:
e.i.r.p.rep  e.i.r.p.es  10 log10 nes
where:
e.i.r.p.rep :	e.i.r.p. for a representative non-GSO earth station (dBW)
e.i.r.p.es :	e.i.r.p. per non-GSO earth station (dBW)
nes :	number of actual operating non-GSO earth stations.
e.i.r.p.es  Pt  Gt
where:
Pt :	transmit power of the non-GSO earth station (dB)
Gt :	gain of the non-GSO earth station in the direction of the non-GSO satellite (dBi).
Step 3:	For every distance des in latitude and distance des in longitude within the GSO service area, locate a representative non-GSO earth station radiating with e.i.r.p.rep.
2.3.1.3	Probabilistic distribution of non-GSO earth stations
Assigning positions of non-GSO earth stations could be based on a probabilistic rule. Resource allocations can be continually chosen randomly or may be determined globally before the simulation is initiated (e.g. as a function of geography, or time). An initial random seed should be used to allow the simulation to be repeated under the same conditions.
2.3.1.4	Distribution of non-GSO earth stations based on population
Published population densities over the Earth's surface can be used to determine the geographic distribution of non-GSO earth stations. Tracking strategies should be weighted more heavily toward earth stations that have higher population densities.
2.3.1.5	Distribution of non-GSO earth stations based on typical demand
The distribution of non-GSO earth stations is likely to be dependent on the type of service provided (e.g. target market can be rural or city). If a more accurate model of the distribution of non-GSO earth stations is known then it should be used.
2.3.2	Tracking strategy
2.3.2.1	GSO arc avoidance
Some non-GSO systems have been designed to reuse the frequency already heavily used by GSO systems. This frequency reuse is feasible thanks to several techniques. Some of them are described below.
2.3.2.1.1	GSO arc avoidance based upon the latitude
In order to decrease the interference level, some systems use a technique that allows to avoid coupling between the main beam of their satellites and the main beam of the GSO earth station. An exclusion zone is defined by X° with respect to the equatorial plane. When a non-GSO satellite enters the exclusion zone, the traffic of the beam where there is main beam coupling is handed over to another satellite that is not in the zone.
In addition to that, those systems have been designed such that there is a minimum discrimination angle at the earth station of at least Y° between the GSO satellites and the non-GSO satellites.
This technique is often used by MEO systems.
2.3.2.1.2	GSO arc avoidance based upon angle between non-GSO satellite and GSO arc
The GSO arc protection implemented by other systems consists of switching off the beams when any earth point within a cell sees an angular separation between the GSO arc and a non-GSO satellite of less than °.
The value of  is system dependent, but it is generally taken equal to 10°.
2.3.2.1.3	GSO arc avoidance based upon the system design
Some systems have implemented their own technique, depending on the design of their system. There can be many different types of GSO satellite protection.
2.3.2.2	Non-GSO space station selection
There are several different satellite selection strategies which non-GSO system operators may employ. Studies have shown that the choice of the selection strategies affects the medium to long-term interference levels. Non-GSO system operators may use different selection strategies to reduce the interference into other systems. Some of the selection strategies are listed below in the following subsections.
2.3.2.2.1	Space station selection based upon longest dwell time
The space station selection process discussed in this section is based on establishing a link to the satellite in view of the non-GSO earth station for the longest period of time. This process will minimize the number of hand-offs of the data flow. If a satellite system is designed to have multiple satellites in view of the earth station for an extended period of time, then an additional constraint may be imposed to optimize on interference avoidance or diversity.
It is assumed that the earth station, associated with a constellation, tracks the corresponding space station once it has a communication link established. When this space station is beyond the minimum elevation angle it is assumed that the next space station can be acquired before the next simulation time step. If more than one space station can be acquired at the next time step, the algorithm to select the next space station is based on the vector from the earth station to the potential space station,  and the unit vector in the direction of the space stations velocity,  The selection criterion is to minimize the dot product of  and
(.)min
		i.e. the minimum value of all satellites 	(15)
above minimum elevation
This selection procedure is shown in Fig. 4. The top view representation shows the space station velocity vector, denoted by  directed towards the earth station. The dot product is negative, so space station number 1 is selected over the other space station (see Annex 4).
2.3.2.2.2	Space station selection based upon highest elevation angle
This selection strategy will require a higher number of hand-offs than longest dwell time but may be used to improve link performance for the non-GSO system. Active satellites are selected if it has the highest elevation angle from a non-GSO earth station and an available transponder. There are two possible hand-over techniques for highest elevation angle:
–	the satellite with the highest elevation angle is always selected as the active satellite;
the highest elevation satellite is selected once the active satellite drops below a minimum elevation angle.
When satellite diversity is applied, the same selection should be made on the number of satellite required by the diversity: the next satellite chosen would be the second highest elevation satellite, then the third would be the third highest elevation, etc.
2.3.2.2.3	Space station selection based upon largest separation angle from the GSO arc
Non-GSO systems may choose satellites based upon the farthest separation angle from the look angle to the GSO arc. This reduces the level of interference generated by the non-GSO satellites into a GSO earth station but has some drawbacks. It may result in a less than optimum link performance and also require a large amount of hand-offs.
2.3.2.2.4	Space station selection based upon typical resource allocation
Non-GSO systems should choose to provide a more typical resource allocation if it is different from the three mentioned above.
2.3.3	Power control on range
Power control on a non-GSO space station is to account for differences in the range R (between the earth station and the space station). This section describes an algorithm to perform power control on range. The concept of power control on range is for the transmitting station to reduce or increase its transmit power as the receiver moves towards or away from the transmitter, i.e. the received power is kept constant. The required input parameter for the simulation is the desired receiver power density at the input to the wanted antenna, Pr (dB(W/Hz)). This receive power can be expressed as:
(16)
where Rw is the length of the wanted signal path (i.e. distance between earth station and space station of constellation 1) and Pt (Rw) is the transmit power required to close the link. Pr can be related to the carrier to noise level at the wanted receiver by:
(17)
where:
Grw(0) :	maximum wanted receive gain of the wanted antenna
Gtw (0) :	maximum wanted transmit gain of the wanted antenna
Tw :	wanted receiver noise temperature.
When power control on range is considered, the equation to compute the interference level can be expressed as:
(18)
Traffic
2.3.4.1	Time varying nature of the traffic
The time varying nature of the interference created by a non-GSO system into a GSO network or non-GSO system should be taken into account for accurate modelling of the interference. The traffic variation is a function of the local time at the non-GSO earth station. The transmit power per carrier of a non-GSO system which use code division multiple access (CDMA) varies as a function of the traffic load on the specific carrier, then the transmit power per carrier may vary during the time of the day following the traffic demand. This feature is specific to CDMA.
A reference traffic model is proposed. If the non-GSO system has a model that more accurately represents its service demand, it may choose to use it instead of the referenced one given in Fig. 5.
The traffic coefficient is taken into consideration in the maximum transmit power.
Pt  Pmax  Ctraffic
where:
Pt :	transmit power (W)
Pmax :	maximum transmit power (W)
Ctraffic :	traffic coefficient dependent on the local time.
The traffic coefficients are only applicable to CDMA mode.
It is noted that non-GSO traffic load might be correlated with the GSO traffic, depending on the type of services offered by the two systems. Interference during time periods when GSO traffic is very low will not likely have the same effect on the GSO network performance. If the GSO satellite is also using CDMA, epfd statistics calculated taking into account non-GSO traffic variations could lead in some cases to results that might not correspond integrally to interference statistics observed by GSO operators during busy hours.
2.3.4.2	Geographical dependence of the traffic
The referenced traffic model given in the previous section is only dependent on the time. The traffic statistics may also vary with geographic location, target markets and other factors. In order to be more precise, an additional traffic model depending on the geographic location, target markets and other factors may be needed. Nevertheless, this model will vary with the types of services offered by the systems, the system itself and the country considered.
If a non-GSO system has a traffic model that more precisely represents its service demand depending on the geographical locations and target market, it may be used. If no precise data is available, the traffic demand could be considered identical everywhere on the Earth, which remains a conservative assumption. In that case, the traffic model used could be time-dependent only.
2.4	Antenna parameters
2.4.1	GSO earth station antenna parameters
The antenna pattern for the earth station is an input parameter to the simulation. Suggested patterns include, but are not limited to, the following:
–	measured antenna patterns;
–	RR Appendix 8;
–	Recommendation ITU-R S.465;
–	Recommendation ITU-R S.580;
–	Recommendation ITU-R S.1428.
Recommendation ITU-R S.1428 has been developed in order to take into account a more accurate, though conservative, description of the shape of the pattern so that it can be used more realistically in interference calculations involving non-GSO FSS systems.
2.4.2	Non-GSO space station antenna parameters
In order to perform interference analysis, non-GSO satellite multiple beam antennas should be modelled using either of the following patterns, subject to availability, proposed in Recommendation ITU-R S.1528:
–	measured antenna patterns;
–	proposed reference antenna patterns;
–	an analytical function which models the side lobes of the non-GSO satellite.
2.4.3	GSO space station antenna patterns
The GSO satellite reference antenna pattern that should be used to perform the interference analysis should follow Recommendation ITU-R S.672 with the following parameters:
–	at 14/11 GHz band, an antenna pattern with a gain of 32.4 dBi, a side-lobe level of Ls  20 dB*, and a beamwidth of 4°;
–	at 30/20 GHz band, an antenna pattern with a gain of 40.7 dBi, a side-lobe level of Ls  10 dB* (an exception to Recommendation ITU-R S.672), and a beamwidth of 1.55°.
2.5	Input data
The required input parameters for each of the two communication systems are:
2.5.1	Orbit parameters
–	Number of space stations
–	Number of planes
–	For each orbital plane:
–	Orbit altitude
–	Inclination of plane
–	RAAN
–	Argument of latitude for each space station in the orbital plane.
2.5.2	Antenna parameters
–	Space station
If non-GSO system:
–	Antenna pattern
–	Maximum transmit gain (dBi)
–	Maximum receive gain (dBi)
–	Maximum number of co-frequency and co-polarization antenna beams and their spatial orientation.
If GSO system:
–	Transmit gain (dBi) in direction of non-GSO earth station
–	Receive gain (dBi) in direction of non-GSO earth station
–	Antenna pattern.
–	Earth station
–	Antenna pattern
–	Maximum transmit gain (dBi)
–	Maximum receive gain (dBi)
–	Location (latitude, longitude).
2.5.3	Operational and computational parameters
–	Minimum elevation angle for communication
–	Simulation time start
–	Simulation time end (see § 2.7)
–	Simulation time increment (see § 2.7)
–	Precession (see § 2.7)
–	If non-GSO system and power control on range is used: the desired receiver power density at the input to the wanted antenna (dB(W/Hz))
Traffic model used (see § 2.3.4)
Description of the non-GSO space stations selection used (based upon longest dwell time, highest elevation angle, largest separation angle from GSO arc, satellite diversity, etc.) (see § 2.3.2.2)
Implementation of the GSO arc avoidance technique if the non-GSO system uses it (see § 2.3.2.1)
–	Predicted density of non-GSO earth stations located in different geographical regions of the non-GSO network service zone, if non-GSO earth station locations are unknown (see § 2.3.1)
–	Perturbations (see § 2.1.2).
2.5.4	Frequency to be used for the assessment of interference
The interference into the desired network should be assessed at the lowest frequency which is shared by the interfering and the desired networks, in circumstances where the antenna patterns are defined by an envelope.
2.6	Output data
The raw output data of the simulation is a time history of the interference to noise level, I0/N0, versus time. This data can be analysed to obtain the following information:
–	A plot of the I0/N0 (dB) or epfd (dB(W/(m2 · 40 kHz))), as a function of the per cent time (on a logarithmic scale) that this level is exceeded.
–	A time history of a peak interference event (I0/N0 versus time) or peak epfd level (epfd versus time).
–	The number of events (and duration of those events) for which the I/N or epfd is above a pre-defined level. For example let the pre-defined level be X dB, then in this case an event starts when the interference level is above X dB and ends when it falls below X dB, the time that this event is above the X dB level is the duration of the event. This method will give an indication of how long the interference level will be above a particular value.
2.7	Calculation of the total simulation time, simulation time increment and precession
2.7.1	Introduction
The calculation method described in this section may be used for simulation when the interference is from non-GSO satellite to GSO FSS earth station or from non-GSO earth station to GSO FSS satellite. Calculation methods for other interference cases and for elliptical orbits need further study (see Annex 4).
2.7.2	Simulation time increment
For accurate results the simulation time increment should be as short as possible, but on the other hand the total simulation time should be reasonable. For comparable accuracy in different simulations the time steps can be related to the antenna beamwidth of the interfered systems.
Satellite speed in Earth-fixed coordinates depends on the sub-satellite point latitude but the variation can be neglected for this purpose and the highest speed at equator can be used in the calculation. The angular speed of the satellite, as seen from a point on Earth, is highest when the satellite is moving directly towards or away from that point. The angular speed can be calculated by the following equations:
where:
a :	satellite angular velocity in Earth-fixed coordinates (geocentric geosynchronous reference coordinate system) (rad/s)
e :	Earth rotation angular velocity at the equator,  7.29  10–5 rad/s
:	satellite angular velocity in space fixed coordinates (geocentric heliosynchronous reference coordinate system) (rad/s)
I :	satellite orbit inclination (rad)
 :	geocentric angle between the interfered earth station and the satellite sub-point when it is at the main beam axis of the earth station (rad)
Re :	Earth radius (6 378 km) (m)
h :	satellite altitude (m)
 :	earth station antenna elevation (rad)
3 dB :	earth station 3 dB beamwidth (rad)
Nhits :	number of hits in interfered station 3 dB beamwidth (Nhits  5)
t :	simulation time increment (s).
2.7.3	Precession and total simulation time
A satellite of a non-GSO constellation on a circular orbit traces out a path on the Earth's surface. After a time, which is specific to the system, the satellite or another satellite of the constellation returns to the same or practically to the same point. The time between these two cases is the repeat period of the constellation. The repeat periods of different constellations are from a few days to several months.
With similar orbits in the non-GSO system the period of the orbital constellation recurrence could be derived using the following methodology:
Step 1:	Define an angular spacing between subsatellite points at t  t0 and t  t0  T ignoring bias along ascending node longitude, where T is the satellite orbit period:
where Te is the Earth rotation period.
Step 2:	Define an angular spacing between subsatellite points at t  t0 and t  t0  Tj , where j is the number of orbits around the Earth.
Step 3:	Define the least integer j, for which is met the following condition:
where  is the required accuracy of the orbital constellation recurrence period (rad).
Step 4:	Define the period of the orbital constellation recurrence:
where jmin is the least integer j, for which Step 3 condition is met.
Total simulation time and the precession should be such that the distribution of the satellite paths along a latitude line is uniform and there are enough traces passing through the interfered station beamwidth. For a compromise between accuracy and simulation programme run time the number of passes through the area should be the same as the number of hits during one pass (see simulation time increment).
If the repeat period is so short that there will not be the required number of passes through the area, the programme is run for several values of the initial right ascension of the node. The angle between the initial ascensions of the node should correspond to the required spacing between the passes through the area and the number of program runs should be such that the initial right ascensions of one plane reaches the corresponding initial point of the next plane.
If the repeat period is so long that the number of passes through the area is unnecessarily high an artificial precession which gives shorter repeat period can be used. In this case the satellite e.i.r.p. should not be time dependent.
The effect of the fractional relation between a cycle of time dependent variation of satellite e.i.r.p. and satellite passes through the area needs further study.
2.7.4	Dual time step sizes
It may be desirable to use two time step sizes to increase the speed of the simulation run time. Section 2.7.2 addresses the computation of simulation time increment. The time increment can vary orders of magnitude between large and small receiving earth station antennas, becoming very small for narrow beamwidths due to the requirement for the number of hits in the main beam (Nhits  5). This requirement is necessary but it increases the run time significantly. To alleviate this problem, a dual time step can be used to reduce the variance and overall length of simulation run time for all sizes of earth station antennas, especially for those earth stations with narrow beamwidths.
For this dual step algorithm, the time step size addressed in § 2.7.2 should be used for all simulations and is referred to here as the fine step size. This step size is dependent on the antenna beamwidth and should be used only during portions of the simulation where the non-GSO satellite is close to the regions of maximum epfd, near the main beam or edge of the exclusion zone. The percentage of time that satellites are in the regions far off-axis from the main beam, past the first side lobe, is much larger than the percentage of time satellites will be within the main beam. Because of this and the fact that past the first side lobe the epfd values do not change as rapidly with the satellite position, for regions away from the main beam a constant coarse step size can be used. This coarse step size is defined as a topocentric angle:
coarse  1.5°
This coarse step size can be used for all antenna sizes.
There are two possible fine step regions because of the two possible worst-case locations of a non-GSO satellite:
–	When a non-GSO satellite is near the main beam, the fine step region (FSR) is defined as a fixed topocentric angle from the axis of the GSO earth station beam:
–	If D/  100, set the edge of the first side-lobe region to r of the GSO earth station pattern:
1  r  15.85(D/)–0.6
–	If D/  100, set the edge of the first side-lobe region to that defined in the GSO earth station pattern:
1  95 /D
The off-bore angle for the fine step region is defined as the greater of 3.5 or 1:
–	When a non-GSO satellite is near the exclusion zone, the fine step region measured from the boundary of the exclusion zone is defined as:
The size of the coarse step needs to be an integer multiple of fine steps for statistical purposes. Since the coarse step size is constant, the ratio of coarse steps to fine steps is dependent only upon the beamwidth of the GSO earth station (3 dB). This ratio is defined as:
Ncoarse  floor ((Nhits  coarse)/ 3 dB)
where “floor” is a function that truncates the decimal part of the ratio and outputs the integer part of the ratio. This produces a conservative ratio of fine steps to coarse steps to ensure that a coarse step is never larger than the target topocentric size of 1.5. Since this ratio is only dependent on the beamwidth of the GSO earth station antenna, 3 dB, the time savings increases as the beamwidth decreases. This is desired since simulations with narrow beamwidths require much more time to run.
If a non-GSO satellite is with FSR_1 of the main beam or FSR_2 of the exclusion zone, the fine step size should be used for the simulation. For all other regions in space when a non-GSO satellite is not near the aforementioned regions, the coarse time step is then computed by multiplying Ncoarse by the fine step size.
Annex  2

Methodology for determining statistics of codirectional, co-frequency interference levels between non-GSO FSS systems having circular 
orbits and GSO FSS networks in frequency bands below 30 GHz
1	Introduction
This Annex provides the algorithms to compute the aggregate total interference produced by a non-GSO network into a GSO system.
These algorithms can be used to calculate the cumulative density function (cdf) of the epfd generated by the non-GSO system. The following cases of interference are studied:
–	uplink interference from the transmit earth stations of a non-GSO network into a GSO system space station;
–	downlink interference from the transmit space stations of a non-GSO system into a receive earth station of GSO network.
This methodology also permits computation of the probability density function (pdf) and cdf of the C/I, as a function of the characteristics of both networks.
In order to determine the worst interference case, a two-step approach is proposed. The first step leads to the location of the worst case. The second step is the implementation of the epfd and epfd calculation at the identified worst-case location.
2	Interference scenario
The non-GSO system is the interfering network. Figure 6 describes this interference scenario:
3	Terminology
3.1	Earth related constants
For the Earth, the general constants are:
Re :	Earth radius (6 378 km)
O :	Earth centre
:	Earth attraction constant (3.986  105 km3/s2)
J2 :	second harmonic Earth potential constant (1 082.6  106)
Te :	Earth rotation period (23 h 56' 04"  86 164 s)
e :	Earth rotation angular velocity
	2/Te  7.29  10–5 rad/s
t :	elapsed time (s).
3.2	Non-GSO satellite system space station related constants
For the non-GSO satellite system space stations (see Fig. 7), the constants are as follows:
N :	number of space stations of the non-GSO system
i :	index for each of the non-GSO satellites (0  i  N)
h :	satellite altitude above the Earth (km)
r :	semi-major axis of the satellite (km)
	h  Re
I :	inclination angle of the orbital plane above the Equator (rad)
i,0 :	RAAN of each of the non-GSO satellites at the initial time (rad)
Ei,0 :	argument of latitude of each of the non-GSO satellites at the initial time (rad)
T :	satellite orbit period (s)
	2 (r3/)1/2
:	mean motion of the satellite (rad/s)
	2/T
Ei,t :	argument of latitude of the satellite at the time of computation (rad)
	Ei,0  it
ri :	nodal regression of the ascending node (rad/s)

i,t 	RAAN of the satellite at the time of computation (rad)
	i,0  rit
coordinate vector of a non-GSO satellite in the Earth-centred fixed reference:
The non-GSO perturbation can be considered in calculating the non-GSO constellation related constants, as the position of the satellites may vary when taking perturbation into account.
3.3	GSO satellite network space station related constants
For the geostationary satellites, the parameters are as follows:
h :	satellite altitude above the Earth (35 786 km)
r :	semi-major axis of the satellite orbit
	h  Re  42 164 km
I :	inclination angle of the orbital plane above the equator (generally 0, but may vary between 5 and –5)
0 :	RAAN of the GSO satellites at the initial time (rad). It can also be considered as its longitude
T :	satellite orbit period
	2(r3/)1/2  86 164 s
:	mean motion of the satellite
2/T  7.29  10–5 rad/s
E0 :	argument of latitude at the initial time (rad)
Et :	argument of latitude of the satellite at the time of computation (rad)
	E0  t
r :	nodal regression of the RAAN (rad/s)

t :	RAAN of the satellite at the time of computation (rad)
	  rt
:	coordinate vector of the GSO satellite in the Earth-centred fixed reference centre:
The GSO perturbation can be considered in calculating the GSO constellation related constants, as the position may vary when taking perturbation into account, as well as the pointing direction of the GSO satellite antenna.
3.4	Earth station related constants
a)	With known location of earth stations in the non-GSO system: An earth station is defined by:
Lat :	latitude of earth station (rad)
Lon :	longitude of earth station (rad)
:	earth station coordinates in the Earth-centred fixed reference centre:

b)	With unknown location of earth stations in the non-GSO system:
i :	predicted density of non-GSO earth stations location in the i-th geographical region of the non-GSO service zone
d :	average distance between the centre of the co-frequency, co-polarized non-GSO earth stations (km).
4	Interference computation
Section 4.1 gives a method to identify the worst-case location that would determine the highest epfd level. However, the epfd calculation could be performed on any other location on the Earth's surface and its associated GSO satellite.
4.1	Step 1: Worst-case identification
There is a need to identify the worst-case situation, meaning a maximum epfd location of the GSO network stations. When considering the interference situations between non-GSO systems and GSO networks, the worst-case situation is found whenever an in-line or quasi in-line event occurs.
The worst-case identification for the downlink interference situation consists in finding the maximum epfd location of the GSO earth station. In the proposed methodology, the worst-case search is based on a geometrical analysis for the calculation of an in-line situation. The worst-case situation also depends on the side lobes level of the non-GSO satellite antenna at the time of the in-line situation.
In order to assess the worst geometrical configuration, leading to the worst interference case, the GSO satellites are distributed along 360 arc in longitude every 1°. For each GSO space station, it is possible to draw a straight line which goes through this GSO space station and one non-GSO space station; it may cross the Earth at particular points P and P'.
The coordinates of points P and P' are determined by resolving a system of equations which describe the intersection of a straight line (passing through the GSO space station and the non-GSO space station) and a sphere (representing the Earth). The resolution of these equations gives two solutions, only one being acceptable: the correct GSO earth station position is the one for which the distance between the GSO earth station and GSO space station is minimum.
The family of points P is then candidate for worst-case locations of the GSO earth station. This first criterion is therefore dependent on the constellation geometry.
The second term which is also predominant in the calculation of the maximum epfd is the level of the power radiated by the non-GSO satellite antenna in the direction of the GSO earth station. If the antenna is modelled by a pattern (with no modelling of the side lobes) the worst-case location depends only on the constellation geometry and requires a geometrical in-line situation. In the cases where the antenna is modelled by a function that takes into account the side lobes, or defined by a real antenna pattern, the side lobes effect would need to be considered.
The non-GSO space station which is in line with the GSO space station and the GSO earth station generate pfd through the side lobes of its transmitting antenna, in the direction of the GSO earth station. The pfd generated would be higher when the non-GSO space station antenna gain in the direction of the GSO earth station is at a peak of the side lobes. This second criterion is therefore dependent on the non-GSO space station antenna pattern.
In order to be exactly at the worst case, the transmit power has to be maximum. Therefore when the traffic model is implemented, it should be maximum during the in-line event to generate the highest epfd level.
The worst-case configuration of the GSO network is dependent on the non-GSO constellation geometry as well as on the level of the side lobes level of the non-GSO space station antenna during the in-line geometrical situation.
For the assessment of the worst-case identification for the uplink interference, the determination of the GSO network location for maximum epfd should be performed. The epfd produced by the emissions of all the earth stations of a non-GSO system operating in the FSS, is evaluated at any point of the geostationary arc. For duration purposes it is not possible to calculate epfd statistics for all possible space station locations and pointing directions. Thus it is necessary to define a method to determine the location where the maximum epfd occurs. The epfd is dependent on the density of non-GSO earth stations which are visible from the GSO space station with regards to its antenna aperture.
In the meantime, the further from the sub-satellite point the GSO space station is pointing, the larger the beam size illuminated on the ground. In the case where the GSO space station antenna discrimination is taken into account, the pointing direction of the maximum epfd corresponds to a case where there is a high density of non-GSO earth stations within the coverage area and a maximum number of contributors in the far side lobes.
Therefore, the maximum epfd will occur for a GSO space station pointing far from the sub-satellite point.
The worst-case location is selected as worst test point in order to run Step 2 of the simulation programme.
4.2	Step 2: Interference calculations at worst case
Figure 9 describes the above-mentioned scenarios in a configuration of reference:
4.2.1	Uplink interference computation
The following notation is used for computing the interference link budgets on the GSO network uplink wanted carrier:
en :	angle measured from the non-GSO network earth station, and between the GSO network space station and the non-GSO satellite system space station towards which the non-GSO system earth station is pointing (rad)
sg :	angle measured from the GSO network space station, and between the GSO network space station receive antenna boresight and the interfering non-GSO system earth station (rad)
den,sg :	distance between the interfering non-GSO system earth station and the GSO network space station (km)
Grx,sg (sg) :	receive antenna gain of the GSO satellite in the direction of the interfering non-GSO system earth station (dBi)
Gtx,en (en) :	transmit antenna gain of the interfering non-GSO system earth station in the direction of the GSO network space station (dBi)
Ptx,en :	power density at the transmit antenna of the non-GSO system earth station (dB(W/Hz))
f :	reference bandwidth (Hz)
f :	frequency of the carrier at which the computation is performed (GHz)
c :	speed of the light (0.3 m/ns)
:	the wavelength of the carrier (m)
c/f
Ctraffic :	traffic coefficient which depends on the local time (dB).
The interfering pfd (dB(W/(m2 · Hz))) in the reference bandwidth produced on the uplink by a single non-GSO system earth station into the wanted carrier of a GSO network received by the geostationary space station is:
The total interfering power flux-density, designated as the epfdof all the non-GSO earth stations visible in the GSO space station coverage weighted by the discrimination of the receive antenna of the GSO satellite is calculated as follows:
*
where:
Grx,sg (sg)/Gmax is the normalized linear gain of the GSO receiving antenna.
4.2.2	Downlink interference computation
The following notation is used for computing the interference link budgets on the GSO network downlink wanted carrier:
sn :	angle measured from non-GSO system space station, and between the non-GSO system earth station towards which the non-GSO system space station is pointing and the considered GSO network earth station (rad)
eg :	angle measured from the GSO network earth station, and between the GSO network space station towards which the GSO network earth station is pointing and the considered interfering non-GSO system space station (rad)
Grx,eg (eg) :	receive antenna gain of the GSO network earth station in the direction of the interfering non-GSO system space station (dBi)
Gtx,sn (sn) :	transmit antenna gain of the non-GSO system space station in the direction of the GSO network earth station (dBi)
Ptx,sn :	power density at the transmit antenna of the non-GSO system space station (dB(W/Hz))
f :	reference bandwidth (Hz)
deg,sn :	distance between the GSO network earth station and the interfering non-GSO system space station (km)
Ctraffic :	traffic coefficient which depends on the local time (dB).
The interfering pfd (dB(W/(m2 · Hz))) in the reference bandwidth produced on the downlink by a single non-GSO system space station into the wanted carrier received by the GSO network earth station is:
The epfd can be computed by summation of all the individual pfd. The resulting equation is:
*
4.2.2.1	Methodology to decrease simulation runtime
In order to decrease the simulation runtime, the number of non-GSO satellites considered to calculate the epfd may be limited to the most contributing ones. To select the non-GSO satellites, an operational cone can be implemented in the simulation.
For cases where the highest level of epfd generated by the interfering non-GSO system (see Fig. 10) occurs when a non-GSO satellite is in-line (or near in-line) with a satellite of the interfered system (see Fig. 11), and the earth station of this system, the cone is centred around the pointing direction of the earth station of the interfered system.
Indeed, from a certain value of the angle which defines the cone, the epfd generated by a non-GSO satellite outside the cone at the earth station (see Fig. 11) would be lower than a given minimum level epfdmin.
For cases where the highest level of epfd generated by the interfering non-GSO system occurs when a non-GSO satellite is at the edge of the exclusion zone, a ring is defined around the exclusion area.
When satellites are visible inside the cone (or the ring), the contribution of each visible satellite is evaluated and summed to calculate the epfd generated at the earth station.
When all the visible satellites are outside the cone (or the ring), the total epfd generated at the earth station may be neglected, or may be set at epfdmin. epfdmin is chosen by the system depending on its design (type of constellation, number of satellites, position of orbits, antenna size, etc.).
The value of epfdmin is adjusted progressively until variations of the short-term epfd statistics produced by successive runs are neglected.
The simulation runtime is thus considerably reduced, without significantly affecting the accuracy in the epfd statistics.
4.2.2.2	Application to the calculation of additional operational limits (AOL)
The AOL are defined for given epfd levels. The lowest limit is set at –182 dB(W/(m2 · 40 kHz)) for a 3 m antenna, and –185 dB(W/(m2 · 40 kHz)) for a 10 m antenna. The objective of the simulation is to analyse the epfd generated by a non-GSO system above this lowest epfd limit. In that case, the epfdmin chosen can be set at 1 dB below those lowest additional operational limits, giving a good accuracy in the results.
5	Method to compute the aggregate interfering noise power from a single non-GSO system
The non-GSO system presents inherently non-stationary geometrical and transmission parameters, therefore there is a need to identify the distribution of the interference power in the different possible configurations. Simulations are necessary in order to achieve this goal. This section describes the different steps to be applied at each time to compute the epfd or apfd and the interfering noise power in the worst case identified with Step 1.
5.1	Method to compute the interference on the uplink
For each of the considered time step, the following steps are applied:
Step 1:	Computation of the position of the non-GSO system space stations as described in § 2.1.1 of Annex 1.
Step 2:	Computation of the position of the GSO network space station.
Step 3: 	The distribution of non-GSO system earth station locations should be determined using the methods described in § 2.3.1 of Annex 1.
Step 4:	Computation of the transmit power density of each non-GSO system earth station.
Step 5:	Computation of non-GSO space station selection as described in § 2.3.2.2 of Annex 1.
Step 6:	Computation of the off-axis angle of each of the non-GSO system earth stations between its assigned non-GSO system space station and the GSO network space station.
Step 7:	Computation of the transmit gain of each of the non-GSO system earth stations in the direction of the GSO network space station.
Step 8:	Computation of the distance between each of the non-GSO system earth stations and the GSO network space station.
Step 9:	Computation of the interfering pfd received by the GSO network space station from each of the non-GSO system earth stations.
Step 10:	Computation of the received interfering pfd from each of the non-GSO system earth stations into the GSO network space stations.
Step 11:	Computation of the epfdfor the chosen antenna diameter as described in § 4.2.2 of this Annex.
Step 12:	Aggregation of the received interfering noise power if needed.
5.2	Method to compute the interference in the downlink
The method is similar to the method proposed in § 5.1, and depends on the GSO antenna diameter chosen to study. The study should be repeated for each type of antenna size analysed:
For each of the considered time steps, the following steps are applied:
Step 1:	Computation of the position of the non-GSO system space stations as described in § 2.1.1 of Annex 1.
Step 2:	Computation of the position of the GSO network earth station.
Step 3:	The distribution of non-GSO system earth station locations should be determined using the appropriate method described in § 2.3.1 of Annex 1.
Step 4:	Computation of the transmit power density of each non-GSO system space station.
Step 5:	Computation of space station selection as described in § 2.3.2.2 of Annex 1.
Step 6:	Computation of the off-axis angle of each of the non-GSO system space stations between its assigned non-GSO system earth station and the GSO network earth station.
Step 7:	Computation of the transmit gain of each of the non-GSO system space stations in the direction of the GSO network earth station.
Step 8:	Computation of the distance between each of the non-GSO system space stations and the GSO network earth station.
Step 9:	Computation of the receive antenna gain of the GSO network earth station in the direction of each of the non-GSO system space stations for the chosen antenna.
Step 10:	Computation of the interfering pfd received by the GSO network earth station from each of the non-GSO system space stations.
Step 11:	Computation of the epfd for the chosen antenna diameter as described in § 4.2.2 of this Annex.
Step 12:	Aggregation of the received interfering noise power if needed.
5.2.1	Monte Carlo method for choosing GSO ground station locations and their associated GSO satellite coverage
The methodology can be part of the calculation of CDF of epfd.
This methodology simulates x number of ground station locations randomly distributed with an associated GSO satellite at random longitudes.
The ground station locations are computed by choosing a random latitude from –76 to 76and a random longitude from within the 120 coverage of the Earth from a satellite. The longitude is chosen with a uniform probability distribution within the 120. However, due to the spherical shape of the Earth the latitude distribution is not uniform. The following equations account for the area variations with latitude.
Latitude  F (Rand(), y)	(19)
where:
Rand() returns a random number uniformly distributed between 0 and 1. Each time Rand() is called, a new independent random number is chosen
F(a, y) returns latitude values between – y and y for values of a between 0 and 1. F(a, y) biases a uniform distribution to account for the smaller land areas at higher latitudes for a constant  latitude  longitude
F(a, y)  (180/) arcsin(sin(y /180)  (2a – 1))	(20)
Once the ground station is chosen it is tested to see if it is on a land mass. If not, this location is not included as one of the locations simulated. New locations are generated until one is chosen that is on a land mass. Similarly no locations where the elevation angle would be less than e° should be included, where e is the minimum operating elevation angle of the GSO network.
The GSO longitude is chosen from uniformly distributed longitudes along the GSO arc that are at a 10º or greater elevation angle from the GSO ground station location.
The temporal estimation of non-GSO FSS interference includes cumulative epfd probability distribution curves for various locations on the Earth’s surface and corresponding GSO satellite.
The location that receives the maximum epfd level of interference is simulated as well as the set of epfd CDF curves for ground station locations with supporting GSO satellite. One thousand curves are sufficient to represent envelope 99% of the cases for each point on the CDF with an extremely high confidence level. Table 1 shows confidence intervals for various number of trials.
TABLE  1
Confidence probability for specified percentage 
of cases and number of trials
Annex  3

Description and example of computational
methodology in Annex 1
1	Introduction
The methodology described in Annex 1 is intended to be implemented via a computer program. This Annex outlines one such implementation along with a demonstration of an example of the results obtained using the geometric analysis defined in Annex 1 to interference analysis between a non-GSO system and a GSO satellite network.
2	Description of computation methodology
Shown in Fig. 12 is a top level description of an implementation, the blocks labelled A, B, C, D, E will be treated in more detail. To maximize efficiency this implementation computes interference from the four possible interference scenarios under consideration (Annex 1, § 1) at the same time. A data evaluation process evaluates the I0/N0 or epfd versus time data for each of the four scenarios, this evaluation process is not considered in this Annex.
In this block diagram, the term I0/N0 can be replaced by the term epfd.
2.1	Block A – Constellation selection and set-up
Information about the constellations to be simulated are defined in this section of the program, see Fig. 12, block A. For this implementation the relevant data required by § 2.5 of Annex 1 is stored in a database and recalled for the simulation for each of the two constellations that are to be simulated. This portion of the program may also allow for variances from the standard set of parameters, such as different antenna patterns, modification of the location of the earth station associated with each constellation or the peak antenna gains associated with each antenna. For this discussion call the two constellations that are to be simulated Const_1 and Const_2.
This section of the program allocates and initializes the memory required to simulate the constellation. This memory is made of data structures that holds information about the position of the constellation, the velocity of the constellation, and pointing vectors of each satellite of the constellation (antenna boresight information). See Annex 1, § 2.1 for the relevant initial information that needs to be configured for a simple orbit model.
Required data for each earth station is also allocated memory and initialized for each station associated with the constellations. The data structure of the earth station keeps track of which satellite of the wanted constellation the earth station is currently communicating with, the locations of possible interfering satellites, and the minimum required elevation angle that the earth station can communicate (which is related to the maximum range to a satellite for communication to occur and also stored in the data structure). The initial satellite that the earth station is in communication with is also initialized in this portion of the program.
2.2	Block B – Initialize program constants
To promote efficient use of resources, constants of the simulation are factored out of the equation used to compute I0/N0. For example consider equation (1), the variables of this equation that do not change with respect to time (assuming that power control on range is not employed, § 2.3.3 of Annex 1) are:
Pt :	available transmit power (W)
BWtx :	transmit bandwidth (Hz)
 :	wavelength of transmitter (m)
k :	Boltzmann's constant (1.38  10–23 J/K)
T :	noise temperature (K)
Lp :	polarization isolation factor.
Therefore, for each interference path the following four constants can be computed before the simulation starts to step on each time increment:
TABLE  2
Link constants of simulation
In Table 2 the subscript 1 corresponds to constellation 1 downlink, 2 corresponds to constellation 2 downlink, 1 corresponds to constellation 1 uplink and 2 to constellation 2 uplink. The polarization isolation factor corresponds to the transmit/receive combination, i.e. 12 indicates the polarization isolation between the downlink transmitter of constellation 1 to the downlink transmitter of constellation 2.
2.3	Block C – Position constellation to time t
For each time step before any calculation of interference levels the position of the constellation is required to be computed. For this example the orbit model described in Annex 1, § 2.1 is employed. The velocity vector and position vector of each satellite are computed and stored in the data structure defined in block A of the simulation. The range between the earth station and the satellites of the constellation it is trying to communicate with is also computed in this step.
2.4	Block D – Check visibility of satellites (interfering and wanted)
This section determines which satellite is communicating to the earth station. First the satellite that the earth station was communicating with in the previous time step is checked to see if the earth station is able to continue communication (i.e. the range between the earth station and the satellite is  compared to the maximum possible range a satellite can be to continue communications, if larger then the communications need to be established with a new satellite). If communication with a new satellite needs to be established, then the algorithm shown in Annex 1, § 2.3.2 is used to select a new satellite for communication with the earth station.
Once each earth station has computed which satellite it is communicating with, the parameters associated with the interference between the satellite systems can be computed. This requires computing the range of the four interference paths and the off-axis angles associated with the interference paths (see Fig. 1).
2.5	Block E – Compute I0/N0 or epfd for all interference paths
The computation of the interference levels are now possible because all relative information has been computed in previous steps. The interference level for four interference paths between the two constellations are performed in this section (see Tables 3 and 4). The interference levels are stored for later analysis.
TABLE  3
I0/N0 computation using link constants
For the computation of the epfd at each time step, the following equations in Table 4 are used.
TABLE  4
epfd computation
In Tables 3 and 4, for example in the Const_1 downlink  Const_2 downlink path the variables are:
:	transmit gain of Const_1 downlink transmit antenna (relative intensity)
:	receiver gain of Const_2 downlink receive antenna (relative intensity)
R12 :	range between Const_1 transmitter (downlink) to Const_2 receiver (downlink) (m)
Ctraffic :	traffic coefficient applied to an earth station depending on its local time.
This section requires modification when power control on range is performed by one or both of the constellations under study.
2.6	Accounting for the aggregate impact of multiple earth stations/satellites on the interference levels
This aggregate of interference from multiple earth stations/satellites may be computed in either of two ways:
Case 1:	By performing multiple simulations for each earth station.
Case 2:	By performing one simulation that simulates all possible links.
The basic difference is when the aggregation of all earth stations/satellites is performed, in Case 1 it is done after the simulation is complete and in Case 2 it is done during the simulation.
2.6.1	Aggregate based on multiple simulations
This method of computing the aggregate interference from multiple sources of interference has advantages in that the contribution from each source of interference can be assessed and evaluated to determine which source has the largest impact on interference. The disadvantage is that the simulation must be performed multiple times for each possible source of interference, which may be time consuming. The amount of data required to be stored is relatively large for simulations contain a large number of data points and operator error may arise in the aggregate results.
To compute the aggregate based on multiple simulations the non-GSO constellation(s) must be set up so as to have the same initial starting and ending point in time and the interference level I0/N0 or the epfd, is saved for later analysis. After all sources of interference are computed the interference levels can be added together in time to arrive at an aggregate interference level.
As an example of the aggregate based upon multiple simulations consider the example shown in this Annex, § 3 and assume that it is desired to assess the aggregate impact of two GSO earth stations on the non-GSO up and downlinks. Both GSO earth stations are described by the parameters found in Tables 5 and 6, one of the GSO earth stations (GSO ET1) is located as found in Table 3 at 33:26:54 N, 112:04:24 W and the second GSO earth station (GSO ET2) located at 40:26:54 N, 112:04:24 W and is assumed to be served by a different satellite beam than that of GSO ET1. Both GSO earth stations are assumed to be co-frequency to the non-GSO station.
The next step is to run the simulation twice, once for each GSO earth station, and store the results for each time step. For example assume the following data sets are defined as:
I0/N0 1 or epfd1(t) :	time series of uplink I0/N0 or epfd at the non-GSO receiver for the two co-located earth stations (non-GSO and GSO ET1)
I0/N0 2 or epfd2(t) :	time series of uplink I0/N0 or epfd at the non-GSO receiver for the two separated earth stations (non-GSO and GSO ET2)
I0/N0 A or epfdA(t) :	time series of aggregate I0/N0 or epfd at the non-GSO receiver for all GSO earth stations.
After the two data sets are created the aggregate can be computed by summing the results. The uplink aggregate interference to the non-GSO satellite, I0/N0 A or epfdA(t), is found by:
I0/N0 A(ti)  I0/N0 1(ti)  I0/N0 2(ti)
epfd(ti)  epfd1(ti)  epfd2(ti)
where ti is the time steps at which the interference is computed. Note a requirement for this approach is that the non-GSO constellation is initialized at the same time and has the same time step for both simulations, i.e. the starting location and all subsequent locations of the constellation in space is the same for both simulations, if this is not done the results will be incorrect.
2.6.2	Aggregate based on one simulation
This method of computing the aggregate interference from multiple sources of interference has advantages in that only one simulation is performed for all possible sources of interference and the resultant time savings in performing only one simulation. A disadvantage is that the data cannot have a detailed review to evaluate which source of interference may be the largest contributor to the aggregate results. This disadvantage can be removed by allowing the user to have an option to save each individual contribution as a function of time.
Again as an example of the aggregate based upon multiple simulations consider the example shown described in § 2.6.1 for computing the interference from two GSO earth stations. In this case the analysis program sets up both earth stations and computes the aggregate interference for each time step.
2.7	Expressions of interference in terms of epfd and epfd
In Article 22 (Tables 22-1A to 22-1D, 22-2, 22-3, 22-4A to 22-4C and 22-4A1), epfd limits are indicated to protect GSO operations from co-channel non-GSO interference. This section describes how to relate the computed interference level of I0/N0 to uplink epfd values and downlink epfd values.
The epfd (W/(m2 · MHz)) is computed by:
(21)
where:
i :	index of the source of interference
Pti : 	available transmit power (W)
Gt (i) :	transmit gain (relative intensity)
Gr (i) :	receive antenna gain of the victim receiver in the direction of the i-th source of interference (dBi)
Gmax :	the maximum receive gain of the victim receiver (dBi).
The interference to noise ratio, I0/N0, is computed by:
(22)
where:
Pt :	available transmit power (W)
BWtx :	transmit bandwidth (Hz)
Gt (1) :	transmit gain (relative intensity)
Gr (2) :	receiver gain (relative intensity)
1 :	off bore-sight angle of the transmitter in the direction of the receiver
2 :	off bore-sight angle of the receiver in the direction of the transmitter
:	wavelength of transmitter (m)
R :	range (m)
k :	Boltzmann's constant (1.38  10–23 W/(Hz · K))
T :	noise temperature (K)
Lp :	polarization isolation factor.
The epfd (W/(m2 · Hz)) from i-th source taking into account the receive antenna discrimination and normalizing to the maximum receiver antenna gain can be expressed as:
(23)
in which it is assumed that .
Therefore taking into account equations (22) and (23), epfd (W/(m2 · Hz)) from the i-th source can be expressed in terms of I0i/N0 from the i-th source as:
(24)
Note that the factor  is a constant for the simulation and can be applied to the results of the simulation. It should be noted that if the I0/N0 used is the aggregate from multiple sources, the conversion factor can still be applied to aggregate I0/N0 to arrive at the aggregate epfd results shown in equation (21).
3	Example of non-GSO and GSO interference methodology
This section demonstrates an example of the results obtained using the geometric analysis defined by this methodology to interference analysis between a non-GSO system and a GSO network. The example presented in this Annex is for the LEO-A system and a GSO network. The input parameters for the constellations are in Table 5.
TABLE  5
Non-GSO and GSO simulation input parameters
Table 6 shows the radio-frequency parameters for non-GSO and GSO links. The missing portions of the table is information that is not required for the simulation. In the GSO system no power control on range is employed, therefore the Pr row is not required, similarly for the non-GSO system employing power control on range Pt, BWtx and Pt /BWtx are not required.
TABLE  6
System radio-frequency parameters
The results shown in Figs. 13 to 18 are for a simulation over 49 days sampled every 2 s. This results in over 2.1 million sample points.
Shown in Figs. 13 and 14 is the I0/N0 versus the per cent time that level occurs. Figure 13 shows the interference ratio of the non-GSO system into the GSO network, Fig. 14 shows the interference ratio of the GSO network into the non-GSO system.
Shown in Figs. 15 and 16 is the number of events and duration of those events that the interference ratio is greater than a pre-specified level. Figure 15 is the effect of the non-GSO system into the GSO network when an event is defined as occurring when I0/N0 is above –16 dB, Fig. 16 is the effect of the GSO network into the non-GSO system when an event is defined as occurring when I0/N0 is above –1 dB.
Shown in Figs. 17 and 18 is the I0/N0 of time history of the I0/N0 for interference from the GSO uplink into the non-GSO uplink. These graphs are shown during a period of time that the interference level reaches it peak. Figure 17 is over a time-scale of 1 h, the tics on the time axis are shown every 15 min. Figure 18 examines the peak interference event shown in Fig. 17.
3.1	Validation of interference results
To confirm that the interference levels computed in § 3 are within bounds of what is expected a comparison with a known check point is desired. A convenient check point is to compare the maximum interference levels shown in Figs. 12 and 13 with the interference level computed when the non-GSO satellite is directly in line with the path between the GSO earth station and the GSO satellite. Shown in Table 7 is the interference computation for the case of the non-GSO system interfering with the GSO network. The peak values of Fig. 13 and the interference value computed in Table 7 are the same.
TABLE  7
In-line computation of interference level from non-GSO
system into GSO network
Shown in Table 8 is the interference computation for the GSO network interfering with the non-GSO system. The peak values of Fig. 14 and the interference value computed in Table 8 are the same.
TABLE  8
In-line computation of interference level from GSO
network into non-GSO system
Annex  4

Continuing work programme
The following is an outline for further work on this Recommendation.
1	Adjust the run time to be that of the first repetition of the non-GSO subsatellite ground track when the other network is a GSO, and/or provide a discussion of the initial conditions and suitable run time for various constellations to ensure an unbiased statistical output.
2	Include a discussion in Annex 1, § 2.7 of the appropriate time step selection for various LEO and MEO constellations.
3	Further study is required to define the amount of isolation that can be assumed between the transmitter and receiver due to differing polarization. These studies should account for items such as atmospheric effects and systems that use phase comparative methods for tracking antennas.
4	Use of space station selection techniques when multiple satellites are in view of an earth station. Include a discussion of other techniques under consideration by other operators that may address interference avoidance or diversity techniques.
5	To take account in Annex 3, § 2.2 for systems employing power control based on the range between a non-GSO earth terminal and a non-GSO satellite.
6	To consider the appropriateness of including example of the methodologies in the Recommendation.
7	The desirability of including implementation details, such as optimizing constants as found in Annex 3, § 2.2, in the Recommendation. Consideration should also be given to the extent to which some parameters can be assumed to be constant, given factors such as adaptive peak gain antennas, power control and elliptical orbits.
8	Further work is needed to adapt this Recommendation to non-circular orbits.

=== R-REC-S.1503-2-201312-S!!MSW-E.docx ===
Foreword
The role of the Radiocommunication Sector is to ensure the rational, equitable, efficient and economical use of the radio-frequency spectrum by all radiocommunication services, including satellite services, and carry out studies without limit of frequency range on the basis of which Recommendations are adopted.
The regulatory and policy functions of the Radiocommunication Sector are performed by World and Regional Radiocommunication Conferences and Radiocommunication Assemblies supported by Study Groups.
Policy on Intellectual Property Right (IPR)
ITU-R policy on IPR is described in the Common Patent Policy for ITU-T/ITU-R/ISO/IEC referenced in Annex 1 of Resolution ITU-R 1. Forms to be used for the submission of patent statements and licensing declarations by patent holders are available from http://www.itu.int/ITU-R/go/patents/en where the Guidelines for Implementation of the Common Patent Policy for ITU-T/ITU-R/ISO/IEC and the ITU-R patent information database can also be found.
Electronic Publication
, 2014
ITU 2014
All rights reserved. No part of this publication may be reproduced, by any means whatsoever, without written permission of ITU.
RECOMMENDATION  ITU-R  S.1503-2
Functional description to be used in developing software tools for determining conformity of non-geostationary-satellite orbit fixed-satellite system networks with limits contained in Article 22 of the Radio Regulations
(2000-2005-2013)
Scope
This Recommendation provides a functional description of the software for use by the Radiocommunication Bureau of ITU to conduct examination of non-GSO  system notifications for their compliance with the “validation” limits specified in the Radio Regulations.
Keywords
Epfd; non-GSO; methodology.
Abbreviations/Glossary
Alpha angle (): the minimum angle at the GSO earth station between the line to the non-GSO satellite and the lines to the GSO arc.
e.i.r.p. mask: equivalent isotropic radiated power mask used to define the emissions of the non-GSO earth station in the epfd(up) calculation or the emissions of the non-GSO satellite for the epfd(IS) calculation.
epfd: equivalent power flux-density, as defined in RR No. 22.5C.1, of which there are three cases to consider:
epfd(down): emissions from the non-GSO satellite system into a GSO satellite earth station;
epfd(up): emissions from the non-GSO earth station into a GSO satellite;
epfd(IS): inter-satellite emissions from the non-GSO satellite system into a GSO satellite system.
pfd mask: power flux-density mask used to define the emissions of the non-GSO satellite in the epfd(down) calculation.
X angle (X): the minimum angle at the non-GSO satellite between the line from the GSO earth station and the lines to the GSO arc.
: Worst Case Geometry, the location of the GSO earth station and GSO satellite that analysis suggests would cause the highest single entry epfd values for given inputs.
Related ITU-R Recommendations
The ITU Radiocommunication Assembly,
considering
a)	that WRC-2000 adopted, in Article 22, single-entry limits applicable to non-geostationary  satellite orbit (non-GSO) fixed-satellite service () systems in certain parts of the frequency range 10.7-30 GHz to protect geostationary satellite orbit (GSO) networks operating in the same frequency bands from unacceptable interference;
b)	that these frequency bands are currently used or planned to be used extensively by geostationary-satellite systems (GSO systems);
c)	that during the examination under Nos. 9.35 and 11.31, the Bureau examines non-GSO  systems to ensure their compliance with the single-entry epfd limits given in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the Radio Regulations (RR);
d)	that to perform the regulatory examination referred to in considering c), the Radiocommunication Bureau (BR) requires a software tool that permits the calculation of the power levels produced by such systems, on the basis of the specific characteristics of each non-GSO  system submitted to the Bureau for coordination or notification, as appropriate;
e)	that GSO  and GSO broadcasting-satellite service (BSS) systems have individual characteristics and that interference assessments will be required for multiple combinations of antenna characteristics, interference levels and probabilities;
f)	that designers of satellite networks (non-GSO , GSO  and GSO BSS) require knowledge of the basis on which the BR will make such checks;
g)	that such tools may be already developed or under development and may be offered to the BR,
recommends
1	that the functional description specified in Annex 1 should be used to develop software tools calculating the power levels produced by non-GSO  systems and the compliance of these levels with the limits contained in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the RR.
Annex 1

Functional description of software for use by the BR in checking 
compliance of non-GSO FSS systems with epfd limits
TABLE OF CONTENTS
Page
PART A – Fundamental constraints and basic assumptions		3
PART B – Input parameters		9
PART C – Generation of pfd/e.i.r.p. masks		20
PART D – Software for the examination of non-GSO filings		38
PART E – Testing of the reliability of the software outputs		113
PART F – Software implementing this Recommendation		115
PART A
Fundamental constraints and basic assumptions
1	General
1.1	Purpose
The software algorithm described in this Annex is designed for its application by the BR to conduct examination of the non-GSO  system notifications for their compliance with the limits contained in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the RR.
The algorithm could also under certain conditions permit examination of whether coordination is required between non-GSO  systems and large earth stations under Articles 9.7A and 9.7B using the criteria in RR Appendix 5.
The algorithm in this Recommendation was developed based upon a reference GSO satellite in equatorial orbit with zero inclination angle. The analysis to determine whether a non-GSO satellite system meets the epfd limits in Article 22 of the RR is made by calculating the epfd levels at this reference satellite or at an earth station pointing towards it. A GSO satellite system operating at other inclination angles could be predicted to receive higher epfd levels without the non-GSO satellite system being considered in breach of the Article 22 limits. Analysis under RR Nos. 9.7A and 9.7B, however, is to determine if coordination is required by comparing against the trigger level in Appendix 5 of the RR, and therefore in this case other methodologies, including those that assume non-zero GSO satellite inclination, could be acceptable alternatives.
1.2	Software block-diagram
The block-diagram of the software algorithm described in this Annex is shown in Fig. 1. It comprises initial data and calculation for the notifying administration and the BR. The data section contains the whole set of parameters relevant to the notified non-GSO system, a set of reference GSO system parameters as well as epfd limits provided by the BR.
The calculation section is designed for estimations required to examine notified non-GSO systems compliance with the epfd limits. The calculation section is based on a concept of a downlink power flux-density (pfd) mask (see Note 1), an uplink effective isotropic radiated power (e.i.r.p.) mask (see Note 2) and inter-satellite e.i.r.p. mask (see Note 3).
NOTE 1 – A pfd mask is a maximum pfd produced by a non-GSO space station and is defined in Part C.
NOTE 2 – An e.i.r.p. mask is a maximum e.i.r.p. radiated by a non-GSO earth station and is a function of an off-axis angle for the transmitting antenna main beam.
NOTE 3 – An inter-satellite e.i.r.p. mask is a maximum e.i.r.p. radiated by a non-GSO space station and is a function of an off-axis angle for the boresight or (azimuth, elevation) angles of the non-GSO space station.
The pfd / e.i.r.p. masks are calculated by the filing administration as identified in Block 1 and then supplied with the other non-GSO system parameters in Blocks a and b. The BR supplies additional parameters, in particular the epfd limits in Block c.
FIGURE 1
Stages in epfd Verification - Key Logic Blocks
1.3	Allocation of responsibilities between Administrations and the BR for software employment
Taking into account significant complexity regarding specific features of different non-GSO system configurations in the software it would seem appropriate to impose some burden of responsibility relevant to testing for epfd limits on administrations notifying appropriate non-GSO systems. Therefore the examination procedure for meeting epfd limits would consist of two stages.  The first stage would include derivation of a mask for pfd / e.i.r.p. produced by interfering non-GSO network stations. The mask would account for all the features of specific non-GSO systems arrangements (such as possible beam pointing and transmit powers). The first stage would be finalized  by the delivery of the pfd / e.i.r.p. mask to the BR.
The second stage calculations would be effected at the  The second stage would feature the following operations:
–	Identification of the runs required for a non-GSO network taking into account the frequencies for which it has filed and the frequency ranges for which there are epfd limits in Article 22 (Block 2).
–	Definition of the maximum epfd geometry of a GSO space station and an earth station of that network (Block 3). It would ensure verification of sharing feasibility for a notified non-GSO network with any GSO network in the  and BSS.
–	epfd statistics estimation (Block 4).
–	Making a decision on interference compliance with appropriate epfd limits.
The estimations are based on the non-GSO system parameters (Blocks a and b) delivered by a notifying administration and the initial data (Block c) available at the
Any administration may use software that uses the algorithms defined in this Annex together with data on the non-GSO networks to estimate statistics for interference into its own GSO networks and check for compliance with epfd limits. It would assist in solving probable disputes between the BR and administrations concerned.
The elements of the software block-diagram discussed are presented hereinafter in detail. The Parts are as follows:
Part A	–	Basic limitations and main system requirements for the software as a whole are presented.
Part B	–	Non-GSO networks parameters and initial data for Blocks a and b are discussed.
Part C	–	Definitions and estimation algorithms for pfd / e.i.r.p. masks relative to non-GSO network earth and space stations are presented. Specifics of those masks applying in simulation is also discussed (Block 1).
Part D	–	The part deals with general requirements on the software related to examination of non-GSO networks notifications, algorithms to estimate epfd statistics, and the format for output data presentation. Part D covers issues of Blocks 2, 3 and 4.
Parts E, F	–	These parts define requirements on the software related to valuation of delivered software and to verification of the software output on validity.
2	Fundamental assumptions
2.1	Units of measurement
To provide for adequate simulation results and to avoid errors a common measurement units system is used in Table 1 for the software description. The list of measurement units for the basic physical parameters is shown in Table 1.
TABLE 1
The system of measurement units for basic physical parameters used
for the software performance description
2.2	Constants
The functional description of the software for examination of non-GSO networks notification at the BR uses the constants shown in Table 2.
TABLE 2
Constants to be used by software
2.3	The Earth model
The force of the Earth attraction is the main factor to define a satellite orbital motion. Additional factors include:
–	orbit variations due to the Earth’s oblateness and its mass distribution irregularities;
–	solar and lunar attraction;
–	medium drag for satellite;
–	solar radiation pressure, etc.
The function description of software in this Annex accounts orbit perturbations only due to the Earth oblateness. It is motivated by the fact that effect of other perturbing factors is significantly less. The Earth’s oblateness causes secular and periodic perturbations of ascending node longitude and orbit perigee argument. Part D.6.3 describes expressions to account the Earth’s oblateness effect.
The orbits of some repeating ground tracks can be very sensitive to the exact orbit model used. Administrations could also provide the BR with their own independently determined average precession rates that could be used by the software instead of the values calculated using the equation in Part D.6.3.
2.4	Constellation types
The algorithm in this Recommendation has been developed to be applicable to at least the non-GSO satellite systems shown in Table 3.
TABLE 3
Orbit type classification
3	Modelling methodology
The approach described in this Annex involves time simulation in which interference levels are evaluated on a time step by time step basis. Section D.4 defines the method to calculate the size of time steps and the total number of time steps to be used. This section also identifies an optional dual time step approach to reduce run times without altering the resulting decision.
PART B
Input parameters
1	Introduction
1.1	Background
Certain parameters for a non-GSO network and other data must be specified in order to accomplish the requisite software functions:
–	Function 1: Provide the pfd masks for the non-GSO satellites (downlink) and the e.i.r.p. mask for the earth stations transmitting to those satellites (uplink).
–	Function 2: Apply the e.i.r.p. mask in the calculation of uplink epfd↑ levels and downlink equivalent pfd (epfd↓) levels (cumulative time distributions of epfd↑ or epfd↓).
–	Function 3: Determine whether the pfd / e.i.r.p. mask levels are consistent with basic transmission parameters of the non-GSO network, only in the case of dispute.
The roles of the administration of the non-GSO network and the BR are discussed in § A.1.3.
Detailed parameters are needed by the BR in support of Function 2 and so this section focuses on the parameters needed to fulfil that requirement.
The parameters provided should be consistent, so that if the administrations modifies its network so that the pfd / e.i.r.p. changes then a new mask would need to be supplied to the BR.
1.2	Scope and overview
This section identifies inputs to the software in four main paragraphs:
–	Paragraph 2 defines the inputs from the BR;
–	Paragraph 3 defines the inputs from the non-GSO operator excluding the pfd / e.i.r.p masks;
–	Paragraph 4 defines the pfd / e.i.r.p. masks.
An Attachment to Part B then maps the parameters to the  database tables.
Note that in the following tables, square brackets in variable names indicate an index for that variable and not tentative text.
2	BR supplied parameters to software
The BR supplies two types of data, firstly the type of run to execute:
The second data is to provide the threshold epfd levels to use as the pass / fail criteria. These are accessed by the software when generating the runs and consists of a series of records as follows:
3	Non-GSO system inputs to software
These are split into constellation parameters and then a set of orbit parameters for each space station.
3.1	Non-GSO constellation parameters
3.2	Non-GSO space station parameters
4	pfd / e.i.r.p. masks
4.1	Non-GSO downlink pfd mask
4.2	Non-GSO uplink e.i.r.p. mask
4.3	Non-GSO inter-satellite e.i.r.p mask
Attachment to Part B
This Attachment to Part B details the parameters that the epfd software uses from the  database
Table 4 lists the current RR Appendix 4 information for non-GSO satellite systems included in the BR space networks system (SNS) database. The relationship between the database tables is shown in Fig. 2. Mask information and link tables are not shown in Fig. 2 but are described in Table 4.
Format description
Figure 2
Extract from  entity relationship
TABLE 4
Appendix 4 data for epfd analysis
Notice
Non-geo
orbit
orbit (continued)
Phase
Grp
srv_cls
Mask_info
e_as_stn
sat_oper
mask_lnk1
mask_lnk2
Tables used in the Article 9.7A/9.7B calculations
e_stn
e_ant
PART C
Generation of pfd/e.i.r.p. masks
1	Definition
The purpose of generating pfd masks is to define an envelope of the power radiated by the non-GSO space stations and the non-GSO earth stations so that the results of calculations encompass what would be radiated regardless of what resource allocation and switching strategy are used at different periods of a non-GSO system life.
The concept of satellite-based reference angle could be used to calculate the pfd mask.
2	Generation of satellite pfd masks
2.1	General presentation
The satellite pfd mask is defined by the maximum pfd generated by any space station in the interfering non-GSO system as seen from any point at the surface of the Earth. A four dimensional pfd mask is recommended for use by the BR verification software and is defined following one of the two options:
Option 1: As a function of:
–	the non-GSO satellite;
–	the latitude of the non-GSO sub-satellite point;
–	the separation angle  (or X) between this non-GSO space station and the GSO arc, as seen from any point on the surface of the Earth (at the satellite), as defined in § D.6.4.4;
–	the difference L in longitude between the non-GSO sub-satellite point and the point on the GSO arc where the  (or X) angle is minimized, as defined in § D.6.4.4.
Option 2: As a function of:
–	the non-GSO satellite;
–	the latitude of the non-GSO sub-satellite point;
–	the azimuth angle, defined in § D.6.4.5;
–	the elevation angle, defined in § D.6.4.5.
Whatever parameters are used to generate the pfd mask, the resulting pfd mask should be converted to one of the format options above.
Because the non-GSO space station can generate simultaneously a given maximum number of beams, it should be taken into account in order to better fit the system design and not be too constraining for non-GSO systems.
The mitigation techniques used by the non-GSO system, such as the GSO arc avoidance, are implemented in the calculation of the pfd mask. The GSO arc avoidance defines a non-operating zone on the ground in the field of view of a non-GSO space station. The location of this non-operating zone on the ground will move as a function of the latitude of the non-GSO sub-satellite point. To get a more accurate model of a non-GSO system, the latitude of the non-GSO sub-satellite point is taken as a parameter to the pfd mask calculation.
Use of  or X angle pfd masks implies that the same definition of GSO angle is used for exclusion angle in the calculation of epfd↓.
2.2	Mitigation techniques description
The mitigation technique implemented within the non-GSO system should be accurately explained in this section in order to be fully modelled in the calculation of the epfd↑.
With regard to the use of a non-operating zone around the GSO arc, there are at least three different ways of modelling a non-GSO system based on a cell architecture:
–	Cell-wide observance of a non-operating zone: a beam of a non-GSO space station is switched off if the separation angle between this non-GSO space station and the GSO arc, at any point of the non-GSO cell, is less than 0 (GSO arc avoidance angle).
–	Cell-centre observance of a non-operating zone: a beam of a non-GSO space station is switched off when the centre of the cell sees this non-GSO space station at less than 0 from the GSO arc.
–	A satellite-based reference: a beam of a non-GSO space station turns off when a satellite-based reference angle, X, is less than X0. The reference angle, X, is the angle between a line projected from the GSO arc through the non-GSO space station to the ground and a line from the non-GSO space station to the edge of the non-GSO beam.
Other mitigation techniques may be used by a non-GSO system which are not listed here. Information on these techniques will be provided by the non-GSO administration for the description and verification of the pfd mask.
Figure 3 shows a satellite-based reference with beam switch off inside an X angle based exclusion zone.
Figure 3
Overhead beam view of satellite-based exclusion angle
2.3	pfd calculation
2.3.1	pfd calculation
The pfd radiated by a non-GSO space station at any point on the Earth’s surface is the sum of the pfd produced by all illuminating beams in the co-frequency band.
Some non-GSO systems have tracking antennas which point to cells fixed on the Earth’s surface and do not move with the spacecraft. However, since the pfd mask is generated with respect to the non-GSO location, assumptions must be made in the development of the pfd mask. Making the simplifying assumption that the cells move with the spacecraft can lead to inaccurate geographic distributions of epfd levels.
As non-GSO systems use mitigation techniques, there will be no main beam-to-main beam alignment. Therefore, de-polarization effects mean that both co-polarization and cross-polarization contributions must be included as sources of interference.
The implementation of the pfd mask explicitly accounts for both co-polarization and cross-polarization from non-GSO satellites into GSO earth stations for like types of polarization (circular-to-circular or linear-to-linear). Isolation between systems of different types of polarization (circular-to-linear) is not directly covered. A study has shown that the average total interference power over all axial ratios and polarization ellipse orientations is a very small net increase in the received interference power in the BSS antenna of 0.048 dB. The bounds of any cross-polarization contributions, that are very unlikely to be reached, are from –30 dB to 3 dB.
Then:
where:
pfd:	pfd radiated by a non-GSO space station (dB(W/m2)) in the reference bandwidth
i:	index of the beams illuminated in the polarization considered
Nco:	maximum number of beams which can be illuminated simultaneously in the polarization considered
pfd_coi:	pfd produced at the point considered at the Earth’s surface by one beam in the polarization considered (dB(W/m2)) in the reference bandwidth
j:	index of the beams illuminated in the opposite polarization to the polarization considered
Ncross:	maximum number of beams which can be illuminated simultaneously in the opposite polarization to the polarization considered
pfd_crossj:	pfd produced at the point considered at the Earth’s surface by one beam in the opposite polarization to the polarization considered (dB(W/m2)) in the reference bandwidth
and
where:
Pi:	maximum power emitted by the beam i in the reference bandwidth (dB(W/BWref))
BWref:	reference bandwidth (kHz)
Gi:	gain generated by the beam i in the polarization considered at the point considered at the Earth’s surface (dBi)
d: 	distance between the non-GSO space station and the point considered at the Earth’s surface (if the non-GSO satellite antenna gain is in isoflux, d is the altitude of the non-GSO space station) (m)
and
where:
G_crossj:	cross-polarization gain generated by the beam j illuminated in the opposite polarization to the polarization considered, at the point considered at the Earth’s surface (dBi).
It is expected that the parameters used to generate the pfd / e.i.r.p. mask correspond to the performance of the non-GSO satellite over its anticipated lifetime.
2.3.2	Satellite antenna gain at the point considered at the Earth’s surface
The objective of this section is to determine the gain in the direction of a point M at the Earth’s surface when the satellite antenna points towards a cell i. The antenna coordinate can be defined by four ways of the coordinate system:
 :	spherical coordinate
v :	u  sin  cos , v  sin  sin 
B :	A   cos , B   sin 
(Az, El) :	sin (El)  sin  sin , tan (Az)  tan  cos 
As an example, the following calculations are performed in the antenna reference (A, B).
The sampling of the non-GSO antenna pattern should be adapted so that interpolation does not lead to gain level significantly different from real values.
Figure 4 presents the geometry in the antenna plane (A, B).
Figure 4
Antenna plane (A, B)
The coordinates of the point M at the Earth’s surface are (a, b) in the antenna plane (A, B), corresponding to (M, M) in the polar reference.
The coordinates of the point C centre of the cell i, are (Ac, Bc) in the antenna plane (A, B), and (c, c) in the spherical reference.
For satellite antenna gain patterns with functional descriptions (i.e. equations), the gain into the point M may be computed directly from the coordinates C(Ac, Bc) and M(a, b). For other patterns, the satellite antenna gains are provided in a grid of (A, B) points, and the point M(a, b) may be located between four points of the grid (A, B).
In general, it is therefore necessary to undertake interpolation between data points. Consider a grid of values P for a range of x values = {x1, x2, …} and y values = {y1, y2,…} as in Fig. 5.
figure 5
Interpolation between data points
The value of parameter P at point (x, y) can be derived by identifying the bounding values and hence:
Then P can be interpolated using:
P = (1 – λx)(1 – λy)P11 + λx (1 – λy)P21 + (1 – λx)λyP12 + λxλyP22
The sampling of the non-GSO satellite antenna pattern should be adapted so that interpolation does not lead to significant approximation.
The same criteria should be used when sampling the pfd mask.
2.4	Methodology
The pfd mask is defined by the maximum pfd generated by any space station in the interfering non-GSO system and as a function of the parameters defined either in option 1 or option 2. For the generation of the pfd mask, the cells in the non-GSO satellite footprint are located according to the beam pointing utilized by the non-GSO system. For satellites with steerable antennas, the satellite can point to the same area of the Earth throughout its track through the sky.
These cells are fixed relative to the Earth’s surface. For satellites that have antenna-pointing angles fixed relative to the satellite, the cell pattern is the same relative to the satellite but is moving relative to the Earth.
2.4.1	Option 1
Option 1 has been described for a pfd mask defined as a function of the separation angle , as an example. If the pfd mask is provided as a function of the X angle, the following calculation remains the same replacing  with X angle.
The pfd mask is defined as a function of the separation angle  between this non-GSO space station and the GSO arc, as seen from any point on the surface of the Earth, and the difference L in longitude between the non-GSO sub-satellite point and the GSO satellite.
The angle  is therefore the minimum topocentric angle measured from this particular earth station between the interfering non-GSO space station and any point in the GSO arc.
The objective of the mask is to define the maximum possible level of the pfd radiated by the non-GSO space station as a function of the separation angle between the non-GSO space station and the GSO arc at any point on the ground, per interval of L.
At each point of the non-GSO satellite footprint, the pfd value depends on:
–	the configuration of the spot beams which are illuminated by the satellite;
–	the maximum number of co-frequency beams which can be illuminated simultaneously;
–	the maximum number of co-frequency, co-polarization beams which can be illuminated simultaneously;
–	the maximum power available at the satellite repeater.
The proposed methodology for the generation of the pfd mask is explained in the following steps:
Step 1:  At any given time, in the field of view of a non-GSO space station, Ntotal is the maximum number of cells that can be seen with the minimum service elevation angle.
Step 2:  In the field of view of the non-GSO space station, it is possible to draw iso- lines, i.e. the points on the surface of the Earth which share the same value of  (see Figs. 6 and 7).
Figure 6
Field of view of a non-GSO space station (Option 1)
Step 3:  Along the iso- line, define intervals of L: difference in longitude between the non-GSO sub-satellite point and the point on the GSO arc where the  (or X) angle is minimized.
Step 4:  Per each interval of L, the iso- line can be defined by a set of n points M,k for k  1, 2,...n. To determine the maximum pfd corresponding to a given value of ,it is necessary to calculate the maximum pfd at each of the points M,k for k  1, 2,...n. The maximum pfd at a given M,k is determined by first finding the pfd contributed by each celli toward M,k taking into account the dependency of the sidelobe patterns on the beam tilt angle. The maximum pfd contributions toward M,k are then summed, with the number of contributions constrained by the physical limitations of the space station:
–	Out of the Ntotal cells that can be seen within the coverage area of the space station under a minimum elevation angle for communication, only Nco can be illuminated at the same frequency bandwidth, in one sense of polarization, and Ncross in the other sense of polarization. This characterizes the limitation of the antenna system on the non-GSO space station. To calculate the mask in one polarization, the cells which can be illuminated in the polarization concerned are identified, and the cross-polarization level is considered for other cells.
–	Out of these Nco and Ncross cells, only a given number can be powered simultaneously. This characterizes the limitation of the repeater system of the non-GSO space station.
–	If applicable, the limitations in terms of frequency reuse pattern and polarization reuse pattern also need to be clarified.
–	If applicable the power allocated to one cell may vary taking into account the elevation angle relative to this cell, for example.
Figure 7
View in 3D of the iso- line
Step 5:  The generation of the pfd mask also needs to take into account accurately the mitigation technique implemented within the non-GSO system.
With regard to the use of a non-operating zone around the GSO arc, there are three different ways of modelling a non-GSO system based on a cell architecture:
–	cell-wide observance of a non-operating zone: a beam is switched off when one point on the Earth sees a non-GSO satellite within 0 of the GSO arc. In this particular case, any beam illuminating a cell which is crossed by an iso- line corresponding to a value   0 is switched off;
–	cell-centre observance of a non-operating zone: a beam is switched off when the centre of the cell sees a non-GSO satellite within 0 of the GSO arc. In this case, any beam illuminating a cell with its centre inside the non-operating zone bounded by the two iso-0 lines is switched off;
–	if a satellite-based reference is chosen: a beam of a non-GSO space station turns off when the angle, X, is less than X0. The reference angle X is the angle between a line projected from the GSO arc through the non-GSO space station to the ground and a line from the non-GSO space station to the edge of the non-GSO beam.
Step 6:  The maximum pfd value corresponding to a given value  within an interval of L is:
pfd(, L)    maxk = 1, 2,...n(pfd(M,k))
Step 7:  The location of an iso- line, hence the value of the maximum pfd along this line depends on the latitude of the non-GSO sub-satellite point. Therefore, a set of pfd masks will need to be provided, each corresponding to a given latitude of the sub-satellite point.
Step 8:  A set of pfd masks may be needed (one per non-GSO satellite).
2.4.2	Option 2
The pfd mask is defined in a grid in azimuth and elevation, per latitude of the non-GSO sub-satellite.
The objective of the mask is to define the maximum possible level of the pfd radiated by the non-GSO space station in this azimuth elevation grid.
At each point of the non-GSO satellite footprint, the pfd value depends on:
–	the configuration of the spot beams which are illuminated by the satellite;
–	the maximum number of co-frequency beams which can be illuminated simultaneously;
–	the maximum number of co-frequency, co-polarization beams which can be illuminated simultaneously;
–	the maximum power available at the satellite repeater.
Figure 8
Field of view of a non-GSO space station (Option 2)
The proposed methodology for the generation of the pfd mask is explained in the following steps:
Step 1:  At any given time, in the field of view of a non-GSO space station, Ntotal is the maximum number of cells that can be seen with the minimum service elevation angle.
Step 2:  For each point M(Az, El), determine the maximum pfd. The maximum pfd at a given M,k is determined by first finding the pfd contributed by each celli toward MAz, El) taking into account the dependency of the sidelobe patterns on the beam tilt angle. The maximum pfd contributions toward M,k are then summed, with the number of contributions constrained by the physical limitations of the space station:
–	Out of the Ntotal cells that can be seen within the coverage area of the space station under a minimum elevation angle for communication, only Nco cells can be illuminated at the same frequency bandwidth, in one sense of polarization, and Ncross cells in the other sense of polarization. This characterizes the limitation of the antenna system on the non-GSO space station. To calculate the mask in one polarization, the cells which can be illuminated in the polarization concerned are identified, and the cross-polarization level is considered for other cells.
–	Out of these Nco and Ncross cells, only a given number can be powered simultaneously. This characterizes the limitation of the repeater system of the non-GSO space station.
–	If applicable, the limitations in terms of frequency reuse pattern and polarization reuse pattern also need to be clarified.
–	If applicable the power allocated to one cell may vary taking into account the elevation angle relative to this cell, for example.
Step 3:  The generation of the pfd mask also needs to take into account accurately the mitigation technique implemented within the non-GSO system.
With regard to the use of a non-operating zone around the GSO arc, there are three different ways of modelling a non-GSO system based on a cell architecture:
–	cell-wide observance of a non-operating zone: a beam is switched off when one point on the Earth sees a non-GSO satellite within 0 of the GSO arc. In this particular case, any beam illuminating a cell which is crossed by an iso- line corresponding to a value   0 is switched off;
–	cell-centre observance of a non-operating zone: a beam is switched off when the centre of the cell sees a non-GSO satellite within 0 of the GSO arc. In this case, any beam illuminating a cell with its centre inside the non-operating zone bounded by the two iso-0 lines is switched off;
–	if a satellite-based reference is chosen: a beam of a non-GSO space station turns off when the angle, X, is less than X0. The reference angle X is the angle between a line projected from the GSO arc through the non-GSO space station to the ground and a line from the non-GSO space station to the edge of the non-GSO beam.
Step 4:  A set of pfd masks may need to be provided as a function of the latitude of the sub-satellite point.
Step 5:  A set of pfd masks may be needed (one per non-GSO satellite).
3	Generation of e.i.r.p. masks
3.1	Generation of earth station e.i.r.p. masks
3.1.1	General presentation
The earth station e.i.r.p. mask is defined by the maximum e.i.r.p. as a function of the off-axis angle generated by an earth station. There can be different e.i.r.p. masks applicable at different latitudes.
The non-GSO earth station is located in a non-GSO cell which is served by a maximum number of non-GSO space stations. The density of non-GSO earth stations which can operate co-frequency simultaneously is also used as an input to the calculation.
3.1.2	Mitigation techniques description
The mitigation technique implemented within the non-GSO system should be accurately explained in this section in order to be fully modelled in the calculation of the epfd↑ (see § C.2.2).
3.1.3	Earth station antenna pattern
The earth station antenna pattern used needs to be identified to calculate the earth station e.i.r.p. mask.
3.1.4	Methodology
Step 1:  The earth station e.i.r.p. mask is defined by the maximum e.i.r.p. radiated in the reference bandwidth by the earth station as a function of the off-axis angle, and is given by:
ES_e.i.r.p(θ)  =  G(θ) + P
where:
ES_e.i.r.p.:	equivalent isotropic radiated power in the reference bandwidth (dB(W/BWref))
:	separation angle between the non-GSO space station and the GSO space station at the non-GSO earth station (degrees)
G():	earth station directional antenna gain (dBi)
P:	maximum power delivered to the antenna, in the reference bandwidth (dB(W/BWraf))
BWraf:	reference bandwidth (kHz).
Step 2:  Assuming that the non-GSO cells are uniformly distributed on the Earth’s surface, the simultaneous co-frequency transmit non-GSO earth stations are evenly distributed over the cell. Therefore the interferer can be located at the centre of the cell to perform the simulation.
This exercise would be repeated for all latitudes for which the ES_e.i.r.p. could be different.
3.2	Generation of space station e.i.r.p. masks
The space station e.i.r.p. mask is defined by the maximum e.i.r.p. generated by a non-GSO space station as a function of the off-axis angle between the boresight of the non-GSO space station considered and the direction of the GSO space station.
The space station e.i.r.p. mask is defined by the maximum e.i.r.p. radiated in the reference bandwidth by the space station as a function of the off-axis angle, and is given by:
NGSO_SS_e.i.r.p.()    G()  P
where:
NGSO_SS_e.i.r.p.:	equivalent isotropic radiated power in the reference bandwidth (dB(W/BWref))
	separation angle between the boresight of the non-GSO space station and the pointing direction of the GSO space station (degrees)
G():	space station antenna gain pattern (dBi) corresponding to the aggregation of all beams
P:	maximum power, in the reference bandwidth (dB(W/BWrif))
BWrif:	reference bandwidth (kHz).
4	pfd and e.i.r.p. mask format
4.1	General structure of masks
One of the inputs to Recommendation ITU-R S.1503 are the pfd and e.i.r.p. masks, namely:
–	For epfd(down) runs, the pfd mask(s), containing tables of pfd(, long) or of pfd(azimuth, elevation) together with the latitude for which each table is valid.
–	For epfd(up) runs, the non-GSO earth station e.i.r.p. mask(s), each one contains tables of e.i.r.p. () together with the latitude for which each table is valid.
–	For epfd(IS) runs, the non-GSO satellite e.i.r.p. masks, each one contains tables of e.i.r.p. () together with the latitude for which each table is valid.
During the simulation, the software will calculate the relevant parameters, such as latitude and off-axis angle or  angle, and then use the mask to calculate a pfd or e.i.r.p. using the following approach:
1)	The array of {Latitude, Table} is searched and the table which has the nearest latitude to the value calculated in the simulation is selected.
2)	Using the selected table, the pfd or e.i.r.p. is then calculated by interpolation using:
a)	pfd: calculated using bi-linear interpolation in either pfd(, long) or pfd(azimuth, elevation);
b)	e.i.r.p.: calculated using linear interpolation in e.i.r.p. ().
Each table is independent i.e. at different latitudes it can use a different grid resolution and range. The mask does not need to cover the whole range: outside the supplied values the last valid value is assumed to be used.
However, it should be noted that for latitude and {azimuth, elevation, , long} regions where no actual pfd is produced, in order to avoid using nearest latitude table containing operational pfd values it is advisable to provide extremely low pfd values for these ranges to simulate no transmission scenario.
The pfd mask table is not assumed to be symmetric in {azimuth, elevation, , long} and should be given for the full range from positive to negative extremes. The e.i.r.p. masks are assumed to be symmetric around the boresight line via use of the off-axis angle as the parameter. In the case that the {azimuth, elevation, , long, off-axis angle} calculated in the simulation is outside the ranges given in the pfd or e.i.r.p. masks, then the last valid value should be used.
For the ES e.i.r.p. masks, there is the option to specify the position by (latitude, longitude) rather than density via a reference to a specific ES in the . Note that it is not permitted to mix types: either all non-GSO ES are to be defined via specific ES or all via the density field.
Each mask has header information giving:
–	Notice ID
–	Satellite name
–	Mask ID
–	Lowest frequency mask is valid in MHz
–	Highest frequency mask is valid in MHz
–	Mask type
–	Parameters of mask.
The masks relationships are shown in Figs. 9 to 11.
Figure 9
Structure of pfd mask data for epfd(down)
Figure 10
Structure of pfd mask data for epfd(up)
Figure 11
Structure of pfd mask data for epfd(IS)
The pfd masks are to be provided to the ITU BR in XML format as:
–	It is both machine readable and human readable
–	Allows both format and type checking
–	Is an international standard for exchange of data.
The XML format is plain text with opening and closing blocks, as in
<satellite_system>
</satellite_system>
Within each section there are then fields relevant to that block.
At the top level the satellite system is identified via its notice ID and name using:
<satellite_system ntc_id="NNNNNNN" sat_name="NAME">
[Header]
[Tables]
</satellite_system>
Within this structure there is the header followed by each of the tables.
The format for each mask is described in more detail in the sections below.
4.2	pfd mask for epfd(down)
The header format of the pfd mask is as follows:
<pfd_mask mask_id="N" low_freq_mhz="F1" high_freq_mhz="F2" type="Type" a_name="latitude" b_name="B" c_name="C">
where (see Table 5):
TABLE 5
pfd mask header format
For each of a, b, c there are then arrays of values, such as:
<by_a a="N">
</by_a>
The values within that open/close structure then all relate to a = N: a similar structure is used for b values.
The innermost group gives the actual pfd value, such as:
<pfd c="0">–140</pfd>
An example pfd mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<pfd_mask mask_id="3" low_freq_mhz="10000" high_freq_mhz="40000" type="alpha_deltaLongitude" a_name="latitude" b_name="alpha" c_name="deltaLongitude">
<by_a a="0">
<by_b b="–180">
<pfd c="–20">–150</pfd>
<pfd c="0">–140</pfd>
<pfd c="20">–150</pfd>
</by_b>
<by_b b="–8">
<pfd c="–20">–165</pfd>
<pfd c="0">–155</pfd>
<pfd c="20">–165</pfd>
</by_b>
<by_b b="–4">
<pfd c="–20">–170</pfd>
<pfd c="0">–160</pfd>
<pfd c="20">–170</pfd>
</by_b>
<by_b b="0">
<pfd c="–20">–180</pfd>
<pfd c="0">–170</pfd>
<pfd c="20">–180</pfd>
</by_b>
<by_b b="4">
<pfd c="–20">–170</pfd>
<pfd c="0">–160</pfd>
<pfd c="20">–170</pfd>
</by_b>
<by_b b="8">
<pfd c="–20">–165</pfd>
<pfd c="0">–155</pfd>
<pfd c="20">–165</pfd>
</by_b>
<by_b b="180">
<pfd c="–20">–150</pfd>
<pfd c="0">–140</pfd>
<pfd c="20">–150</pfd>
</by_b>
</by_a>
</pfd_mask>
</satellite_system>
4.3	e.i.r.p. mask for epfd(up)
The header format of the pfd mask is as follows:
<eirp_mask_es mask_id="N" low_freq_mhz="F1" high_freq_mhz="F2" min_elev="E" d_name="separation angle" ES_ID = “–1“>
where (see Table 6):
TABLE 6
Non-GSO ES e.i.r.p. mask header format
There are then arrays of e.i.r.p. values for given off-axis angles, such as:
<eirp d="0">30.0206</eirp>
An example pfd mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<eirp_mask_es mask_id="1" low_freq_mhz="10000" high_freq_mhz="40000" min_elev="0" d_name="separation angle", ES_ID=–1>
<eirp d="0">30.0206</eirp>
<eirp d="1">20.0206</eirp>
<eirp d="2">12.49485</eirp>
<eirp d="3">8.092568</eirp>
<eirp d="4">4.9691</eirp>
<eirp d="5">2.54634976</eirp>
<eirp d="10">–4.9794</eirp>
<eirp d="15">–9.381681</eirp>
<eirp d="20">–12.50515</eirp>
<eirp d="30">–16.90743</eirp>
<eirp d="50">–18.9471149</eirp>
<eirp d="180">–18.9471149</eirp>
</eirp_mask_es>
</satellite_system>
4.4	e.i.r.p. mask for epfd(IS)
The header format of the pfd mask is as follows:
<eirp_mask_ss mask_id="N" low_freq_mhz="F1" high_freq_mhz="F2" d_name="separation angle">
where (see Table 7):
TABLE 7
Non-GSO satellite e.i.r.p. mask header format
There are then arrays of e.i.r.p. values for given off-axis angles, such as:
<eirp d="0">30.0206</eirp>
An example pfd mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<eirp_mask_ss mask_id="2" low_freq_mhz="10000" high_freq_mhz="40000" d_name="separation angle">
<eirp d="0">30.0206</eirp>
<eirp d="1">20.0206</eirp>
<eirp d="2">12.49485</eirp>
<eirp d="3">8.092568</eirp>
<eirp d="4">4.9691</eirp>
<eirp d="5">2.54634976</eirp>
<eirp d="10">–4.9794</eirp>
<eirp d="15">–9.381681</eirp>
<eirp d="20">–12.50515</eirp>
<eirp d="30">–16.90743</eirp>
<eirp d="50">–18.9471149</eirp>
<eirp d="180">–18.9471149</eirp>
</eirp_mask_ss>
</satellite_system>
PART D
Software for the examination of non-GSO filings
1	Introduction
1.1	Scope
The scope of this section is to specify part of a software requirements document (SRD) for a computer program that can be used by the BR to calculate whether a specific non-GSO system proposed by an administration meets epfd limits.
There are three key tasks that the software must complete as identified in Fig. 1:
1)	determination of the runs to execute;
2)	for each run, determination of worst case geometry;
3)	for each run, calculation of epfd statistics and checking compliance with the limits.
1.2	Background
This section assumes that the following approaches are used:
epfd calculation: Each non-GSO satellite has a pfd mask and the pfd for each satellite is used to calculate the aggregate epfd↓ at an earth station of a GSO system. This is repeated for a series of time steps until a distribution of epfd↓ is produced. This distribution can then be compared with the limits to give a go/no go decision.
epfd calculation: The Earth is populated with a distribution of non-GSO earth stations. Each earth station points towards a non-GSO satellite using pointing rules for that constellation, and transmits with a defined e.i.r.p.. From the e.i.r.p. and off-axis gain pattern for each earth station, the epfd↑ at the GSO can be calculated. This is repeated for a series of time steps until a distribution of epfd↑ is produced. This distribution can then be compared with the limits to give a go/no go decision.
epfdis calculation: From the e.i.r.p. and off-axis angle for each space station, the epfdis at the GSO space station can be calculated. This is repeated for a series of time steps a distribution of epfdis is produced. This distribution can then be compared with the limits to give a go/no go decision.
The SRD provides detailed algorithms that would allow it to be implemented in software by any interested parties without reference to any specific development methodology.
1.3	Overview
This section is structured into the following paragraphs:
§ 2:	Determination of runs to execute
§ 3:	Determination of worst case geometry for each run
§ 4:	Calculation of time step size and number of time steps
§ 5:	Calculation of epfd statistics and limit compliance checking
§ 5.1:	Defines the epfd↓ algorithm
§ 5.2:	Defines the epfd↑ algorithm
§ 5.3:	Defines the epfdis algorithm
§ 6:	Defines the core geometry and algorithms used by both epfd calculations including gain patterns
§ 7: 	Specifies the output formats and process to obtain a go/no-go decision.
Note that where square brackets are included as part of a parameter name, this indicates an index into an array, not tentative text.
1.4	General assumptions and limitations
A general limitation on the generation of epfd statistics is:
Bin size:	SB = 0.1 dB
To be consistent with the evaluation algorithm in § D.7.1.3 epfd values calculation for each time step should be rounded to the lower values with a maximum precision of 0.1 dB.
The calculation of angle to GSO arc, and X, as described in § D.6.4.4 are based upon a number of test points, with specified separation between them:
Separation between GSO test points: 1e-5 radians.
1.5	Database and interface
Wherever feasible, input data should be taken from the  or other databases, combined with BR resources such as DLLs to define epfd limits and calculate antenna gains.
2	Determination of runs to execute
2.1	Article 22 runs
For an Article 22 run a key task is to determine which runs to execute given a non-GSO filing and the epfd limits specified in the RR.
For all ES e.i.r.p. masks in non-GSO notice
{
Get frequency range of ES e.i.r.p. mask (fmin, fmax)
From LimitsAPI request all epfd(up) limits in range (fmin, fmax)
For all epfd(up) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Up
Frequency = FrequencyRun
Sat_Beamwidth = From Limits
Sat_GainPattern = From Limits
epfd_Threshold = From Limits
Ref_BW = From Limits
}
}
For all PFD masks in non-GSO notice
{
Get frequency range of pfd mask (fmin, fmax)
From LimitsAPI request all  epfd(down) limits in range (fmin, fmax)
For all epfd(down) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Down
Service =
Frequency = FrequencyRun
ES_DishSize = From Limits
ES_GainPattern = From Limits
epfd_Threshold = From Limits
Ref_BW = From Limits
}
From LimitsAPI request all BSS epfd(down) limits in range (fmin, fmax)
For all epfd(down) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Down
Service = BSS
Frequency = FrequencyRun
ES_DishSize = From Limits
ES_GainPattern = From Limits
epfd_Threshold = From Limits
Ref_BW = From Limits
}
}
For all Satellite EIRP masks in non-GSO notice
{
Get frequency range of satellite EIRP mask (fmin, fmax)
From LimitsAPI request all epfd(is) limits in range (fmin, fmax)
For all epfd(is) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Intersatellite
Frequency = FrequencyRun
Sat_Beamwidth = From Limits
Sat_GainPattern = From Limits
epfd_Threshold = From Limits
Ref_BW = From Limits
}
}
2.2	Article 9.7A
For Article 9.7A runs the criteria and threshold is defined in Appendix 5 of the Radio Regulations and runs are generated as follows:
If the selected earth station meets the criteria in Appendix 5
{
Get the frequency range of the selected ES(fmin, fmax)
Get all non-GSO networks in the  that overlap that frequency range
For each non-GSO network returned
{
For all pfd masks in non-GSO notice
{
Get frequency range of PFD mask Mask(fmin, fmax)
If there is overlap ES(fmin, fmax) with Mask(fmin, fmax)
{
Get RefBW from Appendix 5
Set FrequencyRun = max(ES_fmin, Mask_fmin) + RefBW/2
CreateRun:
Direction = Down
Frequency = FrequencyRun
ES_DishSize = From ES filing
ES_GainPattern = From ES filing
epfd_Threshold = From Appendix 5
Ref_BW = From Appendix 5
}
}
}
}
2.3	Article 9.7B
For Article 9.7B runs the criteria and threshold is defined in Appendix 5 of the Radio Regulations and runs are generated as follows:
For all pfd masks in non-GSO notice
{
Get frequency range of pfd mask Mask(fmin, fmax)
Get all ES in the  that overlap that frequency range
For each ES returned
{
If the earth station meets the criteria in Appendix 5
{
Get the frequency range of the ES(fmin, fmax)
Get RefBW from Appendix 5
Set FrequencyRun = max(ES_fmin, Mask_fmin) + RefBW/2
CreateRun:
Direction = Down
Frequency = FrequencyRun
ES_DishSize = From ES filing
ES_GainPattern = From ES filing
epfd_Threshold = From Appendix 5
Ref_BW = From Appendix 5
}
}
}
}
3	Worst case geometry
3.1	 epfd↓
3.1.1	Inputs
The inputs to the algorithm are as follows:
pfd_mask:	the pfd mask to check
:	the GSO arc avoidance angle of the non-GSO system
h :	the minimum operating height of the non-GSO system
:	the minimum elevation angle of the non-GSO system
i :	the inclination angle of the non-GSO system
ES :	the parameters of the ES including gain pattern.
3.1.2	Algorithm
This section describes the algorithm to determine the Worst Case Geometry () for the epfd(down) direction.
Note that there could be different pfd masks at different frequencies: this process is assumed to be repeated for each valid frequency range.
The  is based upon search in (, φ) as seen by the non-GSO satellite, with particular care taken for the region (–0, +0) including  = 0. This search is repeated at a number of test non-GSO satellite latitudes. In addition, specific checks are made for the highest latitudes for which  = {−0,0, +0} to ensure compatibility with the methodology in Recommendation ITU-R S.1714.
For each test point considered, the algorithm calculates the epfd using the pfd mask and receive antenna gain, and compares that to the threshold for the relevant latitude.
It is likely that multiple test points will result in the same difference between epfd level and threshold. To assess which should be used as the , the angular velocity of the non-GSO satellite as seen by the ES is calculated, and the geometry selected is that:
–	Gives the highest difference between epfd level and threshold to the resolution of the resulting statistics (0.1 dB).
–	If multiple geometries meet point 1, select the one that would result in geometry that gives the lowest angular velocity of the satellite as seen by the ES.
The search algorithm is shown in Fig. 12.
Figure 12
Search (, φ) grid for
The algorithm is described in the following pseudo code:
WCGA_Down:
Set WorstEPFDBin = –9999
Set WorstAngularVelocity = +9999
For all satellites in the order listed in ITU DB
{
Determine PFD mask to use for this satellite
If this PFD mask has not been checked so far then
Call GetWCGA_Down
End if
Next satellite
GetWCGA_Down (PFD_Mask, 0, 0, ES):
StepSize = min(ES.Beamwidth, PFD_Mask_StepSize)/Nhits
If (i = 0)
{
CheckWCG_Down (latitude = 0)
}
Else
{
LatNumSteps = RoundUp(i / StepSize)
For n = 0 to LatNumSteps inclusive
{
latitude = i * n / LatNumSteps
CheckWCG_Down(latitude)
If (n > 0)
{
CheckWCG_Down(-latitude)
}
}
CheckExtremeWCG( = 0 &  = +/2}
CheckExtremeWCG( = 0 &  = -/2}
If (0 > 0)
{
CheckExtremeWCG( = 0 &  = +/2}
CheckExtremeWCG( = 0 &  = –/2}
CheckExtremeWCG( = +0 &  = +/2}
CheckExtremeWCG( = +0 &  = -/2}
}
}
CheckWCG_Down(latitude):
Locate non-GSO satellite at latitude
Calculate φ0 for elevation angle 0 and radius r
CheckCase(latitude,  = 0, φ = 0)
PhiSteps = RoundUp(φ0 / StepSize)
For φ = PhiStepSize to φ0 inclusive in PhiSteps steps
{
ThetaMin = /2
ThetaMax = +3/2
If the PFD mask is symmetric in DeltaLong or Azimuth
ThetaMax = /2
NumThetaSteps = RoundUp(2φ/PhiStepSize)
ThetaStepSize = (ThetaMax-ThetaMin)/NumThetaSteps
For ThetaStep = 0 to NumThetaSteps inclusive
{
= ThetaMin + ThetaStep*ThetaStepSize
CheckCase(latitude, , φ)
}
If can calculate  that corresponds to  = 0
CheckCase(latitude, , φ)
If (0 > 0)
{
If can calculate  that corresponds to  = 0
CheckCase(latitude, , φ)
If can calculate  that corresponds to  = +0
CheckCase(latitude, , φ)
}
If mask is not symmetric then repeat for other hemisphere
}
CheckCase(latitude, , φ):
Convert (, φ) to (az, el)
Create line from non-GSO satellite N in direction (az, el)
Identify point P in which line intersects Earth
At point P calculate (, X, long) angles wrt point N
At point P calculate AngularVelocity using methodology below
Calculate PFD from mask, latitude & (az, el, , X, long)
Calculate Grel()
Calculate EPFDThreshold from latitude of point P
Calculate EPFDMargin = PFD + Grel() - EPFDThreshold
Calculate EPFDbin = EPFDMargin/BinSize
If WorstEPFDBin < EPFDBin
{
WorstEPFDBin = EPFDBin
Worst AngularVelocity = AngularVelocity
Store this (N, P)
}
Else if (WorstEPFDBin = EPFDBin &&
WorstAngularVelocity > AngularVelocity)
{
WorstAngularVelocity = AngularVelocity
Store this (N, P)
}
CheckExtremeWCG(,):
Iterate in true anomaly until find latitude for (, )
Calculate φ0 at latitude
CheckCase(latitude, , φ0)
The algorithm uses the geometry given in the sections below.
3.1.3	Geometry
3.1.3.1	Conversion between (az, el) and (, φ)
The following equations can be used:
cos(φ) = cos(az) cos(el)
sin(el) = sin(θ) sin(φ)
3.1.3.2	Setting satellite at latitude
Key steps in this algorithm are the calculation of the position and velocity vectors of the non-GSO satellite and ES. The latitude can be used to derive the true anomaly, , using:
To derive the position and velocity vectors, the following equations could be used:
In the satellite plane:
where:
P, Q:	unit vectors in the orbit plane with origin the centre of the Earth and P aligned with the orbit’s major axis
a, e, : 	orbital elements.
Also:
p = a(1 – e2)
The non-GSO’s position and velocity vectors can then be converted from the PQW orbit plane based frame to Earth centred vectors using the standard rotation matrix via the (, , i) orbital elements. It can be assumed that second order effects including the J2 factor need not be considered.
The position vector equation can also be used to calculate a latitude from a true anomaly, , and hence by iteration locate the satellite at the required latitude.
3.1.3.3	Calculation of maximum φ in satellite viewpoint
For a given latitude and hence satellite radius, the maximum angle at the satellite from sub-satellite point φ0 can be derived from the elevation angle  using:
3.1.3.4	Calculation of alpha for maximum φ in satellite viewpoint
For a given latitude and hence satellite radius, the maximum angle at the satellite from sub-satellite point φ0 can be derived from the elevation angle  using the equation above. There will then be two extrema points as shown in Fig. 13:
Figure 13
Extrema cases to derive
Then the alpha value at the extrema can be calculated as follows:
–	Convert given (, φ) into (azimuth, elevation)
–	Calculate line from non-GSO satellite in direction (azimuth, elevation)
–	Calculate nearest intersection point P with Earth radius Re
–	At point P calculate  angle of non-GSO satellite.
3.1.3.5	Calculation of angular velocity
The inputs are as follows:
ES position vector:	res
ES position vector:	es
Non-GSO satellite position vector:	rsat
Non-GSO satellite position vector:	sat
From these, it is possible to calculate the apparent velocity and vector from the ES to the satellite:
r = rsat – res
= sat – es
The angle between these two vectors can then be calculated:
The instantaneous angular velocity is then:
The various terms are shown in Fig. 14:
Figure 14
Vectors to calculate non-GSO satellite apparent angular velocity
Note that a low angular velocity will result in higher likelihoods of interference and hence for a given epfd value the  that gives the least apparent angular velocity would be the one to use.
The ES’s velocity vector can be derived from its position vector (x, y, z) as follows:
Where we is the Earth’s angular velocity in radians per second.
3.1.3.6	Find latitude from (, h, )
This section describes how to go from , h,  to non-GSO latitude assuming the satellite is at the highest latitude for which the relevant  line intersects the point where the elevation angle is  and  = /2 as shown in Fig. 15.
Figure 15
Calculation of highest latitude for a given value of
The method depends upon whether  is positive or negative as in the following two sub-sections:
3.1.3.7	Find latitude from (, h, ) with   0
The geometry for this case is shown in Fig. 16:
Figure 16
Highest latitude for   0
Hence the angles can be derived as follows:
Note that this approach is only valid for  +  < /2. In cases where  +   /2, then an error flag should be raised: if necessary use p = q = 0.
3.1.3.8	Find latitude from (, h, ) with  < 0
The geometry for this case is shown in Fig. 17:
Figure 17
Highest latitude for  < 0
Hence the angles can be derived as follows:
Note that this approach is only valid for  +  < /2. In cases where  +   /2, then an error flag should be raised: if necessary use p = q.
3.1.3.9	Find (, φ) from (latitude, , h, )
In this case, the non-GSO satellite is assumed to be at a given latitude (which could be the orbit inclination) and from , h,  it is possible to work out the  angle.
The satellite’s field of view is shown in Fig. 18:
Figure 18
Searching for  that gives the required (, )
The first stage is to calculate φ0 as follows:
From this, the result can be derived using a binary chop algorithm as follows:
FindThetaPhiFromAlpha(lat, , h, ):
Configure Non-GSO satellite at latitude = lat
Phi0 = GetPhiZero(h, ) using equation above
Theta0 = /2
Theta1 = +/2
Alpha0 = GetAlpha(Theta0, Phi0)
Alpha1 = GetAlpha(Theta1, Phi0)
If Alpha0 <  then
{
Return fail with (Theta0, Phi0) as nearest angles
}
Else if Alpha1 >
{
Return fail with (Theta1, Phi0) as nearest angles
}
While (Theta1 – Theta0 < 1e-6)
{
Theta2 = (Theta1 + Theta0)/2
Alpha2 = GetAlpha(Theta2, Phi0)
If (Alpha2 > )
{
Theta1 = Theta2
Alpha1 = Alpha2
}
Else
{
Theta0 = Theta2
Alpha0 = Alpha2
}
}
Return (Theta1, Phi0) and ok
GetAlpha(, φ):
Convert (, φ) to (az, el)
Create line in direction (az, el) from non-GSO satellite
Identify point P where line intersects Earth
At point P calculate
Return
3.2	 epfd↑
3.2.1	Inputs
The inputs to the algorithm are as follows:
ES_eirp :	the non-GSO ES e.i.r.p. mask to check
θadB :	the GSO satellite’s beam half power beamwidth
:	the minimum elevation angle of the GSO system
a,i,e, ,, :	the inclination orbit parameters of the non-GSO system.
3.2.2	Algorithm
The WCGA for the epfd(up) case is as follows
WCGA_UP:
Calculate φ0
From φ0 calculate LatBS
If single EIRP mask for all ES and ES from density
If orbit (e = 0, i > 0)
(lat, long) = {LatBS, 0}
If orbit (e = 0, i = 0)
(lat, long) = {0, LatBS}
If orbit (e > 0) and apogee in northern hemisphere
(lat, long) = {LatBS, 0}
If orbit (e > 0) and apogee in southern hemisphere
(lat, long) = {LatBS, 0}
Else
If ES from density
If (i = 0)
Call WCGA_UP_Equatorial_all
Else
Call WCGA_UP_General
Endif
Else
If non-GSO satellite repeats
Call WCGA_UP_SpecifcES_Repeating
Else
Call WCGA_UP_SpecifcES_NonRepeating
Endif
Endif
Endif
The various cases, their functions and geometries are described in the following sections.
3.2.3	Geometry
3.2.3.1	General
In general, the worst single entry epfd is when the ES is in the main beam of the GSO satellite and is pointing as closely as possible directly at it. The nearest the ES can point towards the GSO defined by the exclusion zone size, hence the worst single entry epfd is:
EPFD = EIRP(0) – 10log10(4πD2)
Where D is the distance from the ES to the GSO satellite.
This gives the worst single entry interference: the aggregate epfd will also depend upon the area covered by the GSO beam, which will depend upon the incident angle.
The GSO system’s geometry relating to the WCGA(up) is shown in Fig. 19:
Figure 19
GSO system geometry for WCGA(up)
Note that for non-GSO systems in circular orbit with global coverage:
–	The area of the surface of the Earth covered by the beam (and hence of the non-GSO satellite constellation’s orbital shell) is furthest away from the sub-satellite point, hence with constant density of ESs there will be more of them at higher latitudes.
–	The probability of a non-GSO satellite being in a defined latitude range increases with latitude.
–	The GSO system will have a minimum elevation angle for operating reasons.
From these constraints, the latitude of the GSO beam’s boresight can be calculated from an assumed minimum elevation angle and beamwidth taken from the epfd limits in Article 22 of the RR.
FIGURE 20
GSO pointing angles for WCGA(IS) geometry
Here the latitude of the ES can be derived as follows:
Then, noting that  > /2:
Hence:
LatBS = π – φBS – ψ
These equations can be used to derive the values in Table 8:
TABLE 8
(up) geometry for constrained scenarios
This approach is appropriate for:
–	Global coverage non-GSO systems in circular orbit with single e.i.r.p. mask.
–	Gobal coverage non-GSO systems in elliptical orbit with apogee in the northern hemisphere with single e.i.r.p. mask.
Simple changes are required to derive the  locations for equatorial systems and non-GSO systems with elliptical orbits with apogee in the southern hemisphere when a single e.i.r.p. mask is used, as shown in Fig. 21:
Figure 21
(up) locations for selected constellation types
Analysis of the (up) suggests that there are three special cases to consider:
1)	Equatorial orbit systems when the e.i.r.p. varies by latitude
2)	Cases where the ESs are at specified locations rather than evenly distributed
3)	General case when the ES e.i.r.p. varies by latitude
These are discussed in the following sections.
Note that the epfd(up) limits in Article 22 are 100% of time to be met, 0% of time permitted to be exceeded and hence the time factor is not important.
3.2.3.2	Range in latitude
When calculating the (up) and also the epfd(up), it is necessary to identify where the ES could be located. While most systems in types A and B have global coverage, non-GSO networks of type C will be limited in the latitude range.
The latitude range can be derived from the satellite’s height, its inclination angle and the minimum operating elevation angle for the ES, as in Fig. 22:
Figure 22
Calculation of maximum latitude for
For elliptical systems, there will be two values, one for the apogee and another for the perigee, and so the inputs would be:
Semi-major axis of orbit (km):	a
Eccentricity of orbit:	e
Minimum elevation angle (radians):
Inclination angle (radians):	i
From these parameters, the following calculations can be undertaken:
ra = a(1 + e)
θa = π – (ψ + φa)
Then:
Latmax = i + θa
Similarly, using:
rp = a(1 – e)
Using the same equations but replacing suffix (a) with (p), the following can be derived:
Latmin = –i – θp
This assumes that for elliptical systems, the apogee is in the northern hemisphere, i.e. that one of the following is true:
e = 0
= 270°
where:
:	argument of perigee.
In the case that:
e > 0
= 90°
Then the following adjustments should be made:
Latmax’ = –Latmin
Latmin’ = –Latmax
In the case that the orbit inclination is zero and eccentricity zero (i.e. for an equatorial circular orbit) then these equations reduce to:
Latmax = θ
Latmin = –θ
3.2.3.3	Equatorial orbits with multiple e.i.r.p. masks
3.2.3.3.1	Introduction
The scenario for non-GSO systems with equatorial orbits and e.i.r.p. masks that vary by latitude is shown in Fig. 23:
Figure 23
Geometry for (up) for non-GSO constellation in equatorial orbit
The geometry means that any non-GSO ES on the equator will always be in-line with some point on the GSO arc and hence would have to use extremely low power or be forced to be inactive by the  exclusion zone angle. As the non-GSO ES latitude increases, the angle to the GSO arc also increases, permitting higher e.i.r.p.s.
The epfd at the GSO satellite will be:
EPFD = EIRP(θ) – 10log10(4πD2)
where  is the off-axis angle at the non-GSO ES towards the GSO satellite.
The approach to take depends upon whether all the e.i.r.p. masks are monotonically decreasing with the off-axis angle. If they are, then it is possible just to consider the case at each edge of the mask: otherwise it becomes necessary to search in latitude.
3.2.3.3.2	e.i.r.p. masks monotonically decreasing
If each of the e.i.r.p. masks are monotonically decreasing with the off-axis angle, then it is solely necessary to check the start and end of the range of latitudes for which the mask is valid.
From the equations in the section on the general case:
θBS = π – φBS – ψBS
where the angles are as shown in Fig. 24.
Figure 24
Angles to GSO beam boresight
Then from the latitude of the non-GSO ES, it is possible to work out the delta longitude between it and the GSO satellite using:
cos θBS = cos latES cos ∆longES
So that:
Hence the position vectors of each can be derived as:
It is possible to calculate the azimuth of the non-GSO ES as seen by the GSO satellite using:
From this, noting that the non-GSO satellite is by definition on the equator with zero latitude, the delta longitude between the GSO satellite and the point on the non-GSO orbit that minimizes the off-axis angle at the non-GSO ES can be derived using:
With angle notation the same as for the GSO boresight calculation above.
Hence:
From the non-GSO ES there are then two vectors:
r1 = rGSO – rES
r2 = rNGSO – rES
It is then possible to calculate the off-axis angle at the non-GSO ES as the angle between these two vectors and the distance to the GSO the size of vector r1.
The angle to use in the epfd calculation is the maximum of this and the exclusion zone size:
x = max(0, Angle(r1, r2))
Hence the epfd is:
EPFD = EIRP(x) – 10log10(4πr12)
The  is the location of the ES with the highest single entry epfd.
Hence:
WCGA_UP_Equatorial_Masks:
For all EIRP masks
Call WCGA_Up_Equatorial(max(LatMax, Mask start latitude))
Call WCGA_Up_Equatorial(min(+LatMax, Mask end latitude))
Next mask
3.2.3.3.3	e.i.r.p. masks not monotonically decreasing
If the non-GSO e.i.r.p. mask is not monotonically decreasing, then it becomes necessary to check additional latitudes. The latitude range is determined by the range of visibility in latitude of the non-GSO satellite constellation, calculated using the equations above.
The algorithm requires a step size, which should be the minimum of 1º and the smallest step size in the e.i.r.p. masks.
It is assumed that the e.i.r.p. mask is symmetric in latitude.
There is then an outer loop:
WCGA_UP_Equatorial_all:
LatStepSize = min(1, StepSizeinEIRPMask)
Calculate LatMax from non-GSO orbit parameters
For latitude = 0 to LatMax
Get EIRP mask for this latitude
WCGA_Up_Equatorial(latitude)
Next latitude
The WCGA_Up_Equatorial(latitude) is the same as for the case above with monotonically increasing e.i.r.p. masks, namely:
WCGA_Up_Equatorial(latitude):
Calculate the GSO satellite’s φBS
For this latitude, calculate the longitude
Calculate the ES and GSO satellite vectors
Calculate the longitude of the non-GSO satellite
Calculate the non-GSO satellite vector
Calculate offaxis angle at ES
Calculate EPFD
If this is the highest EPFD so far then store it
3.2.3.4	Specific ES locations
Some non-GSO networks are proposing to only use a specific set of ES locations and will not have a general wide spread deployed assumed in the existing WCGA(up). The algorithm to use will depend upon whether the constellation repeats or not: if the constellation repeats then the geometric permutations will be significantly reduced.
3.2.3.4.1	Specific ES repeating orbit
If there are specific ES locations and the non-GSO satellite network using a repeating track orbit then there will be a highly limited number of geometries that are feasible. It is therefore possible to fly the satellite for the repeat period and then, for each ES, for each non-GSO satellite, calculate the . If  ≤ 0, or the elevation angle is below the minimum, then the ES would not transmit, otherwise the epfd towards that location can be derived.
In some cases, the ES would appear to be very close to the rim of the Earth as seen by the GSO satellite. However as noted elsewhere, it is assumed that there are restrictions in the pointing of the GSO satellite beam. It is therefore necessary to adjust the boresight so that it is as close as possible to the non-GSO ES using the geometry in Fig. 25.
Figure 25
(up) adjustment of GSO beam boresight
The inputs are the non-GSO ES location (latitude, longitude) and the longitude on the GSO arc corresponding to the α towards the non-GSO satellite.
Then:
Calculate the two position vectors given in the equations above
Calculate the (azimuth, elevation) of the ES as seen by the GSO
Calculate the (, φ) of the ES as seen by the GSO
Derive the adjusted point (, φ0) of the boresight
Calculate ∆φ = φ – φ0
Calculate the (azimuth, elevation) of the boresight
Create a line from the GSO satellite in this direction
Calculate the intersection point = BS location
Hence the algorithm is:
WCGA_UP_SpecifcES_Repeating:
Set WorstEPFD = –999
For each ES
Get the EIRP mask for this ES
Get the beamwidth for this EIRP mask
Use the beamwidth to calculate the time step = t_step
Get t_repeat = the repeat period of the constellation
For t = 0 to t_repeat with step size t_step
Update the position vector of this ES
For all non-GSO satellites
Update the position vector of this satellite
If this satellite is visible to the ES
Calculate α for this satellite, ES
Calculate elevation angle ε for this satellite
If α  α0 and ε > ε0 then
Calculate d = distance ES to α point on GSO arc
Calculate GSO boresight position and φ
Calculate EPFD = EIRP(α) + Grel(φ)
–10log10(4πd2)
If EPFD > WorstEPFD then
WorstEPFD = EPFD
Store this GSO(long, boresight) geometry
Endif
Endif
Endif
Next satellite
Next time step
Next ES
3.2.3.4.2	Specific ES non-repeating orbit
If there are specific ES and the non-GSO constellation drifts, it will eventually be in every possible configuration, and eventually there will be the case where the non-GSO satellite and ES have the same longitude and the non-GSO satellite is just at the edge of the exclusion zone, as in Fig. 26:
Figure 26
Distance from non-GSO ES to GSO satellite
The distance can be calculated using:
The ES could be located above the maximum boresight location for the GSO satellite. This can be checked by calculating φ using:
If  φES > φ0 then ∆φ = φES – φ0 else ∆φ = 0.
At this point:
EPFD = EIRP() + Grel(∆φ) – 10log10(4πd2)
It is therefore possible to iterate over all non-GSO ES and for each latitude and e.i.r.p. mask derive a single entry epfd. The ES which has the highest single entry epfd can then be selected.
The GSO satellite is then at the same longitude as the ES and with boresight at the minimum of the ES latitude and value calculated from the elevation angle and beamwidth.
3.2.3.5	General case
This case is for when the e.i.r.p. mask varies by latitude and the non-GSO satellite system provides global coverage to ES given via a density rather than specific locations.
In this case the non-GSO satellite will cover all locations in the sky as seen by the non-GSO ES and so the epfd will be:
EPFD = EIRP(0) + 10log10(4πd2)
Note that to get epfd values in the same units as given in the RR, the distance should be in metres rather than km.
This epfd will decrease as the path loss increases towards the edge of coverage. However the aggregation effect of increasing area as the beam points away from the sub-satellite point is more significant. Hence the worst case will be at the limit identified previously:
Figure 27
WCGA(up) GSO beam location
Therefore the WCGA in the case where the e.i.r.p. mask varies by latitude is to look at the e.i.r.p. masks to determine which has the highest e.i.r.p.(0). When there is a range of latitudes with the same value, the highest should be taken.
Then from the θBS and latitude, the difference in longitude can be calculated using:
cos θBS = cos latBS cos ∆longBS
The GSO longitude should be selected such that the first satellite of the non-GSO constellation goes through the centre of this beam during its first orbit. The first step is the two test position vectors:
It is then possible to create a line:
where:
p = rGSO
The non-GSO satellite should be somewhere along that line during its first orbit in the simulation.
For circular orbits the radius is constant and so the point at which the non-GSO satellite crosses this line can be calculated by finding the first positive solution of the following quadratic equation in :
From the position vector of the non-GSO satellite its (latitude, longitude) can be calculated.
Note that the calculations above were based upon a reference GSO satellite with longitude zero and hence this is not the actual longitude but rather difference in longitude required between the GSO satellite and the non-GSO satellite when it reaches the required latitude.
The moment that that satellite reaches this latitude can be derived from:
From , the actual longitude of the non-GSO satellite can be calculated when it reaches the required longitude, and the actual longitude of the GSO satellite derived as:
longGSO = longNGSO – ∆longitude
For elliptical systems, this could require iteration in . One approach is as follows:
SetSatelliteElliptical:
Set LatIn1 = 0.00001
Set LatIn2 = LatBS
LatOut1 = CalcLatOut(LatIn1)
LatOut2 = CalcLatOut(LatIn2)
While (abs(LatIn1 – LatIn2) > 1e-6)
LatIn3 = (LatIn1 + LatIn2)/2
LatOut3 = CalcLatOut(LatIn3)
if (dLatIn3 > dLatOut3)
{
dLatIn2 = dLatIn3
dLatOut2 = dLatOut3
}
else
{
dLatIn1 = dLatIn3
dLatOut1 = dLatOut3
}
Wend
CalcLatOut(LatIn):
From LatIn calculate non-GSO (w + v) and hence v
Hence calculate r_ngso = p/(1 + e*cos(nu))
Solve line for point P where r = r_non
Calculate latitude of point P
Return latitude calculated
Hence:
WCGA_UP_General:
Set WorstEIRP = -999
Set MaxLat = 0
Calculate φ0
For each EIRP mask
Calculate ThisEIRP = max(EIRP( > α0), EIRP(α0))
If ThisEIRP > WorstEIRP
Set MaxLat = the largest absolute latitude for this mask
WorstEIRP = ThisEIRP
Endif
Next mask
From MaxLat and φ0 calculate the longitude
Calculate when first non-GSO satellite would be inline
Hence set
3.3	 epfdIS
3.3.1	Inputs
The inputs to the algorithm are as follows:
SS_eirp :	the satellite e.i.r.p. mask to check
θadB :	the GSO satellite’s beam half power beamwidth
:	the minimum elevation angle of the GSO system
a,i,e, ,, :	the inclination orbit parameters of the non-GSO system.
3.3.2	Algorithm
WCGA_IS:
From the EPFD limits get the gain pattern to use
From the EPFD limits get the GSO beamwidth θadB
From  θadB calculate φ1, φ2
Using the gain pattern calculate Grel(φi) for i = 1,2
From φ1 calculate LatBS
If for all satellites i = 0 then
{
Worst Case Geometry:
BS.Latitude = 0
BS.Longitude = LatBS
GSO.Longitude = 0
}
Else
{
Set WorstEPFDBin = -9999
Set WorstAngularVelocity = +9999
For all satellites in the order listed in ITU DB
{
Determine EIRP mask to use for this satellite
If this EIRP mask has not been checked so far then
Call GetWCGA_IS(EIRP_mask, i)
End if
Next satellite
Rotate GSO, BS in longitude to ensure inline event
}
GetWCGA_IS(EIRP_Mask, i):
LatStep = i / RoundUp(i)
For lat=i to +i in LatStep steps
{
Set satellite at latitude to calculate r, v
If satellite is above minimum operating height
{
From r, φi calculate ψi
From φi, ψi calculate Di, θi
Try to calculate ∆longi
In the cases that the geometries are feasible
{
From the GSO gain pattern calculate Grel(φi)
From the EIRP mask calculate EIRP(ψi)
Calculate EPFDi
Calculate rgso, gso
Calculate θ of non-GSO satellite as seen by GSO
If EPFDi is higher than WorstEPFD
{
Store this geometry
WorstAngularVelocity = θ
WorstEPFD = EPFDi
}
Else if EPFDi is the same bin as WorstEPFD
{
If θ is lower than WorstAngularVelocity
{
Store this geometry
WorstAngularVelocity = θ
}
}
}
}
}
3.3.3	Geometry
There are two potentially significant geometries, which is when the non-GSO satellite just becomes visible as seen by the GSO satellite and when it traverses the GSO satellite beam, as shown below:
Figure 28
Two (IS) non-GSO satellite locations
In some cases, the same  location will handle both geometries – e.g. for an equatorial satellite system a beam at the extreme in azimuth will be aligned for both geometries.
From the radius of the non-GSO satellite at each of the positions, it is possible to calculate the off-axis angle at the satellite and hence e.i.r.p.() together with the distance:
Figure 29
Two (IS) calculation of satellite off-axis angle
where:
φ1 = φBS (from above)
Hence:
Where i = {1, 2} noting that  and that
Then:
θi = π – φi – ψi
Hence given a non-GSO satellite with radius distance Rngso,i at the two specified geometries, the two single entry epfd levels can be calculated as:
)
Note that Grel,1 = 0 and Grel,2 = Grel (φ2 – φ1).
By setting the non-GSO satellite at a specified latitude, it is therefore possible to derive the single entry epfd from the radius vector and the two geometries identified above.
In some cases, there will be no in-line geometry – for example for elliptical systems at apogee the line from the non-GSO satellite to the GSO arc will at no point intersect the Earth. This can be checked by calculating the difference in longitude between the non-GSO satellite and the point on the GSO arc from the geometry above and the non-GSO satellite’s latitude using:
If there is no solution to this equation, then there is no position that meets the required geometry. Other positions could be excluded if the non-GSO satellite was below the minimum operating height.
Given multiple locations with the same single entry epfd, then the one to use would be the one with the lowest angular velocity, using the same method as for WCGA(down), noting that the velocity vector of the GSO satellite can be derived in the same way as for earth stations, i.e.
The position of the GSO satellite would be chosen such that one of the non-GSO satellites with the e.i.r.p. mask identified traverses the critical geometry during its first orbit, using the same methodology as for the WCGA(up).
Additional geometry for the  for epfd(IS) is described in §§ C.3.1.3 and C.3.2.3 above.
4	Calculation of time step size and number of time steps
4.1	Simulation time increment and accuracy
The simulation time increment is one of the most important parameters for the determination of a distribution function of interference from non-GSO networks on the basis of the simulation model. Its specified value should guarantee absence of cases when high-level short-term interference exceeding an acceptable level is missed and is not considered. Otherwise results of simulation analysis will be inaccurate and sometimes erroneous. The decrease of a simulation time increment allows to increase accuracy of obtained results but at the same time results in increase of total number of simulation time increments and amount of required calculations.
The description of calculation algorithms for simulation time increment in uplink, downlink and intersatellite cases are shown below.
4.2	Description of the procedure for the determination of minimum downlink simulation time increment
The value of simulation time increment should guarantee acquisition and description of the most short-term interference scenarios with the required accuracy. The high-level short-term interference is caused by emission of a non-GSO space station which is in-line situation (a non-GSO satellite passes through the main beam of a GSO earth station antenna). Therefore, the method for determining a simulation time increment tref  is based on ensuring the required number Nhit of pfd↓ estimations during the time interval t when a non-GSO satellite passes through the main beam of a GSO earth station antenna:
(1)
The time required for a non-GSO satellite passing through the main beam of a GSO earth station antenna depends on mutual location of the earth and space stations of the GSO network as well as on orbital parameters of the non-GSO network. The value of t should be computed at the location where the time for a non-GSO satellite to pass through the GSO main beam is smallest. Since this occurs when a GSO earth station is located directly under a GSO space station, pass time t is determined by equations (2) and (3) (see Fig. 30):
(2)
where:
(3)
s:	non-GSO satellite angular velocity of rotation around the Earth at the minimum operational altitude (degrees/s); for multiple orbits, the greatest such s should be selected
e:	Earth rotation angular velocity at the equator (degrees/s)
i:	orbit inclination (degrees)
3dB:	GSO earth station antenna 3 dB beamwidth (degrees)
Re:	Earth radius (km)
h:	orbit altitude (km) (see Note 1)
NOTE 1 – In the case that the constellation has multiple values of h for different sub-constellations or planes, the lowest value should be used. In the case of elliptical orbits the minimum operating height should be used.
Figure 30
Calculation of epfd(down) time step size
The Nhit value defines simulation accuracy. The higher the Nhit value the higher the accuracy of the final results.
Nhit should be set to 16 as derived in § D.4.5. In a case when a non-GSO network satellite constellation consists of satellites with different orbital parameters it is necessary to determine a simulation time increment for each type of the orbits concerned and to define a minimum one.
TABLE 9
Input data
4.3	Description of the procedure for the determination of minimum uplink simulation time increment
High-level short-term uplink interference would be caused by emissions from a non-GSO earth station during an in-line event (when a GSO SS is in the main beam of a non-GSO earth station antenna). The required number Nhit of epfd↑ measurements should be effected within the period of the GSO satellite staying in the main beam of the non-GSO earth station antenna to ensure acquisition and definition of the in-line event. If the non-GSO earth station were directly below the GSO satellite (see Fig. 31) then the value of the minimum simulation time increment could be calculated using equations (1) and (2). In that case a width of the non-GSO earth station antenna main beam should be taken instead of that of the GSO earth station antenna main beam.
Figure 31
Calculation of epfd(up) time step size
TABLE 10
Input data
4.4	Description of the procedure for the determination of minimum inter-satellite simulation time increment
The time step size for epfdis calculations is derived by considering that there should be at least Nhit time steps during which the non-GSO satellite is within the main beam of the GSO satellite. Given that the shortest time step is when the beam at the GSO is pointed as far as possible away from the sub-satellite point, and given the following:
Re:	radius of the Earth
h:	height of non-GSO orbit
Rgeo:	radius of geostationary orbit
3dB:	half power beamwidth of GSO beam.
For eccentric orbit systems, calculate the height when the non-GSO satellite crosses the equator, i.e. when  = –.
Then the time step can be calculated using the following algorithm (see Fig. 32).
Figure 32
Geometric parameters involved in the equations
Calculate:
Then calculate the value:
which can be used in equation (2) to calculate the step size to use.
4.5	Derivation of Nhit
The time step size is selected to ensure there is sufficient resolution of the epfd within the victim’s main beam. The necessary resolution is driven by the bin size of 0.1 dB and from this the number of steps within the main beam can be derived.
Nhit should be selected so that the highest epfd will be detected in the simulation and identified to be within the right bin. This implies a resolution in the calculations of (0.1 dB)/2 = 0.05 dB.
The greatest error would occur when two time steps are located equally spaced on either side of the main beam, as in Fig. 33:
Figure 33
Calculation of Nhits
The spacing between samples will be:
The gain pattern within the main beam can be assumed to be parabolic and hence following:
The slope on this curve is:
Hence we can derive Nhit required for a difference in gain of 0.05 dB as follows:
So:
Therefore for the time step nearest the main beam when:
Then:
This approach can also be used for cross-track sampling, and hence Ntrack = Nhit = 16.
4.6	Total simulation run time
This section describes the calculation of number of time steps for the epfd↓ and epfd↑ algorithms specified in § D.5. The basic approach first considers constellations with repeating and non-repeating ground track separately, where systems that use repeating ground tracks use station keeping to ensure that the satellites follow a single Earth trace. For example there will be minor launch errors and perturbations that would make the orbit drift unless station keeping was used operationally to ensure the track repeats. Administrations therefore must indicate to the BR whether station keeping is used to maintain a single track.
Some constellations have different values for inclination, height, or eccentricity between the planes. In this case, it is assumed that, to maintain coverage, the constellation would be designed so that the separation between planes does not change significantly. For the case of repeating ground tracks, this means that there will be a single repeat period for the constellation. This is the time for all satellites within the constellation to return to the same position relative to the Earth and each, within the constraints of station keeping. For the case of non-repeating ground tracks, there will be a single period for all the orbit planes to process around the equator.
This approach is to be used for constellations with both circular and elliptical orbits with orbit inclination non-zero. For equatorial orbit constellations in which all satellites have the same altitude, then it is sufficient to run for a single repeat period. This can be calculated as follows:
Where ws and we are the rotation angular velocities of the satellite and Earth as given in § D.2.
Table 11 shows the input parameters used in all other constellation types.
TABLE 11
Input data
In both cases the time step can be calculated using the method described above. The number of time steps should be at least:
Nmin  	NS  /(100 – (maximum % in the Tables of Article 22 of the RR less than 100%))
So for example for the 99.999% case the number of steps would be:
Nmin    1 000 000
4.6.1	Repeating orbits
For those orbits specified as being repeating, the orbit predictor has to be accurate to ensure repeatability. Thus, there is an option for administrations to specify the exact longitude precession rate with respect to a point mass orbit predictor that ensures the orbit would repeat. The definition and use of this parameter is described in § D.6.3.
With this parameter, a simulated orbit would be repeated but in reality there would be a slight drift due to longitudinal station keeping errors. It is expected that station keeping changes within the orbit plane would make no difference and so are not included.
The result should be as shown in Fig. 34:
Figure 34
Track of repeating orbit non-GSO satellite through GSO ES beam
In Fig. 34, it can be seen that the result would be a series of samples within the main beam of the GSO earth station that is sufficiently fine to resolve the main beam, includes station keeping drift and produces sufficient samples to generate the required statistics.
TABLE 12
Input data
Given the following parameters:
Nmin:	minimum number of time steps required for statistical significance
Prepeat:	time period that the constellation repeats (s)
Tstep:	time step (s)
Ntracks:	number of tracks through the main beam, = 16, as specified in § D.4.5.
For this case the time step should not exactly divide the constellation repeat period. If:
Nrepsteps    Prepeat/Tstep
is an integer, then calculate a revised time step equal to:
Calculate the time period required to get the minimum number of time steps for statistical significance:
Tsig    Nmin · Tstep
This corresponds to the following number of constellation repeats:
Nrep  round (Tsig/Prepeat) to nearest integer above.
The number of repeats of the constellation is the largest of Nrep or Ntracks i.e.
Nrun    max (Nrep, Ntracks)
Then the total run time is:
Trun  =  Nrun · Prepeat
So the number of time steps is then:
Nsteps  round (Trun/Tstep) to nearest integer below.
4.6.2	Non-repeating orbits
In this case the longitudinal spacing between successive ascending node passes must be examined so that there are sufficient tracks within the main beam. The time step size and number of time steps can be used to determine how far a particular orbit will have processed within the run. The same numbers can be used to determine how many time steps are required for the orbit to drift around the equator. The orbit period can then be used to work out the difference between tracks.
The constant that specifies the required number of points within the main beam can be used to specify the number of tracks though the main beam required (i.e. Ntrack  Nhits). If the gap between tracks is too large or too fine (resulting in either insufficient samples or excessive run times respectively) then artificial precession can be used.
It is expected that station keeping drift should cancel out in the long term and so would not be required for these calculations.
The result should be as shown in Fig. 35.
Figure 35
Track of non-repeating orbit non-GSO satellite through GSO ES beam
In Fig. 35, it can be seen that the result would be a series of tracks within the main beam of the GSO earth station that is sufficiently fine to resolve the main beam and produces sufficient samples to generate the required statistics.
TABLE 13
Input data
Two parameters are required:
Spass	longitudinal spacing between successive ascending passes through the equatorial plane
Sreq	required resolution of passes through the equatorial plane based upon GSO earth station beam size.
These are calculated using the following steps:
Step 1:	Using the equations in § D.6.3.2, calculate the
Step 2:	Convert the  into degrees per minute
Step 3:	Calculate the nodal period of the orbit in minutes using:
Step 4:	Calculate the longitudinal spacing between successive ascending passes through the equatorial plane, S, given the Earth’s rotation rate (e  0.250684 degrees/min):
Spass    (e – r) Pn               degrees
The equations above apply to circular orbits. For elliptical orbit systems where the calculations above would be significantly different, the value of Spass should be supplied by the administration.
Step 5:	From the GSO earth station beamwidth and height, Sreq can be calculated using equation (3):
Step 6:	Calculate the number of orbits to fully populate around the equator, taking into account that each plane has ascending and descending nodes:
Step 7:	Round Norbits to next highest integer.
Step 8:	Calculate total angle orbit has rotated round during this time:
Step 9:	Calculate the number of multiples of 360 that this corresponds to, rounding up to nearest integer below:
Step 10:		Calculate the separation between planes that this corresponds to:
Step 11:		To ensure that the orbit drifts with the required precession rate, the following additional artificial precession should be included:
Sartificial  =  Sactual – Spass               degrees/orbit
or:
degrees/s
Step 12:		Part D gives more information on how this parameter is used. The total run time is then the time to process around the equator, namely:
Trun    Tperiod · Norbits
Step 13:		The total number of time steps is then:
Nsteps    Round (Trun / Tstep) to nearest integer below.
4.7	Dual time step option
4.7.1	Dual time step option epfd(down)
In order to improve simulation performance an option to the algorithm is to implement two time steps. A coarse time step would be used except when any non-GSO satellite is near one of the two conditions:
–	exclusion angle  or X = 0
–	exclusion angle  or X = edge of exclusion zone.
Figure 36 shows where to use the finer time step:
Figure 36
Use of fine time step when at edge or centre of exclusion zone
A coarse step size is used for non-critical regions far from the GSO earth station main beam axis and exclusion zone boundaries. This step size is defined as a topocentric angle:
coarse  =  1.5
This coarse step size is used for all antenna beamwidths and all non-GSO systems.
There are two possible fine step regions because of the two possible maximum epfd locations of a non-GSO:
a)	When a non-GSO satellite is near the main beam, the fine step region is defined as a fixed topocentric angle from the axis of the GSO earth station beam (X or   =  0).
–	If D/ > 100, set the edge of the first sidelobe region to r of the GSO earth station pattern:
1  =  r  =  15.85(D/)–0.6
–	If D/  100, set the edge of the first sidelobe region to that defined in the GSO earth station pattern:
1  =  95 /D
The off-bore angle for the fine step region is defined as the greater of 3.5 or 1:
1  =  max (3.5, φ1)
b)	When a non-GSO satellite is near the exclusion zone, the fine step region measured from the boundary of the exclusion zone (X = X0 or  = 0) is defined as:
_2  =  φcoarse
The size of the coarse step needs to be an integer multiple of fine steps for statistical purposes. Since the coarse step size is constant, the ratio of coarse steps to fine steps is dependent only upon the beamwidth of the GSO earth station (3dB). This ratio is defined as:
Ncoarse  =  Floor ((Nhits * φcoarse) / φ3dB)
where floor is a function that truncates the decimal part of the ratio and outputs the integer part of the ratio. This produces a conservative ratio of fine steps to coarse steps to ensure that a coarse step is never larger than the target topocentric size of 1.5°.
4.7.2	Dual time step option epfd(up)
In order to improve simulation performance an option to the algorithm is to implement two time steps. A coarse time step would be used except when any non-GSO satellite is near the edge of the exclusion zone. Note that there is no need to check for the central line representing  = 0 as non-GSO earth station does not transmit to the non-GSO satellite when within the exclusion zone.
Figure 37 shows where to use the finer time step:
Figure 37
Use of fine time step when at edge of exclusion zone
A coarse step size is used for non-critical regions far from the GSO earth station main beam axis and exclusion zone boundaries. This step size is defined as a topocentric angle:
φcoarse = 1.5
This coarse step size is used for all antenna beamwidths and non-GSO systems.
The size of the coarse step needs to be an integer multiple of fine steps for statistical purposes. Since the coarse step size is constant, the ratio of coarse steps to fine steps is dependent only upon the beamwidth of the non-GSO earth station (3dB). This ratio is defined as:
Ncoarse = Floor ((Nhits * φcoarse) / φ3dB)
where floor is a function that truncates the decimal part of the ratio and outputs the integer part of the ratio. This produces a conservative ratio of fine steps to coarse steps to ensure that a coarse step is never larger than the target topocentric size of 1.5°.
5	epfd calculation description
5.1	epfd software description
This section describes the algorithm to calculate the epfd↓ from a non-GSO constellation into a GSO downlink. It is assumed that each non-GSO satellite has a pfd mask. From the pfd for each satellite the aggregate epfd↓ at an earth station of a GSO system is calculated. This is repeated for a series of time steps until a distribution of epfd↓ is produced. This distribution can then be compared with the limits to give a go/no go decision.
Figure 38 shows the geometry with constellation of non-GSO satellites and test GSO satellite transmitting to a GSO earth station.
Figure 38
Example of epfd(down) scenario
5.1.1	Configuration parameters
These run definition parameters are:
5.1.2	Non-GSO system parameters
The following parameters, as specified in § B.3.1 would be used.
For each satellite the following parameters specified in § B.3.2 – Parameters provided by administration of the non-GSO system, would be used, where the definitions of the parameters are specified in § D.6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite. For the pfd mask it indicates that the pfd data is structured in such a way that the pfd[N] entry is a reference that points to a particular sub-set. For example each satellite in the constellation could reference the same pfd(lat, az, el), pfd(lat, X, long), or pfd(lat, , long) table.
5.1.3	Run time step parameters
The following run parameters should be calculated using the algorithm in § D.4:
5.1.4	Algorithms and calculation procedures
The operating non-GSO satellites are those outside the exclusion zone, above their minimum operating elevation angle and transmitting towards (i.e. height above or equal to MIN_OPERATING_HEIGHT) the GSO earth station. The maximum number of operating non-GSO satellites is the maximum number of non-GSO satellites allowed to transmit co-frequency towards the same area on the ground.
To calculate epfd↓ values from one non-GSO system into one GSO system earth station the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required.
Step 1:	Read in parameters for non-GSO system as specified in § D.5.1.2.
Step 2:	Read in GSO parameters as specified in § D.5.1.1.
Step 3:	If required, calculate the maximum epfd GSO location using the algorithm in § D.3.1.
Step 4:	Initialize statistics by zeroing all bins of epfd↓ values.
Step 5:	If required calculate number of time steps and time step size using algorithm in § D.4 and hence calculate end time.
If a dual time step algorithm is included then use Sub-step 5.1, otherwise Ncoarse = 1 all the time.
Sub-step 5.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 6:	If a dual time step algorithm is included then repeat Sub-step 6.1 to Step 22 until end time is reached, otherwise repeat Steps 7 to 22 until end time is reached.
Sub-step 6.1:	If it is the first time step then set Tstep = Tfine.
Sub-step 6.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 6.3:	Otherwise, if any of the  or X angles for the last time step were within _1 of zero or _2 of the exclusion zone angle (0 or X0) then set Tstep = Tfine; otherwise, set Tstep = Tcoarse.
Step 7:	Update position vectors of all earth stations based on coordinate system in § D.6.1.
Step 8:	Update position vectors of all GSO satellites based on coordinate system in § D.6.2.
Step 9:	Update position and velocity vectors of all non-GSO satellites based on coordinate system, orbit prediction model and station keeping algorithm in § D.6.3.
Step 10:		Set epfd↓ = 0.
Step 11:		Select all non-GSO satellites visible to the GSO earth station using the algorithm in § D.6.4.1.
Step 12:		Repeat Steps 13 to 18 for each visible non-GSO satellite.
Step 13:		Calculate the parameters required by the pfd mask, either (lat,  or X, long) or (lat, azimuth, elevation) as required, using the definition of angles in § D.6.4.4 or § D.6.4.5.
Step 14:		Using the pfd mask for the selected non-GSO satellite, calculate pfd(lat,  or X, long) or pfd(lat, azimuth, elevation) at the GSO earth station using the non-GSO satellite pfd mask as specified in § D.5.1.5.
Step 15:		Calculate the off-axis angle  at GSO earth station between line to the GSO satellite and the non-GSO satellite.
Step 16:		Calculate GRX() = Receive gain (dB) at GSO earth station using relevant gain pattern specified in algorithms in § D.6.5.
Step 17:		Calculate epfd↓i for this non-GSO satellite using:
Step 18:		epfd↓i = pfd() + GRX() – Gmax where Gmax is the peak gain of the GSO earth station antenna.
Step 19:		Sort the epfd↓ contributions of the non-GSO satellites.
Step 20:		Repeat Step 21 for the Nco[lat] largest epfd↓ contributions on this list plus those satellites within the exclusion zone, where Nco[lat] is the maximum number of operating non-GSO satellites at the latitude of GSO_ES considered corresponding to the maximum number of satellites allowed to transmit at the same frequency towards the same area on the ground, fulfilling the GSO exclusion zone and minimum elevation angle requirements as defined by for the non-GSO system.
Step 21:		Increment epfd↓ by the epfd↓i value.
Step 22:		Increment epfd↓ statistics by epfd↓ for this time step by (Tstep/Tfine) entries.
Step 23:		Generate the epfd↓ CDF from the epfd↓ PDF using the algorithm in § D.7.1.2.
Step 24:		Compare epfd↓ statistics with limits using the algorithm in § D.7.1.
Step 25:		Output results in format specified in § D.7.3.
5.1.5	pfd mask calculation
The pfd mask is defined as a table of pfd values for various angles and latitudes.
Note that the latitude range should be:
Minimum:	–i
Maximum:	+i
where i is the inclination of the non-GSO satellite’s orbit.
In general, the (azimuth, elevation) or (,or X) angles calculated at each time step will be between two values in the arrays. In this case linear interpolation between pfd values should be used. If the angles are outside the pfd mask, the software calculates pfd from the highest angle in the mask (i.e. at the mask edge).
The mask that is closer in latitude to that of the reference satellite should be used. Part C gives more information about the format and sampling of the pfd mask.
5.1.6	Outputs
The result of the algorithm is two arrays in format:
where PC_[I] is the percentage of time epfd_DOWN_[I] is exceeded.
5.2	epfd↑ software description
This section describes the algorithm to calculate epfd↑ from non-GSO earth stations into a GSO uplink. The locations of the ES can be defined in one of two ways:
1)	It is assumed that the Earth is populated with a uniform distribution of non-GSO earth stations. In this case the ES_ID in the e.i.r.p. mask should be set to –1.
2)	The locations of specific ES are used via a field in the ES e.i.r.p. mask. In this case the density field is not used.
Each earth station points towards a non-GSO satellite using pointing rules for that constellation, and transmits with a defined e.i.r.p. From the e.i.r.p. and off-axis gain pattern for each earth station, the epfd↑ at the GSO can be calculated. This is repeated for a series of time steps (or reference satellite positions, in the analytical method) until a distribution of epfd↑ is produced. This distribution can then be compared with the limits to give a go/no go decision.
Figure 39 shows the geometry with population of non-GSO earth stations transmitting to a constellation of non-GSO satellites, together with a test GSO satellite receiving from a GSO earth station.
Figure 39
Example of epfd(up) scenario
5.2.1	Configuration parameters
This sub-section specifies the parameters required for all epfd↑ calculations defined in the RR. This would be a data-set of N sets of limits that can be shared between runs. The Table could be queried so that the required values can be used depending upon non-GSO system frequency.
For each set of limits the following would be defined as generated by in § D.2.1
5.2.2	Determination of maximum epfd configuration
The maximum epfd location of the GSO satellite and beam centre is defined in § D.3.2.
5.2.3	Calculation of run steps
The time step and number of time steps are calculated using the algorithm in § D.4 which also describes the optional dual time step option.
5.2.4	Inputs
5.2.4.1	Input parameters
This section defines the input parameters for a particular non-GSO system scenario. In this case, input is a generic term that could include files or user input. Information is required for:
–	non-GSO system;
–	GSO system;
–	run configuration.
5.2.4.2	Non-GSO system parameters
The following parameters, as specified in § B.3.1 would be used:
For each satellite the following parameters specified in § B.3.2, would be used, where the definitions of the parameters are specified in § D.6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite.
Each satellite must have an independent set of six orbital parameters for orbit definition and subsequent propagation.
To define the characteristics of non-GSO earth stations, the following parameters, as specified in § B.4.2 would be used:
5.2.4.3	GSO system parameters
The GSO system can be either calculated or use worst-case parameters using the algorithm in § D.3.2 or entered values. The required parameters as specified are:
These parameters are defined in §§ D.6.1 and D.6.2.
5.2.4.4	Run parameters
The following run parameters should be calculated using the algorithm in § D.4:
5.2.5	Production of non-GSO earth station distribution
In the case that the non-GSO ES locations are defined by a distribution, the following method should be used:
Step 1:	Calculate the number of actual operating non-GSO earth stations that the representative earth station will represent using:
NUM_ES = ES_DISTANCE * ES_DISTANCE * ES_DENSITY
Step 2:	Calculate e.i.r.p. to use for each representative non-GSO earth station using:
_e.i.r.p. = ES_e.i.r.p. + 10log10(NUM_ES)
Step 3:	Define the GSO service area as the region enclosed by the contour representing a relative gain of 15 dB.
Step 4:	For every distance ES_DISTANCE in latitude and distance ES_DISTANCE in longitude within the service area defined in Step 3, locate a representative non-GSO earth station with radiating with _e.i.r.p.
The deployment method should be symmetric around the (latitude, longitude) of the GSO satellite’s boresight, as shown in Fig. 40.
Figure 40
Deployment method for non-GSO earth stations
No non-GSO ESs should be deployed below the minimum latitude or above the maximum latitude, where these two extreme values are derived using the methodology above.
The separation in latitude in radians between non-GSO ES can be calculated from the distance using:
The separation in longitude in radians between non-GSO ES can be calculated using:
5.2.6	Algorithms and calculation procedures
To calculate epfd↑ values from one non-GSO system into one GSO system satellite the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required:
Step 1:	Read in parameters for non-GSO system as specified in § D.5.2.4.2.
Step 2:	Read in GSO parameters as specified in § D.5.2.4.3.
Step 3:	If required calculate maximum epfd GSO location using the algorithm in § D.3.2.
Step 4:	If required calculate locations of non-GSO earth stations using the algorithm in § D.5.2.5.
Step 5:	Initialize statistics by zeroing all bins of epfd↑ values.
Step 6:	If required calculate number of time steps and time step size using the algorithm in § D.4 and hence calculate end time.
If a dual time step algorithm is included then use Sub-step 6.1, otherwise Ncoarse  1 all the time.
Sub-step 6.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 7:	Repeat Steps 8 to 24 for all time steps.
If a dual time step algorithm is included then repeat Sub-step 7.1 to Step 22 until end time is reached.
Sub-step 7.1:	If it is the first time step then set Tstep = Tfine.
Sub-step 7.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 7.3:	Otherwise if any of the  angles for the last time step were within coarse of the exclusion zone angle then set the Tstep = Tfine; otherwise, use Tstep = Tcoarse.
Step 8:	Update position vectors of all earth stations using algorithm in § D.6.1.
Step 9:	Update position and velocity vectors of all non-GSO satellites using algorithm in § D.6.3.2.
Step 10:		Update position vectors of GSO satellite using algorithm in § D.6.2.
Step 11:		Set epfd↑ = 0.
Step 12:		Repeat Steps 13 to 23 for all non-GSO earth stations.
Step 13:		Determine if this non-GSO earth station is visible to the GSO satellite using the algorithm in § D.6.4.1.
Step 14:		If the non-GSO earth station is visible to the GSO satellite then do Steps 15 to 23.
Step 15:		Repeat Steps 16 to 23 for the maximum number of non-GSO satellites that can be tracked.
Step 16:		Select the i-th satellite away from the GSO satellite that is above minimum elevation angle and not inside the GSO exclusion zone.
Step 17:		If the algorithm has selected a satellite then do Steps 18 to 23.
Step 18:		Calculate ES_EIRP[lat] (dB(W/BWraf)) of non-GSO earth station at its given latitude in direction of GSO satellite using non-GSO earth station e.i.r.p. mask in § C.3.
_EIRP = ES_EIRP[lat] + 10log10 (NUM_ES)
Step 19:		Calculate GRX = receive relative gain (dB) at GSO satellite using relevant gain pattern specified in the algorithms in § D.6.5.
Step 20:		Calculate D = distance (km) between the non-GSO earth station and the GSO satellite using the algorithm in § D.6.4.1.
Step 21:		Calculate the spreading factor LFS = 10log(4D2) + 60.
Step 22:		Calculate epfd↑i for this non-GSO satellite:
epfd↑i = _EIRP – LFS + GRX – Gmax
Step 23:		Increment epfd↑ by epfd↑i.
Step 24:		Increment epfd↑ statistics by this epfd↑.
If a dual time step algorithm is included then the step below should be used:
Sub-step 24.1:	Increment epfd↑ statistics by the epfd↑ for this time step by Tstep/Tfine entries.
Step 25:		Generate the epfd↑ CDF from the epfd↑ pdf using the algorithm in § D.7.1.2.
Step 26:		Compare epfd↑ statistics with limits using the algorithm in § D.7.1.
Step 27:		Output results in format specified in § D.7.2.
5.2.7	Outputs
The result of the algorithm is two arrays of size NEPFD↑ in format:
where PC_[I] is the percentage of time epfd_UP_[I] is exceeded.
5.3	epfdis software description
This section describes the algorithm to calculate epfdis from non-GSO space stations into a GSO uplink. From the e.i.r.p. and off-axis angle for each space station, the epfdis at the GSO space station can be calculated. This is repeated for a series of time steps (or reference satellite positions, in the analytical method) until a distribution of epfdis is produced. This distribution can then be compared with the limits to give a go/no go decision.
5.3.1	Configuration parameters
This sub-section specifies the parameters required for all epfdis calculations. This would be a data-set of N sets of limits that can be shared between runs. The Table could be queried so that the required values can be used depending upon non-GSO system frequency.
For each set of limits the following would be defined as derived in § D.2.1.
5.3.2	Determination of maximum epfd configuration
The maximum epfd location of GSO satellite and beam centre is defined in § D.3.3
5.3.3	Calculation of run steps
A single time step and number of time steps are calculated using the algorithm in § D.4.
5.3.4	Input parameters
This sub-section defines the input parameters for a particular non-GSO system scenario. In this case, input is a generic term that could include files or user input. Information is required for:
–	non-GSO system;
–	GSO system;
–	run configuration.
5.3.4.1	Non-GSO system parameters
The following parameters, as specified in § B.2.1 would be used:
For each satellite the following parameters specified in § B.2.1 would be used, where the definitions of the parameters are specified in § D.6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite.
Each satellite must have an independent set of six orbital parameters for orbit definition and subsequent propagation.
To define the characteristics of non-GSO space stations, the following parameters, as specified in § B.4.3 would be used:
5.3.4.2	GSO system parameters
The GSO system can either use worst-case parameters using the algorithm in § D.5.2 or entered values. The required parameters are:
These parameters are defined in §§ D.6.1 and D.6.2.
5.3.4.3	Run parameters
The following run parameters should be calculated using the algorithm in § D.4:
5.3.5	Algorithms and calculation procedures
In the calculation of the dual time step for the epfdis computation, Ncoarse = 1.
To calculate epfdis values from one non-GSO system into one GSO system satellite the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required:
Step 1:	Read in parameters for non-GSO system as specified in § D.5.3.4.2.
Step 2:	Read in GSO parameters as specified in § D.5.3.4.3.
Step 3:	If required calculate worst-case GSO location using algorithm in § D.3.3.
Step 4:	Initialize statistics by zeroing all bins of epfdis values.
Step 5:	If required calculate number of time steps and time step size using algorithm in § D.4 and hence calculate end time.
If a dual time step algorithm is included then use Sub-step 5.1, otherwise Ncoarse = 1 all the time.
Sub-step 5.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 6:	Repeat Steps 7 to 19 for all time steps.
If a dual time step algorithm is included then repeat Sub-step 6.1 to Step 17 until end time is reached.
Sub-step 6.1:	If it is the first time step then set Tstep = Tfine.
Sub-step 6.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 6.3:	Otherwise, if any of the α angles for the last time step were within coarse of the exclusion zone angle then set the Tstep = Tfine; otherwise, use Tstep = Tcoarse.
Step 7:	Update position and velocity vectors of all non-GSO satellites using algorithm in § D.6.3.
Step 8:	Update position vectors of GSO satellite using algorithm in § D.6.2.
Step 9:	Set epfdis = 0.
Step 10:	Repeat Steps 10 to 18 for all non-GSO space stations.
Step 11:	Determine if this non-GSO space station is visible to the GSO satellite using the algorithm in § D.6.4.1.
Step 12:	If the non-GSO space station is visible to the GSO satellite then do Steps 13 to 18.
Step 13:	Calculate e.i.r.p. (dB(W/BWrif)) of non-GSO space station in direction of GSO satellite using the e.i.r.p. mask in § C.3 for the non-GSO space station’s latitude.
Step 14:	Calculate GRX = receive relative gain (dB) at GSO satellite using relevant gain pattern specified in algorithms in § D.6.5.
Step 15:	Calculate D = distance (km) between the non-GSO space station and the GSO satellite using the algorithm in § D.6.4.1.
Step 16:	Calculate the spreading factor LFS = 10 log(4 D2) + 60.
Step 17:	Calculate epfdisi for this non-GSO satellite:
epfdisi = e.i.r.p. – LFS + GRX – Gmax
Step 18:	Increment epfdis by epfdisi.
Sub-step 19:	Increment epfdis statistics by this epfdis.
If a dual time step algorithm is included then the step below should be used:
Sub-step 19.1:	Increment epfdis statistics by the epfdis for this time step by Tstep/Tfine entries.
Step 20:	Generate the epfdis CDF from the epfdis pdf using the algorithm in § D.7.1.2.
Step 21:	Compare epfdis statistics with limits using algorithm in § D.7.1.
Step 22:	Output results in format specified in § D.7.2.
5.3.6	Outputs
The result of the algorithm is two arrays in format:
where PC_[I] is percentage of time epfd_IS_[I] is exceeded.
6	Geometry and algorithms
This section describes the geometry that defines the core algorithms used in the software. One aspect is the conversion into a generic cartesian vector-based coordinate system. The precise orientation of the X vector is not specified in this Recommendation to allow alternative implementations by developers. The axis chosen should not impact the results as satellite and Earth coordinates are defined relative to the Earth.
To aid developers examples coordinate systems are used to show how to convert to and from generic vectors.
6.1	Earth coordinates system
Figure 41 shows the reference coordinate system for earth stations.
Figure 41
Definition of latitude
The Earth is defined as a sphere with radius as specified in § A.2.2 = Re. The Earth rotates around an axis, the Z axis, at a rate defined in § A.2.2 = e. Perpendicular to the Z axis, crossing the Earth at the Equator, is the XY plane.
Earth stations are located on this sphere based upon two angles:
Latitude: angle between line from centre of Earth to earth station and XY plane;
Longitude: angle as shown in Fig. 42.
Figure 42
Definition of longitude
Earth stations are assumed to have constant position in time.
The orientation within the XY plane of the X and Y axes is not specified in this Recommendation as all locations are referenced to the Earth rather than one particular inertial frame. This allows different implementations to use different reference points if required without impacting on the results.
One possible implementation is what is described as the geocentric inertial system. For this example case, conversion from geographic coordinates is achieved using:
if y  0	(5)
if y  0	(6)
(7)
If this example coordinate system is used, then the conversion from geographic coordinates into geocentric inertial system coordinates is:
x = Re cos(lat) cos(long)	(8)
y = Re cos(lat) sin(long)	(9)
z = Re sin(lat)	(10)
where:
(x, y, z):	coordinates in the geocentric inertial system
long:	geographic longitude
lat: 	geographic latitude.
In this example geocentric inertial reference system, the equation for motion of a mass point on the Earth’s surface would be as:
(11)
where:
lat:	geographic latitude of the mass point on the Earth’s surface
lon:	geographic longitude of the mass point on the Earth’s surface
t:	time
e:	angular rate of rotation of the Earth.
6.2	GSO satellite coordinate system
The geostationary arc is a circle in the XY plane at a distance of Rgeo from the Earth’s centre where Rgeo is specified in § A.2.2. Individual geostationary satellites have location on this circle defined by a longitude as shown in Fig. 43.
Figure 43
Definition of GSO satellite longitude
Geostationary satellites are assumed to have constant longitude in time. The conversion to and from vectors can use the same algorithms as in the section above by setting the latitude to zero.
6.3	Non-GSO satellite coordinate system
6.3.1	Non-GSO satellite orbit parameters
This section defines the parameters that specify an orbit for non-GSO satellites. Non-GSO satellites move in a plane as shown in Fig. 44.
Figure 44
Orbit plane angles
The plane of the orbit is referenced to the Earth by two angles:
:	longitude of ascending node: This defines where the ascending orbit plane intersects the equatorial plane. As the orbit is fixed in inertial space while the Earth rotates, a time reference for which this angle is valid must be given. In this case it is the start of the simulation.
i:	inclination angle: This is defined as the angle between the plane of the orbit and the equatorial plane.
The orbit and position of the non-GSO satellite within the orbit is then defined by further parameters as shown in Fig. 45.
Figure 45
Definition of non-GSO satellite in-plane angles
The shape of the orbit is defined by:
a = (Ra + Rp)/2	(12)
e = (Ra – Rp) / (Ra + Rp)	(13)
where:
a:	semi-major axis
e:	eccentricity
Ra:	distance from the centre of the Earth to the satellite at apogee
Rp:	distance from the centre of the Earth to the satellite at perigee.
The position of the perigee within the orbit plane is defined by:
:	argument of perigee, angle between the line of the nodes and perigee.
The position of a non-GSO satellite within the plane at a particular time is defined by:
v0:	angle between perigee and specified point on orbit.
For circular orbits,  can be set to zero and v0 assumed to be the same as the argument of latitude defined as:
0  =    +  0	(14)
Other useful terms are:
p  =  a(1 – e2)	(15)
M  =  E  –  e sin E	(16)
(17)
(18)
(19)
where:
p:	focal parameter
E:	eccentric anomaly
M:	mean anomaly
T:	period of orbit
R:	distance from centre of Earth to satellite when satellite is at position .
These can be used by the algorithm to predict the future position of the non-GSO satellite as described in § D.5.
6.3.2	Non-GSO satellite orbit predictor
Given the orbital elements in the section above, standard orbit mechanics can be used to predict the position of the satellite at future times. In addition there are three additional precession factors for the ascending node and argument of perigee as described below.
Line of nodes
(20)
where:
J2 = 	0.001082636
Orbit precession in ascending node longitude.
The rate of ascending node longitude secular drift is defined as:
(21)
It follows from the above that polar orbits have zero precession rate and equatorial ones have a maximum precession rate. With direct satellite motion (i  90°) the ascending node shifts to the west (to  decreasing) and with reverse satellite motion (i  90°) it shifts to the east (to  increasing).
Perigee argument precession.
Perigee argument secular shift rate is defined as:
(22)
Perigee argument precession rate at i = 0 and i = 180 is maximum. For i1 = 63 26' 06'' or i2 = 116° 33' 54'' the precession rate is zero. If i  i1 or i  i2, then the perigee precession is along a satellite motion direction, and if i1  i  i2, then it is in the opposite direction.
Use of precession terms
Perigee argument is defined as:
ω = ω0 + ωrt	(23)
where:
0:	perigee argument at an initial moment
r:	perigee argument precession rate.
A current value of an ascending node longitude is defined as:
Ω = Ω0 + Ωrt	(24)
where:
0:	ascending node longitude at an initial moment
r:	ascending node longitude precession rate.
The conversion to generic cartesian-based vector would depend upon the direction of the X vector. For an example coordinate system and for circular orbits, the satellite motion expression in the geocentric inertial reference system could be defined as:
(25)
A satellite motion in an elliptical orbit is non-uniform; therefore, the Kepler expression and a concept of a mean anomaly would be used in the model to define the real anomaly as a function of time. Since an explicit dependence of the true anomaly on time is unavailable; the numerical methods of solving the below expressions were used for its definition. The expression is:
(26)
6.3.3	Non-GSO satellite orbit station keeping
An important aspect to station keeping is to simulate multiple passes of the non-GSO satellite through an earth station’s main beam with slightly different crossing directions. As changing the position within the plane does not affect this, then the main parameter to vary is the longitude of the ascending node.
The approach proposed is to give range Wdelta in longitude of ascending node. At the start of the simulation all stations in the constellation have this parameter offset by Wdelta. During the simulation this field would increase to 0 (at the run’s mid-point) and then increase to Wdelta.
This is implemented by rotating the station’s position and velocity vectors around the Z axis by the required angle as specified in § D.6.3.4.
6.3.4	Forced orbit precession
The standard orbit prediction algorithm is based upon point Earth mass plus correcting factors for J2 perturbations. There are two cases where this requires to be over-ridden:
a)	where administrations supply a detailed value of the orbit precession rate with respect to a point Earth mass to ensure a repeat ground track;
b)	for non-repeat orbits where an artificial precession rate is used to ensure the required spacing between equatorial passes.
This is achieved by rotating the non-GSO satellite position and velocity vectors around the Z axis by the required angle, using rotation matrix:
(27)
to rotate by angle .
NOTE 1 – The software should check the orbit precession rate supplied under item a) for self-consistency with the other input parameters.
6.3.5	Combining the orbit models
The various options for the orbit model can be combined in three ways as shown Fig. 46:
Figure 46
Flowchart of orbit model options
Note that the equatorial orbit i = 0 constellation is a special case in that there is no station keeping but the ground track of each satellite repeats just after one orbit.
It should therefore be treated as Case (1) but with forced precession set to zero as described in § D.4.
6.3.6	Mapping orbit parameters from  data
The following orbit parameters are given in the  / IFIC database:
Table orbit:
–	Apogee height (km) = ha
–	Perigee height (km) = hp
–	Inclination angle (degrees) = INC
–	Right ascension (degrees) = RA
–	Longitude of ascending node (degrees) =
–	Argument of perigee (degrees) = AP.
Table phase:
–	Phase angle (degrees) = PA.
For most of these fields it is possible to map nearly directly to the orbit parameters required, such as:
i = INC
=
= AP
Note that this algorithm uses the ascending node definition based upon longitude rather than right ascension to ensure the orbit is correctly referenced to earth station longitude.
The last field to define is the true anomaly, , which can be derived from the phase angle. The phase angle is defined in RR Appendix 4 as:
The phase angle is shown in Fig. 47:
Figure 47
Definition of phase angle
The true anomaly can therefore be derived from the phase angle as follows:
6.4	Geometry
6.4.1	Distance between two stations
Given two station’s position vectors in the form (x, y, z), the distance D between them can be calculated using:
6.4.2	Distance to Earth horizon
The distance to the horizon Dh for a station with Earth centred position vector of magnitude R can be calculated as follows:
6.4.3	Satellite visibility check
Two stations, whether earth stations or satellites, are visible if the direct distance between them is less than the sum of the distance to the horizon for each station, using the spherical Earth model described in § D.6.1.
6.4.4	Angle to GSO arc and Longitude
Figure 48 shows the definition of the  angle and X angle.
Figure 48
Definition of  and X angles
The Figure shows a test earth station and non-GSO satellite.
For each test point Pi on the GSO arc, there is a line from the earth station that intersects that point. There is then an angle i between that line and a line from the earth station to the non-GSO satellite.
The  angle is the minimum of all the test points for which the line does not intersect the Earth, i.e.
  =  min  (i)
Similarly for each test point Pi on the GSO arc, there is a line from the non-GSO satellite that intersects that point. There is then an angle Xi between that line and a line from the earth station to the non-GSO satellite.
The X angle is the minimum of all the test points for which the line does not intersect the Earth, i.e.
X  =  min  (Xi)
The sign of  and X is determined by whether the line from the earth station to the non-GSO satellite intersects the XY plane at a distance less than or greater than the GSO radius as follows:
Given:
Earth station position vector:
Non-GSO satellite position vector: 	RNS
Construct line:
where:
This line crosses the XY plane when:
R(z) = 0
i.e. when
Hence:
The sign of , X is then determined by:
If Rz=0 > Rgeo then  is positive
If Rz=0 = Rgeo then  is zero
If Rz=0 < Rgeo then  is negative.
From the test point identified to give the  or X angle, the longitude can be calculated between the non-GSO sub-satellite point and the point on the GSO arc where the  (or X) angle is minimized, as shown in Fig. 49:
Figure 49
Definition of longitude
Hence:
Long = LongAlpha – LongNGSO
The  or X iteration should use test points that meet the requirements in § D.1.4.
6.4.5	Satellite azimuth and elevation
Figure 50 shows the definition of the azimuth and elevation angles used for the non-GSO satellite:
Figure 50
Definition of azimuth and elevation
It should be noted that direction of the cartesian X, Y, Z vectors in this diagram are:
X:	+ve in the East direction from the non-GSO satellite
Y:	towards the centre of the Earth from the non-GSO satellite
Z:	+ve towards the North direction from the non-GSO satellite.
6.5	Gain patterns
This section defines the gain patterns used in the algorithms for earth stations and satellites. Note that all formula include the peak gain, so where relative gain is required the peak gain should be subtracted.
6.5.1	GSO earth station gain patterns
6.5.1.1	 earth station gain pattern
The  earth station gain pattern to use is specified in Recommendation ITU-R S.1428.
6.5.1.2	BSS earth station gain pattern
The BSS earth station gain pattern to use is specified in Recommendation ITU-R BO.1443.
6.5.2	GSO satellite gain pattern
The values of peak gain and half power beamwidth and the antenna reference radiation pattern to use are specified in RR Article 22 based upon Recommendation ITU-R S.672.
In the 11-14 GHz bands, a peak gain of 32.4 dBi, a beamwidth of 4° and a first side-lobe level of 20 dB should be assumed; in the 20-30 GHz bands, a peak gain of 40.7 dBi, a beamwidth of 1.55° and a first side-lobe level of 10 dB should be assumed.
7	Structure and format of results
7.1	Go/No-go decision
7.1.1	Overall description of the decision process
When time simulation is used, the simulation produces a probability distribution function (PDF) of the pfd. The PDF records, for each pfd level, the number of simulation time-steps at which that pfd level occurred divided by the sum of all bins. The PDF shall be converted into a cumulative distribution function (CDF) which records for each pfd level the number of simulation time-steps at which that pfd level was exceeded normalized by the total number of simulation time steps.
When the analytical method is used, a PDF of the pfd is directly determined. This PDF records the probability of occurrence of each pfd level. These probability values correspond to the percentage of time that the pfd level would occur in an infinite time observation interval. This PDF can also be converted into a CDF.
7.1.2	Production of the CDF
The process detailed in § D.5 generated a PDF of the pfd values. This PDF shall be converted into a CDF which records for each pfd level an estimate of the percentage of time during which that pfd level is exceeded.
For each pfd value, the CDF shall be calculated by:
CDFi = 100 (1 – SUM (PDFmin: PDFi))
where:
PDFx:	PDF table entry for a pfd value of X dB, normalized so that the total sum for all PDFx is 1.
7.1.3	Comparison procedure
The next stage is the comparison of the pfd limit values in the RR with those in the probability table.
Step 1:	Perform Steps 2 through 4 for each specification limit i.
Step 2:	Read the pfd value/probability pair (Ji and Pi) from the database.
Step 3:	If the pfd value Ji has a higher precision than SB (currently 0.1 dB) round Ji to a lower value with a maximum precision of 0.1 dB.
Step 4:	From the CDF find Pt, the probability that pfd value Ji was exceeded as obtained by the software.
Step 5:	If Pi  Pt then record Pass: the CDF complies with this specification point. Else record Fail: the CDF does not comply with this specification point.
The final stage is the comparison of the maximum pfd value recorded during the software run with the limit specified for 100% time (if any).
From the CDF, find the maximum pfd value recorded during the software run, Jmax. Compare it with the pfd limit specified for 100% time, J100. If Jmax  J100 then record Pass: the CDF complies with this specification point. If Jmax  J100 then record Fail: the CDF does not comply with this specification point.
7.1.4	Decision process
If a Pass result was recorded for all of the specification limits, then the non-GSO network complies with the specification. If any Fail results were recorded, then the non-GSO network does not comply with the specification.
7.2	Background information to decision
The background information required is:
–	pfd data generated in the software run (including antenna diameter) and reference antenna pattern;
–	table of specification limits for various antenna diameters and reference antenna pattern.
7.3	Format for output
The output format shall be:
–	statement of the result of the test;
–	summary table;
–	CDF table (for information only).
7.3.1	Statement of the result of the compliance test
The overall conclusion of the evaluation (Pass or Fail) as defined in § D.7.1.4 shall be output.
7.3.2	Summary table
The summary table shall show the following data (see Table 14):
TABLE 14
Summary table
7.3.3	Probability table
The output shall include for information the calculated CDF which was used in the decision-making process.
PART E
Testing of the reliability of the software outputs
1	Evaluation of the computation accuracy of the candidate software
These tests could be performed by the software developer, and the results supplied to the BR along with the candidate software.
Software functions to be evaluated:
Orbit projection – Using a set of simplified parameters which result in a defined repeat period, run the software for the required simulation interval and check the actual (satellite vectors) against the predicted values.
Offset angles – Using appropriate sets of earth station and satellite locations, check the actual beam offset angle values against the predicted values. The sets of test data should cover the most complex trigonometrical cases: for example sites around longitude zero and longitude 180°.
Time step and simulation duration – Using appropriate sets of non-GSO network parameters, check the time step and simulation duration values generated by the software against the predicted values. This checking could be done, for example, through a comparison with results obtained with the analytical method.
CDF generation – Using sets of test input files with known CDF results, verify the CDF generation software.
Go/no-go decision process – Using sets of CDF test input files, verify the accuracy of the go/no-go decision process.
Should multiple implementations be available then sensitivity analysis could be used to evaluate them and their output can be compared to ensure consistency.
2	Evaluation of the epfd(↓/↑) statistics obtained by the BR
These are tests which will be performed automatically by the software as part of each run, to confirm that the run did find the worst-case interference events.
epfd value for 100% time – the epfd↓ value for 100% time obtained during the run should be compared with a value calculated from analysis of the non-GSO constellation. The obtained value should be within ±0.X dB of the expected value.
In cases in which the time simulation method is used, a software based on the analytical method described in § D.6 can, if applicable, be used, as an option, to verify the reliability of the obtained statistical results.
3	Verification of the pfd masks
The pfd masks are inputs to the BR validation tool to be provided by the notifying administration to the BR together with the software used for its calculation, the complete software description and parameters. The information required to generate the pfd mask could be made available to interested administrations to be used in case of dispute.
4	Re-testing of the BR software after any modifications or upgrades
A set of tests should be defined for use on any occasions when the BR software or its operating environment has been modified or upgraded. Such tests could include:
a)	some or all of the tests defined in § E.1 for the initial evaluation of the computational accuracy of the candidate software;
b)	repetition of a representative set of evaluations of actual non-GSO filings, and comparison of the results obtained by the original and modified software systems.
PART F
Software implementing this Recommendation
1	Operating system
The software shall run on Microsoft platforms under the Windows XP or higher operating system.
2	Interfaces to existing software and databases
The BR captures all incoming notices related to space services into one central database for alphanumeric data (SNS) and into another database for graphical data (GIMS) such as antenna diagrams and service areas. These databases are used for the publication of the data on , in the Weekly Circular and its Special Sections. They are also used to provide input data to software packages performing RR Appendix 8 and pfd examinations. Graphical Interface for Batch Calculations (GIBC) is used to carry out examination using these different modules. This guarantees that the data published are also the data used in these examinations. The BR considers this important for both the notifying administration and for administrations the services of which may be affected by the new station. For its regulatory and technical examination of satellite networks, the BR has only used so far on a regular basis software developed for GSO networks. However, when software for epfd calculations that works on non-GSO networks becomes available the same principle should apply. This is not only for the convenience of the BR, but to ensure consistency and transparency towards administrations.
3	User manual
The purpose of the user manual is to tell the user how to run different tests to obtain certain results. Given the complexity of these tests, they need to be given in detail.
______________

=== R-REC-S.1503-4-202309-I!!MSW-E.docx ===
Recommendation ITU-R S.1503-4
(09/2023)
S Series: Fixed-satellite service
Functional description to be used in developing software tools for determining conformity of non-geostationary-satellite orbit fixed-satellite service systems or networks with limits contained in Article 22 of the Radio Regulations
Foreword
The role of the Radiocommunication Sector is to ensure the rational, equitable, efficient and economical use of the radio-frequency spectrum by all radiocommunication services, including satellite services, and carry out studies without limit of frequency range on the basis of which Recommendations are adopted.
The regulatory and policy functions of the Radiocommunication Sector are performed by World and Regional Radiocommunication Conferences and Radiocommunication Assemblies supported by Study Groups.
Policy on Intellectual Property Right (IPR)
ITU-R policy on IPR is described in the Common Patent Policy for ITU-T/ITU-R/ISO/IEC referenced in Resolution ITU-R 1. Forms to be used for the submission of patent statements and licensing declarations by patent holders are available from http://www.itu.int/ITU-R/go/patents/en where the Guidelines for Implementation of the Common Patent Policy for ITU-T/ITU-R/ISO/IEC and the ITU-R patent information database can also be found.
Electronic Publication
Geneva, 2023
ITU 2023
All rights reserved. No part of this publication may be reproduced, by any means whatsoever, without written permission of ITU.
RECOMMENDATION  ITU-R  S.1503-4
Functional description to be used in developing software tools for determining conformity of non-geostationary-satellite orbit fixed-satellite service systems or networks with limits contained in Article 22 of the Radio Regulations
(2000-2005-2013-2018-2023)
Scope
This Recommendation provides a functional description of the software for use by the Radiocommunication Bureau of ITU to conduct examination of non-geostationary-satellite orbit (non-GSO) fixed-satellite service (FSS) system notifications for their compliance with the validation limits specified in the Radio Regulations.
Keywords
epfd, non-GSO, methodology
Abbreviations/Glossary
Alpha angle (): 	The minimum angle between the line to the non-GSO satellite and the lines to the GSO arc as seen at the earth station communicating with a geostationary-satellite orbit (GSO).
e.i.r.p. mask: 		Equivalent isotropic radiated power mask used to define the emissions of the non-GSO earth station in the epfd(up) calculation or the emissions of the non-GSO satellite for the epfd(IS) calculation.
epfd: 		Equivalent power flux-density, as defined in Radio Regulations (RR) No. 22.5C.1, of which there are three cases to consider:
epfd(down): emissions from the non-GSO satellite system into a GSO satellite earth station;
epfd(up): emissions from the non-GSO earth station into a GSO satellite;
epfd(IS): inter-satellite emissions from the non-GSO satellite system into a GSO satellite system.
pfd mask: 		power flux-density mask used to define the emissions of the non-GSO satellite in the epfd(down) calculation.
WCG: 		Worst Case Geometry, the location of the GSO earth station and GSO satellite that analysis suggests would cause the highest single entry epfd values for given inputs.
Related ITU Recommendations, Reports
Recommendation ITU-R BO.1443 – Reference BSS earth station antenna patterns for use in interference assessment involving non-GSO satellites in frequency bands covered by RR Appendix 30
Recommendation ITU-R S.672 – Satellite antenna radiation pattern for use as a design objective in the fixed-satellite service employing geostationary satellites
Recommendation ITU-R S.1428 – Reference FSS earth-station radiation patterns for use in interference assessment involving non-GSO satellites in frequency bands between 10.7 GHz and 30 GHz
The ITU Radiocommunication Assembly,
considering
a)	that WRC-2000 adopted, in Article 22 of the Radio Regulations (RR), single-entry limits applicable to non-geostationary satellite orbit (non-GSO) fixed-satellite service (FSS) systems in certain parts of the frequency range 10.7-30 GHz to protect geostationary satellite orbit (GSO) networks operating in the same frequency bands from unacceptable interference;
b)	that these frequency bands are currently used or planned to be used extensively by geostationary-satellite orbit systems (GSO systems);
c)	that during the examination under Nos. 9.35 and 11.31, the Bureau examines non-GSO FSS systems to ensure their compliance with the single-entry epfd limits given in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the RR;
d)	that to perform the regulatory examination referred to in considering c), the Radiocommunication Bureau (BR) requires a software tool that permits the calculation of the power levels produced by such systems, on the basis of the specific characteristics of each non-GSO FSS system submitted to the Bureau for coordination or notification, as appropriate;
e)	that GSO FSS and GSO broadcasting-satellite service (BSS) systems have individual characteristics and that interference assessments will be required for multiple combinations of antenna characteristics, interference levels and probabilities;
f)	that designers of satellite networks (non-GSO FSS, GSO FSS and GSO BSS) require knowledge of the basis on which the BR will make such checks;
g)	that WRC-19 adapted a methodology which assesses the impact of interference from non-GSO systems into GSO networks in the frequency range 37.5-51.4 GHz that utilises epfd statistics as an input;
h)	that such tools may be already developed or under development and may be offered to the BR,
recommends
that the functional description specified in Annex 1 should be used to develop software tools calculating the power levels produced by non-GSO FSS systems and the compliance of these levels with the limits contained in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the RR.
NOTE – The ITU-R agreed to continue working on a further revision of this Recommendation and has prepared a draft Workplan (in relation with this Recommendation) and a Working Document.
Annex 1

Functional description of software for use by the BR in checking 
compliance of non-GSO FSS systems with epfd limits
TABLE OF CONTENTS
Page
Annex 1 – Functional description of software for use by the BR in checking  compliance of non-GSO FSS systems with epfd limits		3
PART A – Fundamental constraints and basic assumptions		5
A1	General		5
A2	Fundamental assumptions		7
A3	Modelling methodology		9
PART B – Input parameters		10
B1	Introduction		10
B2	BR supplied parameters to software		10
B3	Non-GSO system inputs to software		11
B4	pfd/e.i.r.p. masks		15
B5	Validation of input parameters		16
Attachment to Part B		18
PART C – Generation of pfd/e.i.r.p. masks		25
C1	Definition		25
C2	Generation of satellite pfd masks		25
C3	Generation of e.i.r.p. masks		34
C4	pfd and e.i.r.p. mask format		36
PART D – Software for the examination of non-GSO filings		46
D1	Introduction		46
D2	Determination of runs to execute		47
D3	Worst-case geometry		50
D4	Calculation of time step size and number of time steps		81
D5	epfd calculation description		94
D6	Geometry and algorithms		112
D7	Structure and format of results		135
PART E – Testing of the reliability of the software outputs		137
E1	Evaluation of the computation accuracy of the candidate software		137
E2	Evaluation of the epfd(↓/↑) statistics obtained by the BR		138
E3	Verification of the pfd masks		138
E4	Re-testing of the BR software after any modifications or upgrades		138
PART F – Software implementing this Recommendation		138
F1	Operating system		138
F2	Interfaces to existing software and databases		138
F3	User manual		139
PART A
Fundamental constraints and basic assumptions
A1	General
A1.1	Purpose
The software algorithm described in this Annex is designed for its application by the BR to conduct examination of the non-GSO FSS system notifications for their compliance with the limits contained in Tables 22-1A, 22-1B, 22-1C, 22-1D, 22-1E, 22-2 and 22-3 of Article 22 of the RR.
The algorithm could also under certain conditions permit examination of whether coordination is required between non-GSO FSS systems and large earth stations under Articles 9.7A and 9.7B using the criteria in RR Appendix 5.
The algorithm uses the parameters of the non-GSO system to derive statistics of epfd. These epfd statistics could be used as the input to other methodologies that assess interference from non-GSO systems into GSO network(s) in bands where there are no epfd limits in Article 22 of the RR.
The algorithm in this Recommendation was developed based upon a reference GSO satellite in equatorial orbit with zero inclination angle. The analysis to determine whether a non-GSO satellite system meets the epfd limits in Article 22 of the RR is made by calculating the epfd levels at the reference GSO satellite or at an earth station pointing towards it. A GSO satellite network operating with non-zero inclination angles could receive higher epfd levels than those predicted by this algorithm, noting that the analysis under RR Nos 22.5C, 22.5D, 22.5F are conducted assuming zero inclination of the GSO satellite. Analysis under RR Nos. 9.7A and 9.7B, however, is to determine if coordination is required by comparing against the trigger level in Appendix 5 of the RR, and therefore in this case other methodologies, including those that assume non-zero GSO satellite inclination, could be acceptable alternatives.
A1.2	Software block-diagram
The block-diagram of the software algorithm described in this Annex is shown in Fig. 1. It comprises initial data and calculation for the notifying administration and the BR. The data section contains the whole set of parameters relevant to the notified non-GSO system, a set of reference GSO system parameters as well as epfd limits provided by the BR.
The calculation section is designed for estimations required to examine notified non-GSO systems compliance with the epfd limits. The calculation section is based on a concept of a downlink power flux-density (pfd) mask (see Note 1), an uplink effective isotropic radiated power (e.i.r.p.) mask (see Note 2) and inter-satellite e.i.r.p. mask (see Note 3).
NOTE 1 – A pfd mask is a maximum pfd produced by a non-GSO space station and is defined in Part C.
NOTE 2 – An e.i.r.p. mask is a maximum e.i.r.p. radiated by a non-GSO earth station and is a function of latitude and the angle from the boresight of the transmitting antenna main beam to a point on the GSO arc.
NOTE 3 – An inter-satellite e.i.r.p. mask is a maximum e.i.r.p. radiated by a non-GSO space station and is a function of latitude and the angle between the line to the sub-satellite point and a point on the GSO arc.
The pfd/e.i.r.p. masks are calculated by the filing administration as identified in Block 1 and then supplied with the other non-GSO system parameters in Blocks a and b. The BR supplies additional parameters, in particular the epfd limits in Block c.
FIGURE 1
Stages in epfd verification – key logic blocks
A1.3	Allocation of responsibilities between Administrations and the BR for software employment
Taking into account significant complexity regarding specific features of different non-GSO system configurations in the software it would seem appropriate to impose some burden of responsibility relevant to testing for epfd limits on administrations notifying appropriate non-GSO systems. Therefore the examination procedure for meeting epfd limits would consist of two stages. The first stage would include derivation of a mask for pfd/e.i.r.p. produced by interfering non-GSO network stations. The mask would account for all the features of specific non-GSO systems arrangements (such as possible beam pointing and transmit powers). The first stage would be finalized by the delivery of the pfd/e.i.r.p. mask to the BR.
The second stage calculations would be effected at the BR. The second stage would feature the following operations:
–	Identification of the runs required for a non-GSO network taking into account the frequencies for which it has filed and the frequency ranges for which there are epfd limits in RR Article 22 (Block 2).
–	Definition of the maximum epfd geometry of a GSO space station and an earth station of that network (Block 3). It would ensure verification of sharing feasibility for a notified non-GSO network with any GSO network in the FSS and BSS.
–	epfd statistics estimation (Block 4).
–	Making a decision on interference compliance with appropriate epfd limits.
The estimations are based on the non-GSO system parameters (Blocks a and b) delivered by a notifying administration and the initial data (Block c) available at the BR.
Any administration may use software that uses the algorithms defined in this Annex together with data on the non-GSO networks to estimate statistics for interference into its own GSO networks and check for compliance with epfd limits. It would assist in solving probable disputes between the BR and administrations concerned.
The elements of the software block-diagram discussed are presented hereinafter in detail. The Parts are as follows:
Part A	–		Basic limitations and main system requirements for the software as a whole are presented.
Part B	–		Non-GSO networks parameters and initial data for Blocks a and b are discussed.
Part C	–		Definitions and estimation algorithms for pfd/e.i.r.p. masks relative to non-GSO network earth and space stations are presented. Specifics of those masks applying in simulation is also discussed (Block 1).
Part D	–		This Part deals with general requirements on the software related to examination of non-GSO networks notifications, algorithms to estimate epfd statistics, and the format for output data presentation. Part D covers issues of Blocks 2, 3 and 4.
Parts E, F	–	These Parts define requirements on the software related to valuation of delivered software and to verification of the software output on validity.
A2	Fundamental assumptions
A2.1	Units of measurement
To provide for adequate simulation results and to avoid errors a common measurement units system is used in Table 1 for the software description. The list of measurement units for the basic physical parameters is shown in Table 1.
TABLE 1
The system of measurement units for basic physical parameters used
for the software performance description
A2.2	Constants
The functional description of the software for examination of non-GSO networks notification at the BR uses the constants shown in Table 2.
TABLE 2
Constants to be used by software
A2.3	The Earth model
The force of the Earth attraction is the main factor to define a satellite orbital motion. Additional factors include:
–	orbit variations due to the Earth’s oblateness and its mass distribution irregularities;
–	solar and lunar attraction;
–	medium drag for satellite;
–	solar radiation pressure, etc.
The function description of software in this Annex accounts orbit perturbations only due to the Earth oblateness. It is motivated by the fact that effect of other perturbing factors is significantly less. The Earth’s oblateness causes secular and periodic perturbations of ascending node longitude and orbit perigee argument. Section D6.3 describes expressions to account the Earth’s oblateness effect.
The orbits of some repeating ground tracks can be very sensitive to the exact orbit model used. Administrations could also provide the BR with their own independently determined average precession rates that could be used by the software instead of the values calculated using the equation in § D6.3.
A2.4	Constellation types
The algorithm in this Recommendation has been developed to be applicable to at least the non-GSO satellite systems shown in Table 3.
Constellations can contain sub-constellations with different orbit parameters and shape, but all sub-constellation within a constellation have to be either repeating or non-repeating. If the constellation is repeating then the repeat period specified must be appropriate for all non-GSO satellites, including all sub-constellations.
TABLE 3
Orbit type classification
A3	Modelling methodology
The approach described in this Annex involves time simulation in which interference levels are evaluated on a time step by time step basis. Section D4 defines the method to calculate the size of time steps and the total number of time steps to be used. That section also identifies an optional dual time step approach to reduce run times without altering the resulting decision.
PART B
Input parameters
B1	Introduction
B1.1	Background
Certain parameters for a non-GSO network and other data must be specified in order to accomplish the requisite software functions:
–	Function 1: Provide the pfd masks for the non-GSO satellites (downlink) and the e.i.r.p. mask for the earth stations transmitting to those satellites (uplink) or non-GSO satellite (intersatellite).
–	Function 2: Apply the pfd/e.i.r.p. mask in the calculation of downlink epfd↓, uplink epfd↑ and/or intersatellite epfd levels (cumulative time distributions of epfd).
–	Function 3: Determine whether the pfd/e.i.r.p. mask levels are consistent with basic transmission parameters of the non-GSO network, only in the case of dispute.
The roles of the administration of the non-GSO network and the BR are discussed in § A1.3.
Detailed parameters are needed by the BR in support of Function 2 and so this section focuses on the parameters needed to fulfil that requirement.
The parameters provided should be consistent, so that if the administrations modify its network (e.g. if there are changes to the constellation) so that the pfd/e.i.r.p. changes then a new mask would need to be supplied to the BR.
B1.2	Scope and overview
This section identifies inputs to the software in four main sections:
–	Section B2 defines the inputs from the BR;
–	Section B3 defines the inputs from the non-GSO operator excluding the pfd/e.i.r.p. masks;
–	Section B4 defines the pfd/e.i.r.p. masks.
–	An Attachment to Part B then maps the parameters to the SRS database tables.
Note that in the following tables, square brackets in variable names indicate an index for that variable and not tentative text.
B2	BR supplied parameters to software
The BR supplies two types of data, firstly the type of run to execute:
The second data is to provide the threshold epfd levels to use as the pass / fail criteria. These are accessed by the software when generating the runs and consists of a series of records as follows:
B3	Non-GSO system inputs to software
These are split into constellation parameters, orbit parameters for each space station and one or more sets of system operating parameters.
B3.1	Non-GSO constellation parameters
B3.2	Non-GSO space station parameters
For each of the non-GSO satellites, the following parameters to define the location of the constellation at the start of the simulation:
B3.3	Non-GSO system operating parameters
These represent the set of parameters required to define the non-GSO system’s operations. There could be different sets of parameters at different frequency bands, but only one set of operating parameters for any frequency band used by the non-GSO system.
These parameters would be supplied in XML format with header as follows:
<non_gso_operating_parameters es_lat_max="+90" es_lat_min="-90" es_distance="200" es_density="0.00001" c_name="orb_id" b_name="azimuth" a_name="latitude" high_freq_mhz="F2" low_freq_mhz="F1" param_id="1" angle_at_es = "5" min_angle_at_sat = 5>
where:
After the header the XML contains arrays of MIN_EXCLUDE which can vary by orb_id and latitude while the MIN_DURATION, MAX_CO_FREQ values vary only by latitude. The MIN_ELEV array can vary by both latitude and azimuth.
Note that if the non-GSO ES type defined in the e.i.r.p. mask is specific rather than typical, then the fields es_density and es_distance are not used.
The non-GSO operating parameters would be stored in the same database as the pfd and e.i.r.p. masks.
An example non-GSO operating parameters XML file would therefore be:
<?xml version="1.0"?>
<satellite_system sat_name="MySatName" ntc_id="12345678">
<non_gso_operating_parameters es_lat_max="+90" es_lat_min="-90" es_distance="200" es_density="0.00001" c_name="orb_id" b_name="azimuth" a_name="latitude" high_freq_mhz="F2" low_freq_mhz="F1" param_id="1" min_angle_at_sat = "0" min_angle_at es =0>
<min_exclude c="1">
<exclusion_zone_angle a="-75">0</exclusion_zone_angle>
<exclusion_zone_angle a="-45">3</exclusion_zone_angle>
<exclusion_zone_angle a="-15">5</exclusion_zone_angle>
<exclusion_zone_angle a="15">5</exclusion_zone_angle>
<exclusion_zone_angle a="45">3</exclusion_zone_angle>
<exclusion_zone_angle a="75">0</exclusion_zone_angle>
</min_exclude>
<min_exclude oc="2">
<exclusion_zone_angle a="-75">0</exclusion_zone_angle>
<exclusion_zone_angle a="-45">4</exclusion_zone_angle>
<exclusion_zone_angle a="-15">6</exclusion_zone_angle>
<exclusion_zone_angle a="15">6</exclusion_zone_angle>
<exclusion_zone_angle a="45">6</exclusion_zone_angle>
<exclusion_zone_angle a="75">0</exclusion_zone_angle>
</min_exclude>
<max_co_freq a="0">2</max_co_freq>
<min_duration a="-50">400</min_duration>
<min_duration a="0">1000</min_duration>
<min_duration a="50">400</min_duration>
<min_elev a="-30">
<elev_angle b="0">30</elev_angle>
<elev_angle b="90">40</elev_angle>
<elev_angle b="280">30</elev_angle>
<elev_angle b="370">40</elev_angle>
</min_elev>
<min_elev a="0">
<elev_angle b="0">20</elev_angle>
<elev_angle b="90">30</elev_angle>
<elev_angle b="280">20</elev_angle>
<elev_angle b="370">30</elev_angle>
</min_elev>
<min_elev a="30">
<elev_angle b="0">30</elev_angle>
<elev_angle b="90">40</elev_angle>
<elev_angle b="280">30</elev_angle>
<elev_angle b="370">40</elev_angle>
</min_elev>
</non_gso_operating_parameters>
</satellite_system>
B4	pfd/e.i.r.p. masks
B4.1	Non-GSO downlink pfd mask
B4.2	Non-GSO uplink e.i.r.p. mask
B4.3	Non-GSO inter-satellite e.i.r.p. mask
B5	Validation of input parameters
This section describes the minimum met of validation of the input parameters: additional checks could also be undertaken.
B5.1	Non-GSO space station parameters
This methodology is applicable for the types of non-GSO systems with orbital characteristics as defined in Table 3. To ensure consistency with this assumption, the following tests are required to be undertaken for each non-GSO satellite:
Test for circular or near-circular orbit:
If the e > 0 and e < MAX_CIRCULAR_E then
{
WarningMessage: setting orbit to be circular from eccentricity = e
Set e = 0 and continue
}
Test HEO system has  = ±/2:
If the eccentricity >= MAX_CIRCULAR_E then
{
Ensure w in range {−, +}
If (abs(/2 – abs(w))) > MAX_HELO_DELTAW
{
ErrorMessage: orbit apogree not at maximum latitude
Exit
}
It is assumed that:
MAX_CIRCULAR_E = 0.01
MAX_HELO_DELTAW = 1e-5 degrees
With systems that use multiple sub-constellations, it must be checked that all are repeating or all are non-repeating.
B5.2	Non-GSO system operating parameters ranges
The following non-GSO system operating parameters are to be checked:
MIN_EXCLUDE[Latitude]  0
MIN_ELEV[Latitude, Azimuth]  0
MIN_DURATION[Latitude]  1 second
MAX_CO_FREQ[Latitude]  0
ES_DENSITY > 0
ES_DISTANCE  0 (ES_DISTANCE = 0 means that only one earth station can be distributed inside the victim GSO footprint)
+90º > ES_LAT_MIN  −90º
+90º  ES_LAT_MAX > −90º
ES_LAT_MAX > ES_LAT_MIN
MIN_ANGLE_AT_ES  0
MIN_ANGLE_AT_SAT  0
MAX_CO_FREQ_SAT  0
B5.3	Masks and system operating parameters XML files
The following non-GSO system operating parameters are to be checked:
–	That there is only a single non-GSO system operating parameters set per frequency range.
–	That there is a non-GSO system operating parameters set for each frequency range that is to be examined.
–	That if the MIN_EXCLUDE varies by orbit plane, that a value is defined for each orbit plane.
It is also necessary to check that any ES e.i.r.p. masks using the LatitudeAndAngleGSOArc format are monotonically decreasing.
Attachment 
to Part B
This Attachment to Part B details the parameters that the epfd software uses from the SRS database. If the extended set of system operating parameters are provided, then values should be taken from that XML file rather than the relevant SRS table.
Table 4 lists the current RR Appendix 4 information for non-GSO satellite systems included in the BR space networks system (SNS) database. The relationship between the database tables is shown in Fig. 2. Mask information and link tables are not shown in Fig. 2 but are described in Table 4.
Format description
Figure 2
Extract from SRS entity relationship
TABLE 4
SRS data for epfd analysis
Notice
Non-geo
orbit
orbit (continued)
orbit (end)
Phase
Grp
srv_cls
sat_oper
mask_info
e_as_stn
mask_lnk1
mask_lnk2
mask_lnk3
Tables used in the Article 9.7A/9.7B calculations
e_stn
e_ant
PART C
Generation of pfd/e.i.r.p. masks
C1	Definition
The purpose of generating pfd/e.i.r.p. masks is to define an envelope of the power radiated by the non-GSO space stations and the non-GSO earth stations so that the results of calculations encompass what would be radiated regardless of what resource allocation and switching strategy are used at different periods of a non-GSO system life.
These masks are regulatory constraints in that the non-GSO FSS system should not exceed those values at any time and could be derived using the methodology below. They represent an envelope of the power produced by a system which will constrain how rapidly the pfd or e.i.r.p. can change between data points and how low values for the extreme points in arrays can get. Note that it is feasible for a system not to transmit at certain latitudes: in this case a null value of −1000 dBW should be used.
C2	Generation of satellite pfd masks
C2.1	General presentation
The satellite pfd mask is defined by the maximum pfd generated by any space station in the interfering non-GSO system as seen from any point at the surface of the Earth. A four dimensional pfd mask is recommended for use by the BR verification software and is defined following one of the two options:
Option 1: As a function of:
–	the non-GSO satellite;
–	the latitude of the non-GSO sub-satellite point;
–	the separation angle  between this non-GSO space station and the GSO arc, as seen from any point on the surface of the Earth, as defined in § D6.4.4;
–	the difference L in longitude between the non-GSO sub-satellite point and the point on the GSO arc where the  angle is minimised, as defined in § D6.4.4.
Option 2: As a function of:
–	the non-GSO satellite;
–	the latitude of the non-GSO sub-satellite point;
–	the non-GSO satellite azimuth angle, defined in § D6.4.5;
–	the non-GSO satellite elevation angle, defined in § D6.4.5.
Whatever parameters are used to generate the pfd mask, the resulting pfd mask should be converted to one of the format options above.
Because the non-GSO space station can generate simultaneously a given maximum number of beams, it should be taken into account in order to better fit the system design and not be too constraining for non-GSO systems.
The mitigation techniques used by the non-GSO system, such as the GSO arc avoidance, are implemented in the calculation of the pfd mask. The GSO arc avoidance defines a non-operating zone on the ground in the field of view of a non-GSO space station. The location of this non-operating zone on the ground will move as a function of the latitude of the non-GSO sub-satellite point. To get a more accurate model of a non-GSO system, the latitude of the non-GSO sub-satellite point is taken as a parameter to the pfd mask calculation.
C2.2	Mitigation techniques description
The mitigation technique implemented within the non-GSO system should be accurately explained in this section in order to be fully modelled in the calculation of the epfd↓.
With regard to the use of a non-operating zone around the GSO arc, there are at least two different ways of modelling a non-GSO system based on a cell architecture:
–	Cell-wide observance of a non-operating zone: a beam of a non-GSO space station is switched off if the separation angle between this non-GSO space station and the GSO arc, at any point of the non-GSO cell, is less than 0 (GSO arc avoidance angle).
–	Cell-centre observance of a non-operating zone: a beam of a non-GSO space station is switched off when the centre of the cell sees this non-GSO space station at less than 0 from the GSO arc.
Other mitigation techniques may be used by a non-GSO system which are not listed here. Information on these techniques will be provided by the non-GSO administration for the description and verification of the pfd mask.
C2.3	pfd calculation
C2.3.1	pfd calculation
The pfd radiated by a non-GSO space station at any point on the Earth’s surface is the sum of the pfd produced by all illuminating beams in the co-frequency band.
Some non-GSO systems have tracking antennas which point to cells fixed on the Earth’s surface and do not move with the spacecraft. However, since the pfd mask is generated with respect to the non-GSO location, assumptions must be made in the development of the pfd mask. Making the simplifying assumption that the cells move with the spacecraft can lead to inaccurate geographic distributions of epfd levels.
As non-GSO systems use mitigation techniques, there will be no main beam-to-main beam alignment. Therefore, de-polarization effects mean that both co-polarization and cross-polarization contributions must be included as sources of interference.
The implementation of the pfd mask explicitly accounts for both co-polarization and cross-polarization from non-GSO satellites into GSO earth stations for like types of polarization (circular-to-circular or linear-to-linear). Isolation between systems of different types of polarization (circular-to-linear) is not directly covered. A study has shown that the average total interference power over all axial ratios and polarization ellipse orientations is a very small net increase in the received interference power in the BSS antenna of 0.048 dB. The bounds of any cross-polarization contributions, that are very unlikely to be reached, are from –30 dB to 3 dB.
Then:
where:
pfd :	pfd radiated by a non-GSO space station (dB(W/m2)) in the reference bandwidth
i :	index of the beams illuminated in the polarization considered
Nco :	maximum number of beams which can be illuminated simultaneously in the polarization considered
pfd_coi :	pfd produced at the point considered at the Earth’s surface by one beam in the polarization considered (dB(W/m2)) in the reference bandwidth
j :	index of the beams illuminated in the opposite polarization to the polarization considered
Ncross :	maximum number of beams which can be illuminated simultaneously in the opposite polarization to the polarization considered
pfd_crossj :	pfd produced at the point considered at the Earth’s surface by one beam in the opposite polarization to the polarization considered (dB(W/m2)) in the reference bandwidth
and
where:
Pi :	maximum power emitted by the beam i in the reference bandwidth (dB(W/BWref))
BWref :	reference bandwidth (kHz)
Gi :	gain generated by the beam i in the polarization considered at the point considered at the Earth’s surface (dBi)
d : 	distance between the non-GSO space station and the point considered at the Earth’s surface (if the non-GSO satellite antenna gain is in isoflux, d is the altitude of the non-GSO space station) (m)
and
where:
G_crossj :	cross-polarization gain generated by the beam j illuminated in the opposite polarization to the polarization considered, at the point considered at the Earth’s surface (dBi).
It is expected that the parameters used to generate the pfd/e.i.r.p. mask correspond to the performance of the non-GSO satellite over its anticipated lifetime. The pfd levels should be an envelope over all possible traffic and beam combinations and represent the peak pfd in the given direction feasible over the lifetime of the system. Non-GSO satellite systems that employ adaptive antennas in which the beam size and sidelobe can be adjusted should take the combination that would result in the highest pfd expected during the anticipated lifetime in each direction when generating the pfd mask. The pfd for all angles for which the satellite operates will therefore be the highest pfd that would be generated, for example, when there is a traffic hot spot in that direction. This approach is consistent with the algorithm in Part D to calculate the epfd which takes account of frequency re-use constraints within the non-GSO system.
C2.3.2	Satellite antenna gain at the point considered at the Earth’s surface
The objective of this section is to determine the gain in the direction of a point M at the Earth’s surface when the satellite antenna points towards a cell i. The antenna coordinate can be defined by four ways of the coordinate system:
 :	spherical coordinate
v :	u  sin  cos , v  sin  sin 
B :	A   cos , B   sin 
(Az, El) :	sin (El)  sin  sin , tan (Az)  tan  cos 
The antenna gain data can be provided in a number of formats and coordinate systems. As the key input into the epfd calculation is the pfd mask, not the antenna gain pattern used to derive the pfd mask, the format and coordinate system of this antenna gain pattern could be different from those used elsewhere in this document. In particular, it is important to note that the above equations related to the conversion between (θ, ) and (Az, El) are different from those included in § D3.1.3.1 and which are used in the Worst-Case Geometry Algorithm.
As an example, the following calculations are performed in the antenna reference (A, B).
The sampling of the non-GSO antenna pattern should be adapted so that interpolation does not lead to gain level significantly different from real values.
Figure 3 presents the geometry in the antenna plane (A, B), while Fig. 4 presents the geometry between the (θ, ) and (Az, El) angles using the definitions above.
Figure 3
Antenna plane (A, B)
Figure 4
(θ, φ) and (Az, El) geometry, illustrated using a reference frame centred at the satellite
The coordinates of the point M at the Earth’s surface are (a, b) in the antenna plane (A, B), corresponding to (M, M) in the polar reference.
The coordinates of the point C centre of the cell i, are (Ac, Bc) in the antenna plane (A, B), and (c, c) in the spherical reference.
For satellite antenna gain patterns with functional descriptions (i.e. equations), the gain into the point M may be computed directly from the coordinates C(Ac, Bc) and M(a, b). For other patterns, the satellite antenna gains are provided in a grid of (A, B) points, and the point M(a, b) may be located between four points of the grid (A, B).
In general, it is therefore necessary to undertake interpolation between data points. Consider a grid of values P for a range of x values = {x1, x2, …} and y values = {y1, y2,…} as in Fig. 5.
figure 5
Interpolation between data points
The value of parameter P at point (x, y) can be derived by identifying the bounding values and hence:
Then P can be interpolated using:
The sampling of the non-GSO satellite antenna pattern should be adapted so that interpolation does not lead to significant approximation.
The same criteria should be used when sampling the pfd mask.
C2.4	Methodology
The pfd mask is defined by the maximum pfd generated by any space station in the interfering non-GSO system and as a function of the parameters defined either in option 1 or option 2. For the generation of the pfd mask, the cells in the non-GSO satellite footprint are located according to the beam pointing utilized by the non-GSO system. For satellites with steerable antennas, the satellite can point to the same area of the Earth throughout its track through the sky.
These cells are fixed relative to the Earth’s surface. For satellites that have antenna-pointing angles fixed relative to the satellite, the cell pattern is the same relative to the satellite but is moving relative to the Earth.
C2.4.1	Option 1
Option 1 has been described for a pfd mask defined as a function of the separation angle , as an example.
The pfd mask is defined as a function of the separation angle  between this non-GSO space station and the GSO arc, as seen from any point on the surface of the Earth, and the difference L in longitude between the non-GSO sub-satellite point and the GSO satellite.
The angle  is therefore the minimum topocentric angle measured from this particular earth station between the interfering non-GSO space station and any point in the visible GSO arc.
The objective of the mask is to define the maximum possible level of the pfd radiated by the non-GSO space station as a function of the separation angle between the non-GSO space station and the GSO arc at any point on the ground, per interval of L.
At each point of the non-GSO satellite footprint, the pfd value depends on:
–	the configuration of the spot beams which are illuminated by the satellite;
–	the maximum number of co-frequency beams which can be illuminated simultaneously;
–	the maximum number of co-frequency, co-polarization beams which can be illuminated simultaneously;
–	the maximum power available at the satellite repeater.
The proposed methodology for the generation of the pfd mask is explained in the following steps:
Step 1:  At any given time, in the field of view of a non-GSO space station, Ntotal is the maximum number of cells that can be seen with the minimum service elevation angle.
Step 2:  In the field of view of the non-GSO space station, it is possible to draw iso- lines, i.e. the points on the surface of the Earth which share the same value of  (see Figs 6 and 7).
Figure 6
Field of view of a non-GSO space station (Option 1)
Step 3:  Along the iso- line, define intervals of L: difference in longitude between the non-GSO sub-satellite point and the point on the GSO arc where the  angle is minimised.
Step 4:  Per each interval of L, the iso- line can be defined by a set of n points M,k for k  1, 2,...n. To determine the maximum pfd corresponding to a given value of ,it is necessary to calculate the maximum pfd at each of the points M,k for k  1, 2,...n. The maximum pfd at a given M,k is determined by first finding the pfd contributed by each celli toward M,k taking into account the dependency of the sidelobe patterns on the beam tilt angle. The maximum pfd contributions toward M,k are then summed, with the number of contributions constrained by the physical limitations of the space station:
–	Out of the Ntotal cells that can be seen within the coverage area of the space station under a minimum elevation angle for communication, only Nco can be illuminated at the same frequency bandwidth, in one sense of polarization, and Ncross in the other sense of polarization. This characterizes the limitation of the antenna system on the non-GSO space station. To calculate the mask in one polarization, the cells which can be illuminated in the polarization concerned are identified, and the cross-polarization level is considered for other cells.
–	Out of these Nco and Ncross cells, only a given number can be powered simultaneously. This characterizes the limitation of the repeater system of the non-GSO space station.
–	If applicable, the limitations in terms of frequency reuse pattern and polarization reuse pattern also need to be clarified.
–	If applicable, the power allocated to one cell may vary taking into account the elevation angle relative to this cell, for example:
Figure 7
View in 3D of the iso- line
Step 5:  The generation of the pfd mask also needs to take into account accurately the mitigation technique implemented within the non-GSO system.
With regard to the use of a non-operating zone around the GSO arc, there are three different ways of modelling a non-GSO system based on a cell architecture:
–	cell-wide observance of a non-operating zone: a beam is switched off when one point on the Earth sees a non-GSO satellite within 0 of the GSO arc. In this particular case, any beam illuminating a cell which is crossed by an iso- line corresponding to a value   0 is switched off;
–	cell-centre observance of a non-operating zone: a beam is switched off when the centre of the cell sees a non-GSO satellite within 0 of the GSO arc. In this case, any beam illuminating a cell with its centre inside the non-operating zone bounded by the two iso-0 lines is switched off;
Step 6:  The maximum pfd value corresponding to a given value  within an interval of L is:
Step 7:  The location of an iso- line, hence the value of the maximum pfd along this line depends on the latitude of the non-GSO sub-satellite point. Therefore, a set of pfd masks will need to be provided, each corresponding to a given latitude of the sub-satellite point.
Step 8:  A set of pfd masks may be needed (one per non-GSO satellite).
C2.4.2	Option 2
The pfd mask is defined in a grid in azimuth and elevation, per latitude of the non-GSO sub-satellite as shown in Fig. 8.
The objective of the mask is to define the maximum possible level of the pfd radiated by the non-GSO space station in this azimuth elevation grid.
At each point of the non-GSO satellite footprint, the pfd value depends on:
–	the configuration of the spot beams which are illuminated by the satellite;
–	the maximum number of co-frequency beams which can be illuminated simultaneously;
–	the maximum number of co-frequency, co-polarization beams which can be illuminated simultaneously;
–	the maximum power available at the satellite repeater.
Figure 8
Field of view of a non-GSO space station (Option 2)
The proposed methodology for the generation of the pfd mask is explained in the following steps:
Step 1:  At any given time, in the field of view of a non-GSO space station, Ntotal is the maximum number of cells that can be seen with the minimum service elevation angle.
Step 2:  For each point M(Az, El), determine the maximum pfd. The maximum pfd at a given M,k is determined by first finding the pfd contributed by each celli toward MAz, El) taking into account the dependency of the sidelobe patterns on the beam tilt angle. The maximum pfd contributions toward M,k are then summed, with the number of contributions constrained by the physical limitations of the space station:
–	Out of the Ntotal cells that can be seen within the coverage area of the space station under a minimum elevation angle for communication, only Nco cells can be illuminated at the same frequency bandwidth, in one sense of polarization, and Ncross cells in the other sense of polarization. This characterizes the limitation of the antenna system on the non-GSO space station. To calculate the mask in one polarization, the cells which can be illuminated in the polarization concerned are identified, and the cross-polarization level is considered for other cells.
–	Out of these Nco and Ncross cells, only a given number can be powered simultaneously. This characterizes the limitation of the repeater system of the non-GSO space station.
–	If applicable, the limitations in terms of frequency reuse pattern and polarization reuse pattern also need to be clarified.
–	If applicable the power allocated to one cell may vary taking into account the elevation angle relative to this cell, for example.
Step 3:  The generation of the pfd mask also needs to take into account accurately the mitigation technique implemented within the non-GSO system.
With regard to the use of a non-operating zone around the GSO arc, there are three different ways of modelling a non-GSO system based on a cell architecture:
–	cell-wide observance of a non-operating zone: a beam is switched off when one point on the Earth sees a non-GSO satellite within 0 of the GSO arc. In this particular case, any beam illuminating a cell which is crossed by an iso- line corresponding to a value   0 is switched off;
–	cell-centre observance of a non-operating zone: a beam is switched off when the centre of the cell sees a non-GSO satellite within 0 of the GSO arc. In this case, any beam illuminating a cell with its centre inside the non-operating zone bounded by the two iso-0 lines is switched off.
Step 4:  A set of pfd masks may need to be provided as a function of the latitude of the sub-satellite point.
Step 5:  A set of pfd masks may be needed (one per non-GSO satellite).
C3	Generation of e.i.r.p. masks
C3.1	Generation of earth station e.i.r.p. masks
C3.1.1	General presentation
The earth station e.i.r.p. mask is defined by a set of tables of the maximum e.i.r.p. as a function of latitude and one of:
1)	The off-axis angle in the direction of the GSO arc as generated by an earth station. There can be different such e.i.r.p. tables applicable at different latitudes.
2)	The azimuth and elevation of the non-GSO satellite that the earth station is currently pointing at and difference in longitude between the earth station and reference point on the GSO arc. There can be different such e.i.r.p. tables applicable at different latitudes.
The non-GSO earth station is located in a non-GSO cell which is served by a maximum number of non-GSO space stations. The density of non-GSO earth stations which can operate co-frequency simultaneously is also used as an input to the calculation.
C3.1.2	Mitigation techniques description
The mitigation technique implemented within the non-GSO system should be accurately explained in this section in order to be fully modelled in the calculation of the epfd↑ (see § C2.2).
C3.1.3	Earth station antenna pattern
The earth station antenna pattern used needs to be identified to calculate the earth station e.i.r.p. mask.
C3.1.4	Methodology
Step 1:
The earth station gain pattern could be defined as a function of the off-axis angle at the non-GSO earth station between the boresight direction towards the non-GSO space station and a point on the GSO arc, and its e.i.r.p mask could be calculated as follows:
The earth station e.i.r.p. mask at a given latitude is defined by the maximum e.i.r.p. radiated in the reference bandwidth by the earth station as a function of the off-axis angle, and is given by:
where:
ES_e.i.r.p.(Lat, ):	equivalent isotropic radiated power in the reference bandwidth (dB(W/BWref))
Lat:	latitude of ES for that e.i.r.p. mask
:	off-axis angle at the non-GSO earth station between the boresight line towards non-GSO space station and a point on the GSO (e.g. the GSO space station) (degrees)
G(Lat, ):	earth station directional antenna gain (dBi) at given latitude
P(Lat):	maximum power delivered to the antenna, in the reference bandwidth (dB(W/BWraf)) at given latitude
BWraf:	reference bandwidth (kHz).
Alternatively, the gain pattern could be provided in the format ES_e.i.r.p.(Lat, az, el, DeltaLongES) and the corresponding e.i.r.p mask could be calculated as follows:
The earth station e.i.r.p. mask at a given latitude is defined by the maximum e.i.r.p. radiated in the reference bandwidth by the earth station as a function of the azimuth, elevation and delta longitude angles, and is given by:
where:
ES_e.i.r.p.(Lat, az, el, longES) :	equivalent isotropic radiated power in the reference bandwidth (dB(W/BWref))
Lat :	latitude of ES for that e.i.r.p. mask
az :	azimuth component of the antenna pointing direction (degree)
el :	elevation component of the antenna pointing direction (degree)
LongES :	difference in longitude between non-GSO earth station and point on the GSO arc (degree)
G(Lat, az, el, Long) :	earth station directional antenna gain (dBi) at given latitude
P(Lat) :	maximum power delivered to the antenna, in the reference bandwidth (dB(W/BWraf)) at given latitude
BWraf :	reference bandwidth (kHz).
Step 2:  Assuming that the non-GSO cells are uniformly distributed on the Earth’s surface, the simultaneous co-frequency transmit non-GSO earth stations are evenly distributed over the cell. Therefore the interferer can be located at the centre of the cell to perform the simulation.
This exercise would be repeated for all latitudes for which the ES_e.i.r.p. could be different.
C3.2	Generation of space station e.i.r.p. masks
The space station e.i.r.p. mask is defined by the maximum e.i.r.p. generated by a non-GSO space station as a function of the angle seen from the non-GSO space station between the line to the sub-point of the non-GSO space station considered and a point on the GSO arc.
The space station e.i.r.p. mask is defined by the maximum e.i.r.p. radiated in the reference bandwidth by the space station as a function of this angle, and is given by:
where:
NON-GSO_SS_e.i.r.p. :	equivalent isotropic radiated power in the reference bandwidth (dB(W/BWref))
	angle seen from the non-GSO space station between the line to the sub-point of the non-GSO space station considered and a point on the GSO arc (degrees)
G():	space station antenna gain pattern (dBi) corresponding to the aggregation of all beams
P:	maximum power, in the reference bandwidth (dB(W/BWrif))
BWrif:	reference bandwidth (kHz).
C4	pfd and e.i.r.p. mask format
C4.1	General structure of masks
The pfd and e.i.r.p. masks are key inputs to Recommendation ITU-R S.1503 with format:
–	For epfd(down) runs, the pfd mask(s), containing tables of pfd(, long) or of pfd(azimuth, elevation) together with the latitude for which each table is valid.
–	For epfd(up) runs, the non-GSO earth station e.i.r.p. mask(s), each one contains tables of e.i.r.p. () or e.i.r.p. (.az, el, long) together with the latitude for which each table is valid.
–	For epfd(IS) runs, the non-GSO satellite e.i.r.p. masks, each one contains tables of e.i.r.p. () together with the latitude for which each table is valid.
During the simulation, the software will calculate the relevant parameters, such as latitude and off-axis angle or  angle, and then use the mask to calculate a pfd or e.i.r.p. using the following approach:
1)	The array of {Latitude, Table} is searched and the table which has the nearest latitude to the value calculated in the simulation is selected.
2)	Using the selected table, the pfd or e.i.r.p. is then calculated by interpolation using:
a)	pfd: calculated using bi-linear interpolation in either pfd(, long) or pfd(azimuth, elevation);
b)	e.i.r.p.(): calculated using linear interpolation in e.i.r.p. ();
c)	e.i.r.p.(az, el, long): using the methodology in § D5.2.7.
Each table is independent i.e. at different latitudes it can use a different grid resolution and range. The mask does not need to cover the whole range: outside the supplied values the last valid value is assumed to be used.
However, it should be noted that for latitude and {azimuth, elevation, , long} regions where no actual pfd is produced, in order to avoid using nearest latitude table containing operational pfd values it is advisable to provide extremely low pfd values for these ranges to simulate no transmission scenario.
The pfd mask table is not assumed to be symmetric in {azimuth, elevation, , long} and should be given for the full range from positive to negative extremes. In the case that the {azimuth, elevation, , long, off-axis angle} calculated in the simulation is outside the ranges given in the pfd or e.i.r.p. masks, then the last valid value should be used.
For the ES e.i.r.p. masks, there is the option to specify the position by (latitude, longitude) rather than density via a reference to a specific ES in the SRS. Note that it is not permitted to mix types: either all non-GSO ES are to be defined via specific ES or all via the density field.
Each mask has header information giving:
–	Notice ID
–	Satellite name
–	Mask ID
–	Lowest frequency mask is valid in MHz
–	Highest frequency mask is valid in MHz
–	Reference bandwidth of mask in kHz
–	Mask type
–	Parameters of mask.
The reference bandwidth of the mask is required as there are more than one bandwidth in the epfd thresholds in Article 22 of the Radio Regulations. The mask is scaled assuming the pfd or e.i.r.p. has a constant spectral power density, so that the pfd or e.i.r.p. to use in the calculations is:
pfd_Calc = pfd_Mask + 10log10[ Threshold_Bandwidth / refbw_khz]
If no refbw_khz is present in the mask than ref_bw_khz=40 is assumed.
e.i.r.p._Calc = e.i.r.p._Mask + 10log10[ Threshold_Bandwidth / refbw_khz]
The pfd and e.i.r.p. levels can vary by latitude: at least one latitude value (by default, 0 degree) should be given.
Each XML file should contain one mask (pfd or e.i.r.p.).
The masks relationships are shown in Figs 9 to 12.
Figure 9
Structure of pfd mask data for epfd(down)
Figure 10
Structure of off-axis based e.i.r.p. mask data for epfd(up)
Figure 11
Structure of azimuth elevation based e.i.r.p. mask data for epfd(up)
Figure 12
Structure of e.i.r.p. mask data for epfd(IS)
The pfd masks are to be provided to the ITU BR in XML format as:
–	It is both machine readable and human readable
–	Allows both format and type checking
–	Is an international standard for exchange of data.
The XML format is plain text with opening and closing blocks, as in:
<satellite_system>
</satellite_system>
Within each section there are then fields relevant to that block. All angles should be given in degrees.
At the top level the satellite system is identified via its notice ID and name using:
<satellite_system ntc_id="NNNNNNN" sat_name="NAME">
[Header]
[Tables]
</satellite_system>
Within this structure there is the header followed by each of the tables.
The format for each mask is described in more detail in the sections below.
C4.2	pfd mask for epfd(down)
The header format of the pfd mask is as follows:
<pfd_mask mask_id="N" low_freq_mhz="F1" high_freq_mhz="F2" refbw_khz = “BW” type="Type" a_name="latitude" b_name="B" c_name="C">
where (see Table 5):
TABLE 5
pfd mask header format
For each of a, b, c there are then arrays of values, such as:
<by_a a="N">
</by_a>
The values within that open/close structure then all relate to a = N: a similar structure is used for b values.
The innermost group gives the actual pfd value, such as:
<pfd c="0">–140</pfd>
An example pfd mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<pfd_mask mask_id="3" low_freq_mhz="10000" high_freq_mhz="40000" refbw_khz = “40” type="alpha_deltaLongitude" a_name="latitude" b_name="alpha" c_name="deltaLongitude">
<by_a a="0">
<by_b b="–180">
<pfd c="–20">–150</pfd>
<pfd c="0">–140</pfd>
<pfd c="20">–150</pfd>
</by_b>
<by_b b="–8">
<pfd c="–20">–165</pfd>
<pfd c="0">–155</pfd>
<pfd c="20">–165</pfd>
</by_b>
<by_b b="–4">
<pfd c="–20">–170</pfd>
<pfd c="0">–160</pfd>
<pfd c="20">–170</pfd>
</by_b>
<by_b b="0">
<pfd c="–20">–180</pfd>
<pfd c="0">–170</pfd>
<pfd c="20">–180</pfd>
</by_b>
<by_b b="4">
<pfd c="–20">–170</pfd>
<pfd c="0">–160</pfd>
<pfd c="20">–170</pfd>
</by_b>
<by_b b="8">
<pfd c="–20">–165</pfd>
<pfd c="0">–155</pfd>
<pfd c="20">–165</pfd>
</by_b>
<by_b b="180">
<pfd c="–20">–150</pfd>
<pfd c="0">–140</pfd>
<pfd c="20">–150</pfd>
</by_b>
</by_a>
</pfd_mask>
</satellite_system>
The XML format can be used to submit a shorthand form to avoid duplicated data but the table will be completed by interpolation or repeated use of the previous value in an array. The form of the pfd mask used by the epfd calculation algorithm in Part D is a grid at each latitude of pfd(x, y) where (x, y) are the two variables of the mask.
At each latitude there will be an array of x and y values:
xi = {x1, x2, .. xn}
yi = {y1, y2, .. yn}
These arrays can vary between latitudes.
Then for each (xi, yi) there is an associated pfd value and hence there are n × m pfd values in the table, as in the simplified 4 × 4 table below:
The data submitted can be a subset of this, for example:
In this case, the pfd table would be completed by a combination of assumptions. Firstly, if there are edge of table values not specified, to extend the mask by using the nearest defined value and assuming it continues:
pfd(1,1) = pfd(2,1)
pfd(4,1) = pfd(3,1)
pfd(1,4) = pfd(2,4)
pfd(4,4) = pfd(3,4)
Then if there are central table values not specified, to complete using linear interpolation from the surrounding values as follows:
pfd(2,2) = Interpolate{x2, pfd(1,2), pfd(4,2), x1, x4}
pfd(2,3) = Interpolate{x3, pfd(1,2), pfd(4,2), x1, x4}
pfd(3,2) = Interpolate{x2, pfd(1,3), pfd(4,3), x1, x4}
pfd(3,3) = Interpolate{x3, pfd(1,3), pfd(4,3), x1, x4}
This completion of the pfd mask could be undertaken when it is read in or on-the-fly during the calculation of the pfd for a specific geometry.
C4.3	e.i.r.p. mask for epfd(up)
The header format of the e.i.r.p.(up) mask is as follows:
<eirp_mask_es mask_id=“N” low_freq_mhz=“F1” high_freq_mhz=“F2” refbw_khz = “BW” a_name=“latitude” b_name = “offaxis angle” ES_ID = “–1”>
where (see Table 6):
TABLE 6
Non-GSO ES e.i.r.p. mask header format
If the format =“T” then there are then for each relevant latitude arrays of e.i.r.p. values for given off-axis angles, such as:
<eirp b="0">30.0206</eirp>
The e.i.r.p. mask should be monotonically decreasing.
An example e.i.r.p.(up) mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<eirp_mask_es mask_id="1" low_freq_mhz="10000" high_freq_mhz="40000" refbw_khz = “40” format = "T" a_name = "latitude" b_name="offaxis angle", ES_ID=–1>
<by_a a="0">
<eirp b="0">30.0206</eirp>
<eirp b="1">20.0206</eirp>
<eirp b="2">12.49485</eirp>
<eirp b="3">8.092568</eirp>
<eirp b="4">4.9691</eirp>
<eirp b="5">2.54634976</eirp>
<eirp b="10">–4.9794</eirp>
<eirp b="15">–9.381681</eirp>
<eirp b="20">–12.50515</eirp>
<eirp b="30">–16.90743</eirp>
<eirp b="50">–18.9471149</eirp>
<eirp b="180">–18.9471149</eirp>
</by_a>
</eirp_mask_es>
</satellite_system>
If the format = “A” then at each latitude there would be a set of tables for every (azimuth, elevation) pointing angle covered, with each table of e.i.r.p. against the difference in longitude between the ES and the point on the GSO arc.
An example e.i.r.p.(up) mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<eirp_mask_es mask_id="1" low_freq_mhz="10000" high_freq_mhz="40000" refbw_khz = "40" format = "A" a_name = "latitude" c_name="azimuth angle" d_name = "elevation angle" e_name = "DeltaLongES", ES_ID=–1>
<by_a a="0">
<by_c c = “0”>
<by_d d= “0”>
<eirp e="0">30.0206</eirp>
<eirp e="1">20.0206</eirp>
<eirp e="2">12.49485</eirp>
<eirp e="3">8.092568</eirp>
<eirp e="4">4.9691</eirp>
<eirp e="5">2.54634976</eirp>
<eirp e="10">–4.9794</eirp>
<eirp e="15">–9.381681</eirp>
<eirp e="20">–12.50515</eirp>
<eirp e="30">–16.90743</eirp>
<eirp e="50">–18.9471149</eirp>
<eirp e="180">–18.9471149</eirp>
</by_d>
C4.4	e.i.r.p. mask for epfd(IS)
The header format of the e.i.r.p.(IS) mask is as follows:
<eirp_mask_ss mask_id="N" low_freq_mhz="F1" high_freq_mhz="F2" refbw_khz = “BW” a_name= “latitude” b_name="offaxis angle">
where (see Table 7):
TABLE 7
Non-GSO satellite e.i.r.p. mask header format
There are then for each relevant latitude arrays of e.i.r.p. values for given off-axis angles, such as:
<eirp b="0">30.0206</eirp>
The e.i.r.p. mask should be monotonically decreasing.
An example e.i.r.p.(IS) mask would therefore be:
<satellite_system ntc_id="12345678" sat_name="MySatName">
<eirp_mask_ss mask_id="2" low_freq_mhz="10000" high_freq_mhz="40000" refbw_khz = “40” a_name = “latitude” b_name="offaxis angle">
<by_a a="0">
<eirp b="0">30.0206</eirp>
<eirp b="1">20.0206</eirp>
<eirp b="2">12.49485</eirp>
<eirp b="3">8.092568</eirp>
<eirp b="4">4.9691</eirp>
<eirp b="5">2.54634976</eirp>
<eirp b="10">–4.9794</eirp>
<eirp b="15">–9.381681</eirp>
<eirp b="20">–12.50515</eirp>
<eirp b="30">–16.90743</eirp>
<eirp b="50">–18.9471149</eirp>
<eirp b="180">–18.9471149</eirp>
</by_a>
</eirp_mask_ss>
</satellite_system>
PART D
Software for the examination of non-GSO filings
D1	Introduction
D1.1	Scope
The scope of this section is to specify part of a software requirements document (SRD) for a computer program that can be used by the BR to calculate whether a specific non-GSO system proposed by an administration meets epfd limits.
There are three key tasks that the software must complete as identified in Fig. 1:
1)	determination of the runs to execute;
2)	for each run, determination of worst case geometry;
3)	for each run, calculation of epfd statistics and checking compliance with the limits.
D1.2	Background
This section assumes that the following approaches are used:
epfd calculation: Each non-GSO satellite has a pfd mask and the pfd for each satellite is used to calculate the aggregate epfd↓ at an earth station of a GSO system. This is repeated for a series of time steps until a distribution of epfd↓ is produced. This distribution can then be compared with the limits to give a go/no go decision.
epfd calculation: The Earth is populated with a distribution of non-GSO earth stations. Each earth station points towards a non-GSO satellite using pointing rules for that constellation, and transmits with a defined e.i.r.p.. From the e.i.r.p. mask for each earth station, the epfd↑ at the GSO can be calculated. This is repeated for a series of time steps until a distribution of epfd↑ is produced. This distribution can then be compared with the limits to give a go/no go decision.
epfdis calculation: From the e.i.r.p. mask for each space station, the epfdis at the GSO space station can be calculated. This is repeated for a series of time steps a distribution of epfdis is produced. This distribution can then be compared with the limits to give a go/no go decision.
The SRD provides detailed algorithms that would allow it to be implemented in software by any interested parties without reference to any specific development methodology.
D1.3	Overview
This Part D is structured into the following sections:
Section D2:	Determination of runs to execute
Section D3:	Determination of worst case geometry for each run
Section D4:	Calculation of time step size and number of time steps
Section D5:	Calculation of epfd statistics and limit compliance checking
Section D5.1:	Defines the epfd↓ algorithm
Section D5.2:	Defines the epfd↑ algorithm
Section D5.3:	Defines the epfdis algorithm
Section D6:	Defines the core geometry and algorithms used by both epfd calculations including gain patterns
Section D7: 	Specifies the output formats and process to obtain a go/no-go decision.
Note that where square brackets are included as part of a parameter name, this indicates an index into an array, not tentative text.
D1.4	General assumptions and limitations
A general limitation on the generation of epfd statistics is:
Bin size:	SB = 0.1 dB
To be consistent with the evaluation algorithm in § D7.1.3 epfd values calculation for each time step should be rounded to the lower values with a maximum precision of 0.1 dB.
The calculation of angle to GSO arc, , as described in § D6.4.4 should, where feasible, be calculated using the analytic method. If this method is unable to provide a solution, then the iterative approach may be used based upon a number of test points, with specified separation between them:
Separation between GSO test points: 1e-6 radians.
The test points should be a located at integer multiples of 1e-6 radians.
D1.5	Database and interface
Automatic verification analysis should take input data from the SRS or other databases, combined with BR resources such as DLLs to define epfd limits and calculate antenna gains. Custom analysis can request some parameters, such as GSO satellite and ES locations, from the user.
D2	Determination of runs to execute
D2.1	Article 22 runs
For an Article 22 run a key task is to determine which runs to execute given a non-GSO filing and the epfd limits specified in the RR.
In any direction, if there are no masks, whether pfd or e.i.r.p., then it is not necessary to undertake any runs.
It is necessary to look in the SRS grp, freq tables to:
–	Identify the date involved
–	Identify the list of frequencies.
It is also necessary to check the frequencies of the system operating table: if there are different sets of parameters at different frequencies then a run will have to be executed for each unique set of pfd/e.i.r.p. mask, orbit elements and system operating characteristics.
For each {freq_min, freq_max, date} combination is used to call the LimitsAPI. If there are duplicate limits returned, then only the minimum frequency case need be run.
For all unique Satellite {freq_min, freq_max, date} in non-GSO notice
{
From LimitsAPI request all FSS epfd(down) limits for {freq_min, freq_max, date}
For all unique epfd(down) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Down
Service = FSS
Frequency = FrequencyRun
ES_DishSize = From Limits API
ES_GainPattern = From Limits API
epfd_Threshold = From Limits API
Ref_BW = From Limits API
}
From LimitsAPI request all BSS epfd(down) limits for {freq_min, freq_max, date}
For all unique epfd(down) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Down
Service = BSS
Frequency = FrequencyRun
ES_DishSize = From Limits API
ES_GainPattern = From Limits API
epfd_Threshold = From Limits API
Ref_BW = From Limits API
}
}
For all unique ES {freq_min, freq_max} in non-GSO notice
{
From LimitsAPI request all epfd(up) limits for {freq_min, freq_max, date}
For all unique epfd(up) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Up
Frequency = FrequencyRun
Sat_Beamwidth = From Limits API
Sat_GainPattern = From Limits API
epfd_Threshold = From Limits API
Ref_BW = From Limits API
}
}
For all unique Satellite {freq_min, freq_max, date} in non-GSO notice
{
From LimitsAPI request all epfd(is) limits for {freq_min, freq_max, date}
For all unique epfd(is) limits returned
{
Set FrequencyRun = max(fmin(mask), fmin(limits)) + RefBW/2
CreateRun:
Direction = Intersatellite
Frequency = FrequencyRun
Sat_Beamwidth = From Limits API
Sat_GainPattern = From Limits API
epfd_Threshold = From Limits API
Ref_BW = From Limits API
}
}
D2.2	Number 9.7A of the Radio Regulations
For RR No. 9.7A runs the criteria and threshold is defined in RR Appendix 5 and runs are generated as follows:
If the selected earth station meets the criteria in Appendix 5
{
Get the frequency range of the selected ES(fmin, fmax)
Get all non-GSO networks in the SRS that overlap that frequency range
For each non-GSO network returned
{
Query Limits API with the selected ES(fmin, fmax)
{
Get RefBW from Appendix 5 Data
Set FrequencyRun = max(ES_fmin, Mask_fmin) + RefBW/2
CreateRun:
Direction = Down
Frequency = FrequencyRun
ES_DishSize = From ES filing
ES_GainPattern = From ES filing
epfd_Threshold = From Appendix 5
Ref_BW = From Appendix 5
}
}
}
D2.3	Number 9.7B of the Radio Regulations
For RR No. 9.7B runs the criteria and threshold is defined in RR Appendix 5 and runs are generated as follows:
Get (fmin, fmax) from non-GSO notice
{
Get all ES in the SRS that overlap that frequency range
For each ES returned
{
If the earth station meets the criteria in Appendix 5
{
Query Limits API with ES(fmin, fmax)
Get RefBW from Appendix 5 Data
Set FrequencyRun = max(ES_fmin, Mask_fmin) + RefBW/2
CreateRun:
Direction = Down
Frequency = FrequencyRun
ES_DishSize = From ES filing
ES_GainPattern = From ES filing
epfd_Threshold = From Appendix 5
Ref_BW = From Appendix 5
}
}
}
}
D3	Worst-case geometry
The epfd limits in RR Article 22 are applicable for all GSO ESs and all pointing angles towards that part of the GSO arc visible from that ES. It is, however, not feasible to model all such geometries within the verification software. The worst-case geometry (WCG) is a reference GSO satellite location and either an ES or boresight of the GSO satellite’s beam which is used when examining a non-GSO system for compliance with the epfd limits in RR Article 22. It remains necessary for the non-GSO operator to meet the epfd limits in RR Article 22 for all other geometries including the testing of specific GSO networks as noted in § A1.3.
The WCG is selected by an algorithm, the worst-case geometry algorithm (WCGA), which undertakes an examination of the pfd/e.i.r.p. masks together with the non-GSO satellite orbital parameters to identify the highest single entry epfd value. Where there are multiple geometries with the same highest single entry epfd value, then the geometry is selected that should have this highest single entry epfd for the greatest percentage of time, identified by considering the angular velocity or elevation angle. These assumptions are based on the critical epfd levels being the highest ones which are those that are most readily measurable.
The WCGA is based upon iterating over a set of positions, typically of the non-GSO satellite. The geometry is assumed to be symmetric in longitude and the satellite can be set at the required latitude exactly using a simple point-mass model. However the epfd calculation engine described in § D5 can use a range of orbit models with a specific time step and therefore the longitude at which a satellite reaches a specified latitude will be different from that in the WCGA. Hence an additional stage is required which for the non-GSO satellite that results in the highest single entry epfd the difference in longitude is calculated between:
–	The longitude of the non-GSO satellite when it reaches the specified latitude using a point mass model in the WCGA, converting to (latitude, longitude) using a static time t = simulation start time (e.g. relative time = 0).
–	The longitude at which the non-GSO satellite is closest to the specified latitude using the full orbit model and the fine time step calculated for the given run, converting to (latitude, longitude) using the relevant simulation time.
This difference in longitude is shown in Fig. 13.
Figure 13
Adjusting longitude of WCG to take account of orbit model and simulation time
This difference in longitude is then used to adjust the position of the GSO satellite and ES calculated in the WCGA so that the non-GSO satellite with the pfd mask that causes the highest epfd goes through the geometry that causes this epfd value during its first orbit. When iterating for latitude using the time step, the time step that gives the nearest latitude is used in the longitude calculation.
Note that the algorithm in this Recommendation is not designed to take account of either ITU-R Regions or specific longitudes as the epfd limits in RR Article 22 are meant to be applicable for all GSO ES locations and visible parts of the GSO arc.
Care is required when comparing floating point numbers to check for rounding errors. In the WCGA it is acceptable to round to the nearest 0.1 dB rather than round up. The search grid is in steps of 0.1° and binary search routines terminate when the difference in angles is less than 1e-5 radians.
D3.1	WCG epfd↓
D3.1.1	Inputs
The inputs to the algorithm include:
pfd_mask:	the pfd mask to check
0[lat] :	the GSO arc avoidance angle of the non-GSO satellite by latitude = MIN_EXCLUDE[Latitude]
h :	the minimum operating height of the non-GSO satellite
0[lat, az] :	the minimum elevation angle of the non-GSO satellite by latitude and azimuth
{a, e, i}:	the orbit parameters of the non-GSO system
ES:	the parameters of the ES including gain pattern.
D3.1.2	Algorithm
This section describes the algorithm to determine the WCG for the epfd(down) direction.
Note that there could be different ranges of frequency in the pfd masks: this process is assumed to be repeated for each valid frequency range. For each valid frequency ranges there could be different pfd masks, multiple sets of {a, e, i} or system operating parameters (e.g. GSO avoidance angles that vary by non-GSO satellite): the process should be repeated over each such set.
The WCG is based upon search in (, φ) as seen by the non-GSO satellite, with particular care taken for the region (–0, +0) including  = 0. This search is repeated at a number of test non-GSO satellite latitudes. In addition, specific checks are made for the highest latitudes for which  = {−0, 0, +0} to ensure compatibility with the methodology in Recommendation ITU-R S.1714.
For each test point considered, the algorithm calculates the epfd using the pfd mask and receive antenna gain, and compares that to the threshold for the relevant latitude. The gain is calculated using the  angle for the off-axis angle : for the BSS ES antenna gain pattern, which might not be symmetric around the boresight, the  should be the value calculated assuming the ES points at the location at the point correspond to the  angle. Note that the algorithm can be implemented in a way that calculates the WCG for multiple dish sizes using vectorisation.
It is likely that multiple test points will result in the same difference between epfd level and threshold. To assess which should be used as the WCG, the angular velocity of the non-GSO satellite as seen by the ES is calculated, and the geometry selected is that:
1.	Gives the highest difference between epfd level and threshold to the resolution of the resulting statistics (0.1 dB).
2.	If multiple geometries meet point 1, select the one that would result in geometry that gives the lowest angular velocity of the satellite as seen by the ES.
The search algorithm is shown in Figs 14 and 15, where:
Figure 14
Search (, φ) grid for WCGD_CalcAtLat
Figure 15
Geometry for WCGD_CheckExtremeCase
The algorithm is described in the following pseudo code for specified GSO ES type:
WCGA_Down:
Set WorstEPFDBin = –9999
Set WorstAngularVelocity = +9999
Identify 0,min = minimum value over all values in the 0[lat, az] table
For all satellites in the order listed in ITU DB
{
Determine PFD mask to use for this satellite
If this PFD mask and satellite orbit (a, e, i) combination has not been checked so far then or this satellite uses a different 0[lat] then
Call GetWCGA_Down(SystemParams)
End if
}
Next satellite
Note that SystemParams = (PFD_Mask, 0[lat], 0[lat, az], ES, OrbitParams, 0,min) as required
GetWCGA_Down (SystemParams):
StepSize = 0.1°
If (i = 0)
{
WCGD_CalcAtLat(SystemParams, latitude = 0)
}
Else
{
LatNumSteps = RoundUp(i / StepSize)
For n = 0 to LatNumSteps inclusive
{
latitude = i * n / LatNumSteps
WCGD_CalcAtLat(SystemParams, latitude)
If (n > 0)
{
WCGD_CalcAtLat(SystemParams, -latitude)
}
}
WCGD_CheckExtremeCase(SystemParams, 0,  = +/2}
WCGD_CheckExtremeCase(SystemParams, 0,  = -/2}
WCGD_CheckExtremeCase(SystemParams, +1,  = +/2}
WCGD_CheckExtremeCase(SystemParams, -1,  = –/2}
WCGD_CheckExtremeCase(SystemParams, +1,  = +/2}
WCGD_CheckExtremeCase(SystemParams, -1,  = -/2}
}
}
WCGD_CalcAtLat(SystemParams, latitude):
Locate non-GSO satellite at latitude
Calculate height of non-GSO satellite from its radius, r
If height of non-GSO satellite < minimum operating height then return	Calculate φ0 for elevation angle 0, min and radius r
WCGD_CheckCase(SystemParams, latitude,  = 0, φ = 0)
NumPhiSteps = RoundUp(φ0 / StepSize)
PhiStepSize = φ0 / NumPhiSteps
For φ = PhiStepSize to φ0 inclusive in NumPhiSteps steps
{
ThetaMin = /2
ThetaMax = +3/2
If the PFD mask is symmetric in DeltaLong or Azimuth and elevation table is also symmetric between east and west
{
ThetaMax = /2
}
NumThetaSteps = max(16, RoundUp(2φ/PhiStepSize))
ThetaStepSize = (ThetaMax-ThetaMin)/NumThetaSteps
For ThetaStep = 0 to NumThetaSteps inclusive
{
= ThetaMin + ThetaStep*ThetaStepSize
WCGD_CheckCase(SystemParams, latitude, , φ)
}
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, 0, RHS)
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, +1, RHS)
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, -1, RHS)
If the PFD masks is not symmetric then
{
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, 0, LHS)
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, +1, LHS)
WCGD_CheckAlphaPhiCase(SystemParams, latitude, φ, -1, LHS)
}
}
WCGD_CheckAlphaElevCase(SystemParams, latitude, 0, RHS)
WCGD_CheckAlphaElevCase(SystemParams, latitude, +1, RHS)
WCGD_CheckAlphaElevCase(SystemParams, latitude, -1, RHS)
If the PFD mask is not symmetric then
{
WCGD_CheckAlphaElevCase(SystemParams, latitude, 0, LHS)
WCGD_CheckAlphaElevCase(SystemParams, latitude, +1, LHS)
WCGD_CheckAlphaElevCase(SystemParams, latitude, -1, LHS)
}
WCGD_CheckCase(SystemParams, latitude, , φ):
Convert (,φ) to (az, el) in the satellite reference frame
Create line from non-GSO satellite N in direction (az, el)
Identify point P in which line intersects Earth
Calculate the latitude of P, latP
If Absolute(latP) > 81.2 degrees then exit this function
If latP < ES_LAT_MIN then exit this function
If latP > ES_LAT_MAX then exit this function
If number of non-GSO satellites that operate at this latitude is zero then exit this function
Calculate the (aznGSO, elnGSO) of the non-GSO satellite as seen by the ES
Find the nearest latitude to latP in the 0[latP, AznGSO] table
At point P calculate (, long) angles wrt point N
At point P calculate AngularVelocity using methodology below
Calculate PFD from mask, latitude & (az, el, , long)
Calculate G() and G(0[latP])
Calculate the elGSO of the point on the GSO arc associated with the calculated
GSO = the appropriate minimum elevation angle in Table 8
If ((  0[latP] and elnGSO  0[latP, AznGSO] and elGSO >= εGSO)
or G() > min(Gmax -30 dB, G(0[latP])) ) then
{
Calculate EPFDThreshold from latitude of point P on the Earth’s surface
Calculate EPFDMargin = PFD + Grel() - EPFDThreshold
Calculate EPFDbin = EPFDMargin/BinSize
If WorstEPFDBin < EPFDBin
{
WorstEPFDBin = EPFDBin
Worst AngularVelocity = AngularVelocity
Store this (N, P)
}
Else if (WorstEPFDBin = EPFDBin &&
WorstAngularVelocity > AngularVelocity)
{
WorstAngularVelocity = AngularVelocity
Store this (N, P)
}
}
WCGD_CheckAlphaPhiCase(SystemParams, Latitude, φ, Sign, Side):
Set  range according to side to check (left or right)
If bracket  = 0 then
{
Use binary search to iterate on  until WCGD_GetDeltaAlpha(SystemParams, Sign, , φ) = 0
WCGD_CheckCase(SystemParams, latitude, , φ)
}
WCGD_CheckAlphaElevCase(SystemParams, Latitude, Sign, Side):
Set  range according to side to check (left or right)
If bracket  = 0 then
{
Use binary search to iterate on  until within 1e-5 radians
{
For each i
{
Call WCGD_CalcPhiFromThetaElev(SystemParams, i) to determine φi					Call WCGD_GetDeltaAlpha(SystemParams, Sign, i φi) to determine i
}
} selecting  that brackets  = 0
WCGD_CheckCase(SystemParams, latitude, , φ)
}
WCGD_CalcPhiFromThetaElev(SystemParams, ThetaTest, PhiMax):
φ0 = 0
φ1 = PhiMax
Use binary search to iterate on φ until within 1e-5 radians
{
For each φi
{
Call WCGD_CalcDeltaElev(SystemParams, ThetaTest, φi)
}
} selecting φ that brackets  = 0
Return φ
WCGD_GetDeltaAlpha(SystemParams, Sign, , φ):
Convert (,φ) to (az, el)
Create line in direction (az, el) from non-GSO satellite
Identify point P where line intersects Earth
Calculate latitude of P, latP
Determine exclusion zone size at this point, 0[latP]
At point P calculate
deltaA = Sign*0[latP]
Return  - deltaA
WCGD_GetDeltaElev(SystemParams, ,φ):
Convert (,φ) to (az, el)
Create line in direction (az, el) from non-GSO satellite
Identify point P where line intersects Earth
Calculate latitude of P, latP
Calculate (aznGSO, elnGSO) of non-GSO satellite as seen by point P
At point P calculate 0[lat, az]
Return elnGSO - 0[lat, az]
WCGD_CheckExtremeCase(SystemParams, Sign, ):
Set latitude range according to sign (north or south hemisphere)
If bracket  = 0 then
{
Use binary search to iterate until latitude range less than 1e-5 radians
{
For each test latitude, Lat
{
Call WCGD_CalcDeltaAlphaFromLatElev(SystemParams, Lat, Sign, i) to determine i and corresponding φi
}
} Selecting latitudes that bracket  = 0
WCGD_CheckCase(SystemParams, latitude, , φ)
}
WCGD_CalcDeltaAlphaFromLatElev(SystemParams, Latitude, Sign, ):
Set satellite at Latitude
Get φ using WCGD_CalcPhiFromThetaElev SystemParams, , PhiMax)
Calculate  from WCGD_CalcDeltaAlpha(SystemParams, Sign, , φ)
Return , φ
The algorithm uses the geometry given in the sections below.
D3.1.3	Geometry
D3.1.3.1	Conversion between (az, el) and (, φ)
The following equations can be used:
Note that it is necessary to check the sign of the az or φ to ensure that the arccos / arcsin is calculated correctly.
It should also be noted that the equations above should be used in the application of the worst-case geometry algorithm and that they are different from the equations converting (θ, ) into (Az, El) included in § C2.3.2.
The (, φ) coordinate system and its relationship to the (az, el) coordinate system is shown in Figs 16 and 17 below.
Figure 16
Conversion between (Azimuth, Elevation) and (, φ) from satellite viewpoint
Figure 17
Conversion between (Azimuth, Elevation) and (, φ) in 3D
The φ angle is between the two lines:
–	from the satellite to the sub-satellite point
–	from the satellite to the test direction.
The  angle is around the boresight in an anti-clockwise direction from the elevation = 0 plane.
D3.1.3.2	Setting satellite at latitude
Key steps in this algorithm are the calculation of the position and velocity vectors of the non-GSO satellite and ES. For circular orbit systems the latitude can be used to derive the true anomaly, , using:
For elliptical systems, it is necessary to use binary search. Assuming the system is designed to have with argument of perigee = ±/2, then the satellite will go from minimum to maximum latitude when the mean anomaly varies from [0, ]. Therefore, the binary search can start with M = (0, ) and iterate from there.
To derive the position and velocity vectors, the following equations could be used:
In the satellite plane:
where:
P, Q:	unit vectors in the orbit plane with origin the centre of the Earth and P aligned with the orbit’s major axis as described in § D6.3.3
a, e, : 	orbital elements.
Also:
The non-GSO’s position and velocity vectors can then be converted from the PQW orbit plane based frame to Earth centred vectors using the standard rotation matrix via the (, , i) orbital elements. For the WCG calculation it can be assumed that second order effects including the J2 factor need not be considered.
The position vector equation can also be used to calculate a latitude from a true anomaly, , and hence by iteration locate the satellite at the required latitude.
D3.1.3.3	Calculation of maximum φ in satellite viewpoint
For a given latitude and hence satellite radius, the maximum angle at the satellite from sub-satellite point φ0 can be derived from the elevation angle  using:
D3.1.3.4	Calculation of angular velocity
The inputs are as follows:
ES position vector:	res
ES velocity vector:	es
Non-GSO satellite position vector:	rsat
Non-GSO satellite velocity vector:	sat
From these, it is possible to calculate the apparent velocity and vector from the ES to the satellite:
r = rsat – res
= sat – es
The angle between these two vectors can then be calculated:
The instantaneous angular velocity is then:
The various terms are shown in Fig. 18.
Figure 18
Vectors to calculate non-GSO satellite apparent angular velocity
Note that a low angular velocity will result in higher likelihoods of interference and hence for a given epfd value the WCG that gives the least apparent angular velocity would be the one to use.
The ES’s velocity vector can be derived from its position vector (x, y, z) as follows:
where we is the Earth’s angular velocity in radians per second.
D3.2	WCG epfd↑
Note that as the epfd limits in Article 22 are for 100% of the time there is no need to consider the likelihood of particular geometries, only the maximum epfd(up) value.
If there are multiple sub-constellations with alternative orbital elements or some satellites use different exclusion zone angles, then the process should be repeated for each unique set.
D3.2.1	Inputs
The inputs to the algorithm are as follows:
ES_e.i.r.p.:	the non-GSO ES e.i.r.p. mask to check. This could vary by latitude, with each latitude range having an e.i.r.p. pattern, defined as a table of e.i.r.p. vs off-axis angle towards the GSO arc or by latitude, azimuth and elevation, with each latitude/azimuth/elevation having an e.i.r.p pattern defined as a table of e.i.r.p. against difference in longitude between the ES and GSO satellite
θadB :	the GSO satellite’s beam half power beamwidth
0,GSO :	the minimum elevation angle of the GSO system
0[lat, az] :	the minimum elevation angle of the non-GSO system, which could vary by latitude and azimuth
0[lat] :	the minimum exclusion angle of the non-GSO system, which could vary by latitude and non-GSO satellite
Nco[lat] :	the number of non-GSO satellites that can provide co-frequency service at a specific location on the Earth’s surface, which could vary by latitude
ES_DISTANCE, ES_DENSITY :	the average distance on the Earth’s surface between co-frequency beams from the non-GSO system (km) and density of co-frequency non-GSO ES or:
ES(lat, long) :	the latitude and longitude of the specific ES of the non-GSO system
{a,i,e, ,,} :	the orbit parameters of the non-GSO system including whether the system’s ground track repeats and if so the repeat time.
D3.2.2	GSO system parameters
It is assumed that the GSO system’s minimum operating elevation angle and beamwidth are as in Table 8.
TABLE 8
WCG(up) GSO system parameters
Table 9 shows the geocentric angle that corresponds to the minimum elevation angle and hence the maximum angle at the GSO satellite towards the beam boresight φBS:
TABLE 9
WCG(up) derived minimum and maximum values
These were generated using the geometry in Fig. 19 and the following equations.
FIGURE 19
GSO pointing angles for WCGA(UP) geometry
Here the φBS can be derived as follows:
Then, noting that as  > /2:
Hence:
D3.2.3	Algorithm
The WCGA for the epfd(up) case is as follows:
WCGA_UP:
Calculate φBS from EOC
From φBS calculate BS
If ES from density
Call WCGA_UP_General
Else
If non-GSO satellite repeats
Call WCGA_UP_SpecifcES_Repeating
Else
Call WCGA_UP_SpecifcES_NonRepeating
Endif
Endif
The various cases, their functions and geometries are described in the following sections.
D3.2.3.1	Aggregate epfd calculation
In the general case the aggregate epfd(up) can be calculated using:
Note the summation is in absolute though the equation is given in dB terms with addition and where:
e.i.r.p. lat) :	e.i.r.p. towards the GSO for the given non-GSO ES latitude either as a function of latitude and off-axis angle towards the GSO arc or function of latitude, boresight (azimuth, elevation) and difference in longitude between the non-GSO ES and GSO satellite
LS :	spreading factor
Grel,rx :	relative gain at the GSO satellite using the Rec. ITU-R S.672 gain pattern
NUM_ES :	is a factor for systems using density rather than specific ES (and which typically relates to the access method) derived from the non-GSO system’s density and distance fields as given in § D5.2.5
NUM_ES = ES_DISTANCE * ES_DISTANCE * ES_DENSITY
Nco,ES(lat) :	maximum number of co-frequency non-GSO ES that can transmit at a given location.
The summation is over the NES non-GSO deployed within the GSO satellites 15 dB beamwidth footprint using the algorithm in § D5.2.5. This depends upon the separation distance between co-frequency beams which is a parameter provided by the non-GSO system.
For the WCG(up) calculation, it is assumed that the aggregate epfd is dominated by the single entry epfd at the boresight plus an aggregation factor and so this can be estimated by extracting the non-GSO parameters from the summation as in:
This last term is only dependent upon the geometry (in particular the geocentric angle, ) and the gain pattern in Recommendation ITU-R S.672 but not upon any of the non-GSO parameters and hence can be pre-computed.
A method to calculate based upon an assumed non-GSO ES separation distance ES_DISTANCE = DES = 100 km is via the following Pade approximation:
where:
TABLE 10
F672 Pade approximation parameters
For the specific ES case the DES is not defined and so a value of 100 should be used while NUM_ES set to 1 so this term does not contribute.
Given the F672 factor, the epfd(up) for a given geometry can be estimated using:
D3.2.3.2	Worst pointing
The epfd calculation above relies on the ability to calculate the maximum e.i.r.p. towards the GSO. As well as the e.i.r.p. mask, this will depend upon a number of additional factors including:
–	Latitude of the non-GSO ES
–	Minimum elevation angle(s) at that latitude 0[az, lat]
–	Exclusion zone size 0[lat]
–	Constellation (or sub-constellation) orbit parameters.
The influence of some of the factors can be seen in the examples below assuming the non-GSO ES is in the northern hemisphere so that the centre of the Figure is pointing south.
Equatorial orbit, low latitude
Figure 20
Equatorial orbit low latitude
Here the non-GSO satellite never intersects the GSO orbit or the exclusion zone and so the min is the angle at the non-GSO ES between the equatorial orbit and GSO arc in the azimuth of consideration.
Note that a purely equatorial orbit would be repeating so would be handled by a separate case within the WCG. However it is included to show the edge case and gain an understanding of the geometry involved.
Equatorial orbit, high latitude
Figure 21
Equatorial orbit high latitude
Here again the non-GSO satellite orbit never intersects the GSO orbit or exclusion zone but for the azimuth of the GSO satellite the non-GSO satellite would not be active as it is below the minimum elevation angle. Hence the min is between the nearest azimuth for which the non-GSO satellite would be above the horizon. However this point would be considered as the applicable point for another position on the GSO satellite where the minimum off-axis angle would be smaller and hence e.i.r.p. larger. It is therefore suggested that if the non-GSO satellite is below the minimum elevation angle for that azimuth it need not be considered.
Polar orbit, low latitude
Figure 22
Polar orbit low latitude
In this case the polar orbiting satellite could be located at any pointing angle (az, el) as seen by the non-GSO ES. The limiting case is then the edge of the exclusion zone, so that min = 0[lat].
Polar orbit, high latitude
Figure 23
Polar orbit high latitude
In this case the GSO arc is always below the minimum elevation angle and hence the minimum off-axis angle min is the difference between the minimum elevation angle and elevation angle of the GSO arc in the azimuth / latitude of interest.
Note this also the case for the previous scenario (polar orbit, low latitude) for the extreme edge case where the GSO arc has a low elevation angle as seen by the non-GSO ES.
Low inclination, no in-line geometry
Figure 24
Low inclination, no in-line geometry
This example is similar to the equatorial case in that there is no in-line geometry, and hence the min angle to use is the angular separation between the edge of the visible zone and GSO arc or the exclusion zone angle 0[lat], whichever is larger.
Low inclination with in-line geometry
Figure 25
Low inclination with in-line geometry
This is an extension of the previous case with the inclination increased until the visible zone spreads either side of the GSO arc. The minimum off-axis angle is then the exclusion zone size so that min = 0[lat].
General case
The geometry of the general case is shown in Fig. 26.
Figure 26
General case with orbit shell
The general method iterates over the field of view of the GSO satellite and determines the associated ES location.
For non-GSO systems with non-repeating orbits, the result will be the same for all longitudes of the GSO system, and hence a GSO longitude = 0° can be used.
For non-GSO systems with repeating orbit, an initial run should be undertaken and the average longitude of each of the non-GSO satellites calculated over the repeat period together with the likelihood of the non-GSO satellite being within 1 degree of that average longitude. The GSO satellite should be located at the average longitude of the non-GSO satellite with the highest likelihood of being within 1 degree of that satellite’s average longitude.
Then given:
–	GSO satellite longitude
–	Non-GSO ES φ (latitude, longitude)
–	Maximum or minimum latitude of the non-GSO satellite
–	Radius of the non-GSO satellite when at the maximum/minimum latitude.
It is then possible to iterate on the longitude of the non-GSO satellite which minimises the angle to the GSO satellite as seen at the ES. This is the converse of the  angle and hence is called the  angle. This can be derived using iteration or the analytic method as described in § D6.4.4.4. There will be two positions, the + associated with the maximum latitude and the - associated with the minimum latitude of the non-GSO system.
It is also possible to determine points that are in the direction of the + and - points with angle 0 from the GSO satellite as in Figs 27, 28 and 29. This results in points {a, b, c, d} that can then be checked to see if they are valid, in particular that:
–	They are at least 0 away from the GSO satellite (arc)
–	They are within the [+, -] range of the non-GSO satellite as seen by the ES
–	They are above the minimum non-GSO elevation angle for the non-GSO ES latitude and azimuth of the test point.
If they are valid then they can be considered as possible options for the minimum off-axis angle towards the GSO satellite at the non-GSO ES when pointing at a non-GSO satellite.
Figure 27
WCG(up) general case when [+, -] bracket the GSO arc
Figure 28
WCG(up) general case when [+, -] do not bracket the GSO arc or intersect minimum
Figure 29
WCG(up) general case when [+, -] do not bracket the GSO arc but does intersect minimum
There is also a fifth test point {e} to handle the case when the GSO arc is below the minimum elevation angle as shown in Fig. 30.
Figure 30
WCG(up) general case when [+, -] bracket the GSO arc but it is below the minimum elevation angle
D3.2.3.3 	WCG_Up_General
The general case iterates over the field of view of the victim GSO satellite as shown in Fig. 31.
Figure 31
Search of GSO satellite field of view
The search is undertaken in (, φ) as described below:
WCGA_UP_General:
CheckCaseUpGeneral(0, 0)
NumberOfPhiSteps = Integer(Degrees(φ0)/ 0.1)
For PhiStep = 1 to NumberOfPhiSteps inclusive
φ = φ0 * PhiStep / NumberOfPhiSteps
ThetaStepSizeDegrees = 0.1 * φ0 / φ
NumberOfThetaSteps = max(16, Integer(360 /  ThetaStepSizeDegrees))
For ThetaStep = 0 to NumberOfThetaSteps-1 inclusive
= radians(ThetaStepSizeDegrees * ThetaStep)
CheckCaseUpGeneral(, φ)
Next ThetaStep
Next PhiStep
CheckCaseUpGeneral(, φ):
Convert (, φ) to (az, el) at a GSO satellite set at longitude = 0
Use (az, el) to create line from the GSO satellite
Calculate the intersection point of that line and the spherical Earth
Calculate the (lat, long) of the non-GSO ES at the intersection point
Check that the latitude is in the range of the non-GSO system i.e between ES_LAT_MIN and ES_LAT_MAX
Check that the Nco(lat) > 0
If the latitude is ok then
If the non-GSO system uses a repeating orbit then
{
Call WCGA_UP_SpecifcES_Repeating
Return
}
For this (lat, long) calculate the geocentric angle
For the GSO system’s beamwidth, calculate the F672()
If the e.i.r.p. mask is defined by offaxis angle then
{
Call CalcMinOffaxisAngle to calculate  for this location
If find a minimum offaxis angle then calculate the epfd(up) using:
If this is the highest epfd(up) then store this value and (, φ)
}
Else the ES e.i.r.p. mask is defined by (az, el, DeltaLongES) then
{
Call CalcES_e.i.r.p.(Non-GSO ES lat, long) to calculate e.i.r.p.(lat) for this location
Calculate the epfd(up) using:
If this is the highest epfd(up) then store this value and (, φ)
Endif
Endif
Note that the method to calculate the maximum latitude of the non-GSO system is given in § D3.2.3.6.
CalcES_e.i.r.p.(non-GSO ES lat, long)
Calculate the DeltaLongES
Create a vector rES of the non-GSO ES
Set Maxe.i.r.p. = -9999
Identify the ES_e.i.r.p. table for this non-GSO latitude
Set StepSizeDeg = 0.5
Set NumAz = 1 + integer(360 degrees / StepSizeDeg)
Set NumEl = 1 + integer(90 degrees / StepSizeDeg)
For all az_i = 0 to NumAz not inclusive
Az = -180 + az_i * 360 / NumAz
For all el_i = 0 to NumEl inclusive
El = 0 + el_i * 90 / NumEl
Create a vector razel in direction (az, el)
Select the appropriate es e.i.r.p. (az, el) array
If the (az, el) direction is outside the exclusion zone and above the minimum elevation for this azimuth and there could be a satellite in this direction then
{
Calculate the ES_e.i.r.p.az,el towards the GSO for this (az, el, DeltaLong)
If ES_e.i.r.p.az,el is greater than ES_e.i.r.p. then use this value instead
}
Next el_i
Next az_i
To determine if there could be a non-GSO satellite in a given (az, el) direction from a non-GSO ES at position rES, the following algorithm can be used, assuming that the vectors rES and razel are in Earth centred coordinates (x, y, z):
Inputs:
Non-GSO ES position vector = rES
Vector in direction (az, el) = razel
non-GSO satellite orbit inclination angle = i
non-GSO satellite semi-major axis = a
non-GSO satellite eccentricity = e
If the non-GSO satellite eccentricity = 0 (i.e. circular orbit):
There could be a satellite in direction (az, el) if
−i  Latitude(a)  +i
Otherwise, if the non-GSO satellite eccentricity > 0 (i.e. elliptical orbit):
There could be a satellite in direction (az, el) if the following are both true:
−i  Latitude(a(1+e))  +i
−i  Latitude(a(1-e))  +i
Where the function CalcLatitude(d) is:
Create a line from the non-GSO ES in direction (az, el) using parameter :
The value of  for which the line is at distance d from the centre of the Earth can be calculated by solving the quadratic equation:
The root for which  > 0 should be used to calculate the position vector r.
From this the latitude can be calculated using:
Latitude(d) = asin(r.z / r)
CalcMinOffaxisAngle(non-GSO ES lat, long)
Calculate the (azGSO, GSO) of the GSO satellite as seen by the non-GSO ES
Determine the radius Rn,+ of the non-GSO satellite when its lat = +i
Determine the radius Rn,- of the non-GSO satellite when its lat = -i
If Rn,+ or Rn,- are below the minimum operating height then determine the latitude of the non-GSO satellite when at this height and use this instead
For each of {Rn,+, Rn,+} and {lat+, lat-}, calculated the {+, -} angles and associated non-GSO satellite positions identified as (a, b) in Figs. 27-29
For each of the {+, -} positions, use spherical geometry to derive points (c, d) which have angle at the ES of 0 along the lines to point (a, b) respectively
For each of (a, b, c, d) points, calculate the (azimuth, elevation) as seen by the ES
Set the MinimumAngle to be +9999
For each of points (a, b, c, d):
If point is within {+, -} range and at least 0 away from GSO satellite and above the 0(lat, azimuth) then
{
MinimumAngle = min(MinimumAngle, angle for this point)
}
Next point
If {+, -} bracket the GSO arc and the elevation of the GSO satellite is less than the minimum elevation angle for the GSO satellite azimuth then
{
MinimumAngle = min(MinimumAngle, max(0, 0[Lat, AzGSO] - GSO))
}
Return MinimumAngle or if not found, an error code
D3.2.3.4	WCGA_UP_SpecifcES_Repeating
If there are specific ES locations and the non-GSO satellite network using a repeating track orbit then there will be a highly limited number of geometries that are feasible. It is therefore possible to fly the satellite for the repeat period and then, for each ES, for each non-GSO satellite, calculate the . If  ≤ 0, or the elevation angle is below the minimum, then the ES would not transmit, otherwise the epfd towards that location can be derived.
Not all geometries will be feasible. For example:
–	Non-GSO ES above 81.29° N or S will not see the GSO arc and so can be excluded.
–	There will be a maximum difference in longitude between that of the non-GSO ES determined by the edge of coverage (EOC) elevation angle of the GSO system.
–	The non-GSO ES will not transmit to the non-GSO satellite when it is within the exclusion zone defined by  < 0.
–	The non-GSO ES will not transmit to the non-GSO satellite when its elevation angle is below the minimum  < 0[lat, az].
–	The non-GSO satellite is below the minimum operating height hmin.
–	The number of non-GSO satellites that can ES at this latitude is zero.
–	These are therefore checked in the following algorithm:
WCGA_UP_SpecifcES_Repeating
Calculate time step according to algorithm in § D4.3
For t = 0 to repeat time of constellation
Update positions of non-GSO satellites for this time step
For each non-GSO ES
If the non-GSO ES lat is <+81.29° && >-81.29° && Nco[Lat] > 0 then
For each non-GSO satellite
If satellite is visible and above minimum operating height
Calculate the elevation angle  and azimuth
Calculate the exclusion zone angle
If (  0[lat, az] and   0[lat) then
If this is the worst epfd so far then store this geometry
Endif
Endif
Next satellite
Endif
Next ES
Next time step
D3.2.3.5	WCGA_UP_SpecifcES_NonRepeating
For the non-repeating case the non-GSO satellites will populate an orbit shell but only some of the geometries considered in the general case will be feasible as the non-GSO ES will only be at specific latitudes. Therefore this approach searches across the GSO arc as seen by each of the non-GSO ES then takes a similar approach to the general case.
WCGA_UP_SpecifcES_NonRepeating:
For each non-GSO ES
If the non-GSO ES latitude is <+81.29° or >-81.29° then
Calculate MaxDeltaLong = acos((Re/Rgeo)/cos(ES_lat))
NumLongSteps = (integer)(degrees(MaxDeltaLong)/0.1°)
For DeltaLongStep = -NumLongSteps to +NumLongSteps
DeltaLong = MaxDeltaLong * DeltaLongStep / NumLongSteps
GSO_Long = ES_Long + DeltaLong
Calculate (az, el) of ES as seen by GSO satellite
Convert (az, el) to (, φ)
Call CheckCaseUpGeneral(, φ)
Next DeltaLongStep
Endif
Next ES
D3.2.3.6	Range in latitude
When calculating the WCG(up) and also the epfd(up), it is necessary to identify where the ES could be located. While most systems in types A and B have global coverage, non-GSO networks of type C will be limited in the latitude range. For systems with multiple sub-constellations, this range could vary between sub-constellations.
The latitude range can be derived from the satellite’s height, its inclination angle and the minimum operating elevation angle for the ES, as in Fig. 32 below.
Figure 32
Calculation of maximum latitude for ESs
For elliptical systems, there will be two values, one for the apogee and another for the perigee, and so the inputs would be:
Semi-major axis of orbit (km):	a
Eccentricity of orbit:	e
Minimum elevation angle (radians):
Inclination angle (radians):	i
From these parameters, the following calculations can be undertaken:
Then:
Similarly, using:
Using the same equations but replacing suffix (a) with (p), the following can be derived:
This assumes that for elliptical systems, the apogee is in the northern hemisphere, i.e. that one of the following is true:
e = 0
= 270°
where:
:	argument of perigee.
In the case that:
e > 0
= 90°
Then the following adjustments should be made:
Latmax’ = –Latmin
Latmin’ = –Latmax
In the case that the orbit inclination is zero and eccentricity zero (i.e. for an equatorial circular orbit) then these equations reduce to:
D3.3	WCG epfdIS
D3.3.1	Inputs
The inputs to the algorithm are as follows:
SS_e.i.r.p.:	the satellite e.i.r.p. mask to check
θadB :	the GSO satellite’s beam half power beamwidth
:	the minimum elevation angle of the GSO system
a,i,e, ,, :	the orbit parameters of the non-GSO system.
The GSO satellite’s beam half power beamwidth and minimum elevation angle can be selected using the same method as in § D3.2.2 for the WCG epfd(up).
If there are multiple sub-constellations with alternative orbital elements then the process should be repeated for each unique set of {a, e, i}.
D3.3.2	Algorithm
WCGA_IS:
From the epfd limits get the gain pattern to use
From the epfd limits get the GSO beamwidth θadB
From  θadB calculate φ1, φ2
Using the gain pattern calculate Grel(φi) for i = 1,2
From φ1 calculate LatBS
If for all satellites i = 0 then
{
Worst Case Geometry:
BS.Latitude = 0
BS.Longitude = LatBS
GSO.Longitude = 0
}
Else
{
Set WorstEPFDBin = -9999
Set WorstAngularVelocity = +9999
For all satellites in the order listed in ITU DB
{
Determine e.i.r.p. mask to use for this satellite
If this e.i.r.p. mask has not been checked so far then
Call GetWCGA_IS(e.i.r.p._mask, i)
End if
Next satellite
}
If no solution has been found then
{
Convert (=i, φ=φ1) to (az, el)
Using (az, el), create line from the GSO satellite
Put the ES at the first intersection point with the Earth
}
Rotate GSO, BS in longitude to ensure inline event
GetWCGA_IS(e.i.r.p._Mask, i):
LatStep = i / RoundUp(i) in degrees
For lat=i to +i in LatStep steps
{
Set satellite at latitude to calculate r, v
If satellite is above minimum operating height
{
From r, φi calculate ψi
From φi, ψi calculate Di, θi
Try to calculate ∆longi
In the cases that the geometries are feasible
{
From the GSO gain pattern calculate Grel(φi)
From the e.i.r.p. mask calculate e.i.r.p.(ψi)
Calculate epfdi
Calculate rgso, gso
Calculate θ of non-GSO satellite as seen by GSO
If epfdi is higher than Worstepfd
{
Store this geometry
WorstAngularVelocity = θ
Worstepfd = epfdi
}
Else if epfdi is the same bin as Worstepfd
{
If θ is lower than WorstAngularVelocity
{
Store this geometry
WorstAngularVelocity = θ
}
}
}
}
}
D3.3.3	Geometry
There are two potentially significant geometries, which is when the non-GSO satellite just becomes visible as seen by the GSO satellite and when it traverses the GSO satellite beam, as in Fig. 33.
Figure 33
Two WCG(IS) non-GSO satellite locations
In some cases, the same WCG location will handle both geometries – e.g. for an equatorial satellite system a beam at the extreme in azimuth will be aligned for both geometries.
From the radius of the non-GSO satellite at each of the positions, it is possible to calculate the off-axis angle at the satellite and hence e.i.r.p.() together with the distance as in Fig. 34.
Figure 34
Two WCG(IS) calculation of satellite off-axis angle
where:
(from above)
Hence:
where i = {1, 2} noting that  and that  so that:
Then:
Hence given a non-GSO satellite with radius distance Rngso,i at the two specified geometries, the two single entry epfd levels can be calculated as:
Note that  and  and D is in metres.
By setting the non-GSO satellite at a specified latitude, lat, (where it has longitude long), it is therefore possible to derive the single entry epfd from the radius vector and the two geometries identified above.
In some cases, there will be no in-line geometry – for example for elliptical systems at apogee the line from the non-GSO satellite to the GSO arc will at no point intersect the Earth. This can be checked by calculating the difference in longitude between the non-GSO satellite and the point on the GSO arc from the geometry above and the non-GSO satellite’s latitude using:
If there is no solution to this equation, then there is no position that meets the required geometry. Other positions could be excluded if the non-GSO satellite was below the minimum operating height.
If there is a solution, then the position of the non-GSO and GSO satellite can be calculated from:
For the i = 1 case the boresight is where the line L from the GSO to non-GSO satellite intersects the Earth’s surface.
For the i=2 case the boresight is on a line created using an adjusted non-GSO satellite position, calculated using:
where:
Given multiple locations with the same single entry epfd, then the one to use would be the one with the lowest angular velocity, using the same method as for WCGA(down), noting that the velocity vector of the GSO satellite can be derived in the same way as for earth stations, i.e.:
The position of the GSO satellite would be chosen such that one of the non-GSO satellites with the e.i.r.p. mask identified traverses the critical geometry during its first orbit, using the same methodology as for the WCGA(up).
Additional geometry for the WCG for epfd(IS) is described in §§ D3.1.3 and D3.2.3 above.
D4	Calculation of time step size and number of time steps
D4.1	Simulation time increment and accuracy
The simulation time increment is one of the most important parameters for the determination of a distribution function of interference from non-GSO networks on the basis of the simulation model. Its specified value should guarantee absence of cases when high-level short-term interference exceeding an acceptable level is missed and is not considered. Otherwise results of simulation analysis will be inaccurate and sometimes erroneous. The decrease of a simulation time increment allows to increase accuracy of obtained results but at the same time results in increase of total number of simulation time increments and amount of required calculations.
The description of calculation algorithms for simulation time increment in uplink, downlink and intersatellite cases are shown below.
The algorithms are based upon a set of orbital characteristics, such as the inclination angle. If there are multiple sets, e.g. for multiple sub-constellations, then the longest run time and smallest time step over all sub-constellations should be used.
When an artificial precession is used, the same value should be used for all satellites of the non-GSO system. The value used should be the one calculated for the satellite used to derive the time step size and run duration.
In order to reduce run times, the following procedure should be used to adjust the time step size for non-repeating orbits cases where the number of time steps exceeds 1e8:
Calculate time step and run time using Nhit = 16
If orbit is non-repeating
If number of time steps exceeds 1e8 then:
Re-calculate time step and run time
Endif
Endif
D4.2	Description of the procedure for the determination of minimum downlink simulation time increment
The value of simulation time increment should guarantee acquisition and description of the most short-term interference scenarios with the required accuracy. The high-level short-term interference is caused by emission of a non-GSO space station which is in-line situation (a non-GSO satellite passes through the main beam of a GSO earth station antenna). Therefore, the method for determining a simulation time increment tref  is based on ensuring the required number Nhit of epfd↓ estimations during the time interval t when a non-GSO satellite passes through the main beam of a GSO earth station antenna:
(1)
tref  should be rounded to the nearest non-zero millisecond.
The time required for a non-GSO satellite passing through the main beam of a GSO earth station antenna depends on mutual location of the earth and space stations of the GSO network as well as on orbital parameters of the non-GSO network. The value of t should be computed at the location where the time for a non-GSO satellite to pass through the GSO main beam is smallest. Since this occurs when a GSO earth station is located directly under a GSO space station, pass time t is determined by equations (2) and (3) (see Fig. 35).
(2)
where:
(3)
s:	non-GSO satellite angular velocity of rotation around the Earth at the minimum operational altitude (degrees/s); for multiple orbits, the greatest such s should be selected
e:	Earth rotation angular velocity at the equator (degrees/s)
i:	orbit inclination (degrees)
3dB:	GSO earth station antenna 3 dB beamwidth (degrees)
Re:	Earth radius (km)
h:	orbit altitude (km) (see Note 1).
NOTE 1 – In the case that the constellation has multiple values of h for different sub-constellations or planes, the lowest value should be used. In the case of elliptical orbits the minimum operating height should be used.
Figure 35
Calculation of epfd(down) time step size
The Nhit value defines simulation accuracy. The higher the Nhit value the higher the accuracy of the final results.
Nhit should be set to 16 as derived in § D4.5. In a case when a non-GSO network satellite constellation consists of satellites with different orbital parameters it is necessary to determine a simulation time increment for each type of the orbits concerned and to define a minimum one.
TABLE 11
Input data
D4.3	Description of the procedure for the determination of minimum uplink simulation time increment
High-level short-term uplink interference would be caused by emissions from a non-GSO earth station during an in-line event (when a GSO SS is in the main beam of a non-GSO earth station antenna). The required number Nhit of epfd↑ measurements should be effected within the period of the GSO satellite staying in the main beam of the non-GSO earth station antenna to ensure acquisition and definition of the in-line event. If the non-GSO earth station were directly below the GSO satellite (see Fig. 36) then the value of the minimum simulation time increment could be calculated using equations (1) and (2). In that case a width of the non-GSO earth station antenna main beam should be taken instead of that of the GSO earth station antenna main beam.
Figure 36
Calculation of epfd(up) time step size
TABLE 12
Input data
D4.4	Description of the procedure for the determination of minimum inter-satellite simulation time increment
The time step size for epfdis calculations is derived by considering that there should be at least Nhit time steps during which the non-GSO satellite is within the main beam of the GSO satellite. Given that the shortest time step is when the beam at the GSO is pointed as far as possible away from the sub-satellite point, and given the following:
Re:	radius of the Earth
h:	height of non-GSO orbit
Rgeo:	radius of geostationary orbit
3dB:	half power beamwidth of GSO beam.
For elliptical orbit systems, calculate the height when the non-GSO satellite crosses the equator, i.e. when  = −  or + such that (+) = 0 or integer multiples of . In addition, it is necessary to consider the minimum operating height, so that the height to use is the maximum of {minimum operating height, height when crossing the equator}.
Then the time step can be calculated using the following algorithm (see Fig. 37).
Figure 37
Geometric parameters involved in the equations
Calculate:
Then calculate the value:
(4)
which can be used in equation (2) to calculate the step size to use.
D4.5	Derivation of Nhit
The time step size is selected to ensure there is sufficient resolution of the epfd within the victim’s main beam. The necessary resolution is driven by the bin size of 0.1 dB and from this the number of steps within the main beam can be derived.
Nhit should be selected so that the highest epfd will be detected in the simulation and identified to be within the right bin. This implies a resolution in the calculations of (0.1 dB)/2 = 0.05 dB.
The greatest error would occur when two-time steps are located equally spaced on either side of the main beam, as in Fig. 38.
Figure 38
Calculation of Nhits
The spacing between samples will be:
The gain pattern within the main beam can be assumed to be parabolic and hence following:
The slope on this curve is:
Hence, Nhit required for a difference in gain of 0.05 dB can be derived as follows:
So:
Therefore for the time step nearest the main beam when:
Then:
This approach can also be used for cross-track sampling, and hence Ntrack = Nhit = 16.
D4.6	Total simulation run time
This section describes the calculation of number of time steps for the epfd↓ and epfd↑ algorithms specified in § D5. The basic approach first considers constellations with repeating and non-repeating ground track separately, where systems that use repeating ground tracks use station keeping to ensure that the satellites follow a single Earth trace. For example there will be minor launch errors and perturbations that would make the orbit drift unless station keeping was used operationally to ensure the track repeats. Administrations therefore must indicate to the BR whether station keeping is used to maintain a single track.
Some constellations have different values for inclination, height, or eccentricity between the planes. In this case, it is assumed that, to maintain coverage, the constellation would be designed so that the separation between planes does not change significantly. For the case of repeating ground tracks, this means that there will be a single repeat period for the constellation. This is the time for all satellites within the constellation to return to the same position relative to the Earth and each, within the constraints of station keeping. For the case of non-repeating ground tracks, there will be a single period for all the orbit planes to process around the equator.
This approach is to be used for constellations with both circular and elliptical orbits with orbit inclination non-zero. For equatorial orbit constellations in which all satellites have the same altitude, then it is sufficient to run for a single repeat period. This can be calculated as follows:
where ws and we are the rotation angular velocities of the satellite and Earth as given in § D2.
Table 13 shows the input parameters used in all other constellation types.
TABLE 13
Input data
In both cases the time step can be calculated using the method described above. The number of time steps should be at least:
Nmin  	NS  /(100 – (maximum % in the Tables of Article 22 of the RR less than 100%))
So, for example, for the 99.999% case the number of steps would be:
D4.6.1	Repeating orbits
For those orbits specified as being repeating, the orbit predictor has to be accurate to ensure repeatability. Thus, there is an option for administrations to specify the exact longitude precession rate with respect to a point mass orbit predictor that ensures the orbit would repeat. The definition and use of this parameter is described in § D6.3.
With this parameter, a simulated orbit would be repeated but in reality there would be a slight drift due to longitudinal station keeping errors. It is expected that station keeping changes within the orbit plane would make no difference and so are not included.
The result should be as shown in Fig. 39.
Figure 39
Track of repeating orbit non-GSO satellite through GSO ES beam
In Fig. 39, it can be seen that the result would be a series of samples within the main beam of the GSO earth station that is sufficiently fine to resolve the main beam, includes station keeping drift and produces sufficient samples to generate the required statistics.
TABLE 14
Input data
Given the following parameters:
Nmin:	minimum number of time steps required for statistical significance
Prepeat:	time period that the constellation repeats (s)
Tstep:	time step (s)
Ntracks:	number of tracks through the main beam, = 16, as specified in § D4.5.
For this case the time step should not exactly divide the constellation repeat period. If:
is an integer, then calculate a revised time step (used in the following equations in place of Tstep) equal to:
Calculate the time period required to get the minimum number of time steps for statistical significance:
This corresponds to the following number of constellation repeats:
Nrep  round (Tsig/Prepeat) to nearest integer above.
The number of repeats of the constellation is the largest of Nrep or Ntracks i.e.:
Nrun    max (Nrep, Ntracks)
Then the total run time is:
Trun  =  Nrun · Prepeat
So the number of time steps is then:
Nsteps  round (Trun/Tstep) to nearest integer below
Trun  =  Nsteps * Tstep
D4.6.2	Non-repeating orbits
In this case the longitudinal spacing between successive ascending node passes must be examined so that there are sufficient tracks within the main beam. The time step size and number of time steps can be used to determine how far a particular orbit will have processed within the run. The same numbers can be used to determine how many time steps are required for the orbit to drift around the equator. The orbit period can then be used to work out the difference between tracks.
The constant that specifies the required number of points within the main beam can be used to specify the number of tracks though the main beam required (i.e. Ntrack  Nhits). If the gap between tracks is too large or too fine (resulting in either insufficient samples or excessive run times respectively) then artificial precession can be used.
It is expected that station keeping drift should cancel out in the long term and so would not be required for these calculations.
The result should be as shown in Fig. 40.
Figure 40
Track of non-repeating orbit non-GSO satellite through GSO ES beam
In Fig. 40, it can be seen that the result would be a series of tracks within the main beam of the GSO earth station that is sufficiently fine to resolve the main beam and produces sufficient samples to generate the required statistics.
TABLE 15
Input data
Two parameters are required:
Spass	longitudinal spacing between successive ascending passes through the equatorial plane
Sreq	required resolution of passes through the equatorial plane based upon GSO earth station beam size.
These are calculated using the following steps:
Step 1:	Using the equations in § D6.3.2, calculate the in radians / second
Step 2:	Convert the  into degrees per minute
Step 3:	Calculate the nodal period of the orbit in minutes using:
Step 4:	Calculate the longitudinal spacing between successive ascending passes through the equatorial plane, S, given the Earth’s rotation rate (e  0.250684 degrees/min):
degrees
The equations above apply to circular orbits. For elliptical orbit systems where the calculations above would be significantly different, the value of Spass should be supplied by the administration.
Step 5:	From the GSO earth station beamwidth and height, Sreq can be calculated using equation (3):
Step 6:	Calculate the number of orbits to fully populate around the equator, taking into account that each plane has ascending and descending nodes:
Step 7:	Round Norbits to next highest integer.
Step 8:	Calculate total angle orbit has rotated round during this time:
Step 9:	Calculate the number of multiples of 360 that this corresponds to, rounding to nearest integer below:
Step 10:	Calculate the separation between planes that this corresponds to:
Step 11:		To ensure that the orbit drifts with the required precession rate, the following additional artificial precession should be included:
degrees/orbit
or:
degrees/s
Step 12:		Part D gives more information on how this parameter is used. The total run time is then the time to process around the equator using the orbit period from either §§ D6.3.1 or D6.3.2 depending upon or bit model, namely:
T’run    Tperiod · Norbits
Step 13:		The total number of time steps is then:
Nsteps    Round (T’run / Tstep) to nearest integer below
Trun    Nsteps *  Tstep.
D4.7	Dual time step option
D4.7.1	Dual time step option epfd(down)
In order to improve simulation performance an option to the algorithm is to implement two time steps. A coarse time step would be used except when any non-GSO satellite is near the main beam of the GSO ES or edge of exclusion zone, defined as:
GRX() > min[Gmax − 30 dB, GRX(0[Latitude]])
Figure 41 shows where to use the finer time step:
Figure 41
Use of fine time step when at with GSO ES main beam
A coarse step size is used for non-critical regions far from the GSO earth station main beam. This step size is defined as a topocentric angle:
This coarse step size is used for all antenna beamwidths and all non-GSO systems.
The size of the coarse step needs to be an integer multiple of fine steps for statistical purposes. Since the coarse step size is constant, the ratio of coarse steps to fine steps is dependent only upon the beamwidth of the GSO earth station (3dB). This ratio is defined as:
where floor is a function that truncates the decimal part of the ratio and outputs the integer part of the ratio. This produces a conservative ratio of fine steps to coarse steps to ensure that a coarse step is never larger than the target topocentric size of 1.5°.
D4.7.2	Dual time step option epfd(up)
In order to improve simulation performance an option to the algorithm is to implement two-time steps. A coarse time step would be used except when the gain from any non-GSO ES towards the GSO satellite is greater than −30 dB.
A coarse step size is used for non-critical regions when the non-GSO earth station main beam is pointing away from the GSO satellite. This step size is defined as a topocentric angle:
This coarse step size is used for all antenna beamwidths and non-GSO systems.
The size of the coarse step needs to be an integer multiple of fine steps for statistical purposes. Since the coarse step size is constant, the ratio of coarse steps to fine steps is dependent only upon the beamwidth of the non-GSO earth station (3dB). This ratio is defined as:
where floor is a function that truncates the decimal part of the ratio and outputs the integer part of the ratio. This produces a conservative ratio of fine steps to coarse steps to ensure that a coarse step is never larger than the target topocentric size of 1.5 degrees.
D5	epfd calculation description
D5.1	epfd↓ software description
This section describes the algorithm to calculate the epfd↓ from a non-GSO constellation into a GSO downlink. It is assumed that each non-GSO satellite has a pfd mask. From the pfd for each satellite the aggregate epfd↓ at an earth station of a GSO system is calculated. This is repeated for a series of time steps until a distribution of epfd↓ is produced. This distribution can then be compared with the limits to give a go/no go decision.
Figure 42 shows the geometry with constellation of non-GSO satellites and test GSO satellite transmitting to a GSO earth station.
Figure 42
Example of epfd(down) scenario
D5.1.1	Configuration parameters
These run definition parameters are:
D5.1.2	Non-GSO system parameters
The following parameters, as specified in § B3.1 would be used.
For each satellite the following parameters specified in § B3.2 would be used, where the definitions of the parameters are specified in § D6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite. For the pfd mask it indicates that the pfd data is structured in such a way that the pfd[N] entry is a reference that points to a particular sub-set. For example each satellite in the constellation could reference the same pfd(lat, az, el), pfd(lat, X, long), or pfd(lat, , long) table.
D5.1.3	Run time step parameters
The following run parameters should be calculated using the algorithm in § D4:
The time step and statistics take account of the time windows as shown in Fig. 43.
Figure 43
Run time, fine and course time steps and time windows
The following are calculated in § D4:
–	Run duration
–	Fine time step
–	Course time step.
In the case that the non-GSO satellite selection method is defined by track duration (e.g. for the MIN_DURATION [Latitude] to be non-zero for at least one latitude), then it is also necessary to consider a set of time windows to ensure all combinations of satellite selection are analysed.
The MIN_DURATION is provided for the constellation (possibly dependent upon latitude, which in this case of the ES). The length of the time window in fine time steps is calculated as the integer ratio of this track duration divided by fine time step size. The MIN_SLIDING_TIME is also calculated as an integer number of fine time steps.
The minimum sliding time is:
Where MinimumOrbitalPeriod is the smallest orbit period over all sub-constellations.
The run duration is derived in § D4 so that the constellation has returned to the initial conditions and hence statistics are complete. This could require that the last time window is only partially included: i.e. only those time steps within the run duration would be included in the epfd statistics. However the simulation would continue until the time window is complete to determine the satellites to track. In addition, as each window starting time is offset it is necessary to run for other windows additional steps beyond that used by the first-time window.
The length of the sliding window in number of fine time steps is:
NSW = RoundDown(MIN_DURATION / Tfine)
The number of fine time steps for the MIN_SLIDING_TIME can be calculated as:
NMSL = RoundUp(MIN_SLIDING_TIME / Tfine)
The number of time windows to use in the calculations is then:
NTW = RoundUp(Nsw / NMSL)
The number of repeats of the time window for the run duration is then:
NRepeat = RoundUp(Nstep / NSW)
The total number of fine time steps required to simulate is the run duration plus the time required to complete all the time windows, namely:
NTotalSteps = Nrepeat * NSW + (NTW  – 1) * NMSL
The total run duration required to get all the sliding windows to complete is then:
TTotalDuration = NTotalSteps * Tfine
D5.1.4	Algorithms and calculation procedures
In the case that the non-GSO satellite selection method is defined by track duration (e.g. for the MIN_DURATION [Latitude] to be non-zero for at least one latitude) then the algorithm and calculation procedures are as in § D5.1.4.2, otherwise they are as in § D5.1.4.1.
The operating non-GSO satellites are those outside the exclusion zone, above their minimum operating elevation angle and transmitting towards (i.e. height above or equal to MIN_OPERATING_HEIGHT) the GSO earth station. The maximum number of operating non-GSO satellites is the maximum number of non-GSO satellites allowed to transmit co-frequency towards the same area on the ground.
D5.1.4.1	Algorithms and calculation procedures when not using track duration
To calculate epfd↓ values from a non-GSO system that is not using the track duration into one GSO system earth station the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required.
Step 1:	Read in parameters for non-GSO system as specified in § D5.1.2.
Step 2:	Read in GSO parameters as specified in § D5.1.1.
Step 3:	If required, calculate the maximum epfd GSO location using the algorithm in § D3.1 otherwise use the GSO satellite and ES location requested.
Step 4:	Calculate the number of time steps and time step size using algorithm in § D4 and hence calculate end time.
Step 4bis:	Initialize statistics by zeroing all bins of epfd↓ values.
Step 5:	If a dual time step algorithm is included then use Sub-step 5.1, otherwise Ncoarse = 1 all the time.
Sub-step 5.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 6:	If a dual time step algorithm is included then repeat Sub-step 6.1 to Step 22 until end time is reached, otherwise repeat Steps 7 to 22 until end time is reached.
Sub-step 6.1:	If it is the first time step then set Tstep = Tfine.
Sub-step 6.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 6.3:	Otherwise, if any of the GRX() for the last time step were within 30 dB of peak then set Tstep = Tfine; otherwise, set Tstep = Tcoarse.
Step 7:	Update position vectors of all earth stations based on coordinate system in § D6.1.
Step 8:	Update position vectors of all GSO satellites based on coordinate system in § D6.2.
Step 9:		Update position and velocity vectors of all non-GSO satellites based on coordinate system, orbit prediction model and station keeping algorithm in § D6.3.
Step 10:		Set epfd↓ = 0.
Step 11:		Select all non-GSO satellites visible to the GSO earth station using the algorithm in § D6.4.1.
Step 12:	 	Repeat Steps 13 to 18 for each visible non-GSO satellite.
Step 13:		Calculate the parameters required by the pfd mask, either (lat, , long) or (lat, azimuth, elevation) as required, using the definition of angles in § D6.4.4 or § D6.4.5.
Step 13bis:	Calculate the (AzimuthNGSO, NGSO) of the non-GSO satellite as seen at the GSO ES location using the definition of angles in § D6.4.4.
Step 14:		Using the pfd mask for the selected non-GSO satellite, calculate pfd(lat, , long) or pfd(lat, azimuth, elevation) at the GSO earth station using the non-GSO satellite pfd mask as specified in § D5.1.5.
Step 15:		Calculate the off-axis angle  at GSO earth station between line to the GSO satellite and the non-GSO satellite.
Step 16:		Calculate GRX() = Receive gain (dB) at GSO earth station using relevant gain pattern specified in algorithms in § D6.5.
Step 17:		Calculate epfd↓i for this non-GSO satellite using:
epfd↓i = pfd + GRX() – Gmax
where Gmax is the peak gain of the GSO earth station antenna.
Step 18:		Store the epfd↓i entries for each satellite that:
•	either has an  ≥ 0[latitude] for that satellite and has an NGSO ≥ 0[latitude][AzimuthNGSO]
•	or for which GRX() > min[Gmax − 30 dB, GRX(o[Latitude]])
Step 19:		Repeat Steps 20 and 21 for each time step as long as no more than MAX_CO_FREQ[lat] satellites are included in Step 23.
MAX_CO_FREQ[lat] is the maximum number of operating non-GSO satellites at the latitude of GSO_ES considered corresponding to the maximum number of satellites allowed to transmit at the same frequency towards the same area on the ground, fulfilling the GSO exclusion zone, the minimum elevation angle and the MIN_ANGLE_AT_ES requirements as defined for the non-GSO system.
Step 20:	 	Apply Step 23 for the satellite which has an  ≥ 0[latitude] and an NGSO ≥ 0[latitude][AzimuthNGSO] and with the highest single epfd↓i.
Step 21: 	If the MIN_ANGLE_AT_ES between non-GSO satellites has been specified, then remove the non-GSO satellites from those in Step 18 which have an  ≥ 0[latitude] and an NGSO ≥ 0[latitude][AzimuthNGSO] that do not meet this criterion with respect to the satellite used in Step 20.
Step 22: 	Repeat Step 23 for those satellites for which GRX() > min[Gmax − 30 dB, GRX(o[Latitude]]).
Note:		There should be no double-counting of satellites in Step 23. In particular, if a satellite is on the list of the highest MAX_CO_FREQ[lat] satellites and also for which GRX() > min[Gmax − 30 dB, GRX(o[Latitude]]) it should be included only once as part of the MAX_CO_FREQ[lat] satellites in Step 20.
Step 23:		Increment epfd↓ by the epfd↓i value in linear.
Step 24:		Increment epfd↓ statistics by epfd↓ for this time step by (Tstep/Tfine) entries.
Step 25:		Generate the epfd↓ CDF from the epfd↓ PDF using the algorithm in § D7.1.2.
Step 26:		Compare epfd↓ statistics with limits using the algorithm in § D7.1.
Step 27:		Output results in format specified in § D7.3.
D5.1.4.2	Algorithms and calculation procedures when using track duration
To calculate epfd↓ values from a non-GSO system that is using the track duration into one GSO system earth station the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required.
Step 1:		Read in parameters for non-GSO system as specified in § D5.1.2.
Step 2:		Read in GSO parameters as specified in § D5.1.1.
Step 3:		If required, calculate the maximum epfd GSO location using the algorithm in § D3.1 otherwise use the GSO satellite and ES location requested.
Step 4:		Calculate the number of time steps and time step size using algorithm in § D4 and hence calculate end time. As described in § D5.1.3, adjust the MIN_SLIDING_TIME and MIN_DURATION to be an integer number of fine time step and hence calculate the NUM_SLIDE_WINDOWS. Increment the run duration by the integer number of fine time steps so that all sliding windows will have complete statistics.
Step 4bis:	Initialize statistics by zeroing all bins of epfd↓ values for each of the NUM_SLIDE WINDOWS.
Step 5:		If a dual time step algorithm is included then use Sub-step 5.1, otherwise Ncoarse = 1 all the time.
Sub-step 5.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 6:		If a dual time step algorithm is included then repeat Sub-step 6.1 to Step 22 until end time is reached, otherwise repeat Steps 7 to 22 until end time is reached.
Sub-step 6.1:	If it is the first time step then set Tstep = Tfine.
Sub-step 6.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 6.3:	Otherwise, if any of the GRX() for the last time step were within 30 dB of peak then set Tstep = Tfine; otherwise, set Tstep = Tcoarse.
Step 7:		Update position vectors of all earth stations based on coordinate system in § D6.1.
Step 8:		Update position vectors of all GSO satellites based on coordinate system in § D6.2.
Step 9:		Update position and velocity vectors of all non-GSO satellites based on coordinate system, orbit prediction model and station keeping algorithm in § D6.3.
Step 10:		Set epfd↓ = 0.
Step 11:		Select all non-GSO satellites visible to the GSO earth station using the algorithm in § D6.4.1.
Step 12:		Repeat Steps 13 to 18 for each visible non-GSO satellite.
Step 13:		Calculate the parameters required by the pfd mask, either (lat, , long) or (lat, azimuth, elevation) as required, using the definition of angles in § D6.4.4 or § D6.4.5.
Step 13bis:	Calculate the (AzimuthNGSO, NGSO) of the non-GSO satellite as seen at the GSO ES location using the definition of angles in § D6.4.4.
Step 14:		Using the pfd mask for the selected non-GSO satellite, calculate pfd(lat, , long) or pfd(lat, azimuth, elevation) at the GSO earth station using the non-GSO satellite pfd mask as specified in § D5.1.5.
Step 15:		Calculate the off-axis angle  at GSO earth station between line to the GSO satellite and the non-GSO satellite.
Step 16:		Calculate GRX() = Receive gain (dB) at GSO earth station using relevant gain pattern specified in algorithms in § D6.5.
Step 17:		Calculate epfd↓i for this non-GSO satellite using:
epfd↓i = pfd + GRX() – Gmax
where Gmax is the peak gain of the GSO earth station antenna.
Step 18:		Store the epfd↓i entries for each satellite that:
•	either has an  ≥ 0[latitude] for that satellite and has an NGSO ≥ 0[latitude][AzimuthNGSO]
•	or for which GRX() > min[Gmax − 30 dB, GRX(0[Latitude]])
Step 19:		If a window is closing this time step then identify which non-GSO satellites met the 0, 0 constraints for the full duration of the window.
Step 19bis:	For each of those satellites that met the 0, 0 constraints for the full duration of the window, calculate the highest epfd↓[nSat] over the time window and sort this list of satellites by maximum epfd↓[nSat] per satellite.
Step 20:		Repeat Steps 21 and 22 for each time step in the window for the MAX_CO_FREQ[lat] satellite’s epfd↓[nSat] contributions on this list plus those satellites for which GRX() > min[Gmax − 30 dB, GRX(0[Latitude]]), where MAX_CO_FREQ[lat] is the maximum number of operating non-GSO satellites at the latitude of GSO_ES considered corresponding to the maximum number of satellites allowed to transmit at the same frequency towards the same area on the ground, fulfilling the GSO exclusion zone and minimum elevation angle requirements as defined by for the non-GSO system.
Note: There should be no double-counting of satellites in Step 21. In particular, if a satellite is on the list of the highest MAX_CO_FREQ[lat] satellites and also for which GRX() > min[Gmax − 30 dB, GRX(0[Latitude]]) it should be included only once as part of the MAX_CO_FREQ[lat] satellites in Step 21.
Step 21:		Increment epfd↓ by the epfd↓i value in linear.
Step 22:		Increment epfd↓ statistics for the relevant slide window by epfd↓ for this time step by (Tstep/Tfine) entries. If last time step was a course time step and the window closed during that time step, then the epfd↓ statistics should be updated by that part of Tstep that was in the window and the remaining part stored for the following window. If the run since start time for this slide window exceeds the run duration then only include that part of the time window that is within the run duration in the statistics.
Step 23:		Generate the epfd↓ CDF for all slide windows from the epfd↓ PDF using the algorithm in § D7.1.2.
Step 24:		Compare epfd↓ statistics for all slide windows with limits using the algorithm in § D7.1.
Step 25:		Output results in format specified in § D7.3.
D5.1.5	pfd mask calculation
The pfd mask is defined as a table of pfd values for various angles and latitudes.
Note that the latitude range should be:
Minimum:	–i
Maximum:	+i
where i is the inclination of the non-GSO satellite’s orbit.
In general, the (azimuth, elevation) or (,long) angles calculated at each time step will be between two values in the arrays. In this case bilinear interpolation between pfd values should be used with equations:
where:
And (x, y) are the two dimensions of the pfd mask.
If the angles are outside the pfd mask, the software calculates pfd from the highest angle in the mask (i.e. at the mask edge).
The mask that is closer in latitude to that of the reference satellite should be used. Part C gives more information about the format and sampling of the pfd mask.
D5.1.6	Outputs
The result of the algorithm is two arrays in format:
where PC_CALC[I] is the percentage of time epfd_DOWN_CALC[I] is exceeded.
D5.2	epfd↑ software description
This section describes the algorithm to calculate epfd↑ from non-GSO earth stations into a GSO uplink. The locations of the ES can be defined in one of two ways:
1)	It is assumed that the Earth is populated with a uniform distribution of non-GSO earth stations. In this case the ES_ID in the e.i.r.p. mask should be set to −1.
2)	The locations of specific ES are used via a field in the ES e.i.r.p. mask. In this case the density field is not used.
Each earth station points towards a non-GSO satellite using pointing rules for that constellation, and transmits with a defined e.i.r.p. From the e.i.r.p. and off-axis gain pattern for each earth station, the epfd↑ at the GSO can be calculated. This is repeated for a series of time steps until a distribution of epfd↑ is produced. This distribution can then be compared with the limits to give a go/no go decision.
Figure 44 shows the geometry with population of non-GSO earth stations transmitting to a constellation of non-GSO satellites, together with a test GSO satellite receiving from a GSO earth station.
Figure 44
Example of epfd(up) scenario
D5.2.1	Configuration parameters
This sub-section specifies the parameters required for all epfd↑ calculations defined in the RR. This would be a data-set of N sets of limits that can be shared between runs. The Table could be queried so that the required values can be used depending upon non-GSO system frequency.
For each set of limits the following would be defined as generated by in § D2.1.
D5.2.2	Determination of maximum epfd configuration
The maximum epfd location of the GSO satellite and beam centre is defined in § D3.2.
D5.2.3	Calculation of run steps
The time step and number of time steps are calculated using the algorithm in § D4 which also describes the optional dual time step option.
D5.2.4	Inputs
D5.2.4.1	Input parameters
This section defines the input parameters for a particular non-GSO system scenario. In this case, input is a generic term that could include files or user input. Information is required for:
–	non-GSO system;
–	GSO system;
–	run configuration.
D5.2.4.2	Non-GSO system parameters
The following parameters, as specified in § B3.1 would be used:
For each satellite the following parameters specified in § B3.2, would be used, where the definitions of the parameters are specified in § D6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite.
Each satellite must have an independent set of six orbital parameters for orbit definition and subsequent propagation.
To define the characteristics of non-GSO earth stations, the following parameters, as specified in § B4.2 would be used:
Note that the minimum track duration is not used for the epfd(up) case.
D5.2.4.3	GSO system parameters
The GSO system can be either calculated or use worst-case parameters using the algorithm in § D3.2 or entered values. The required parameters as specified are:
These parameters are defined in §§ D6.1 and D6.2.
D5.2.4.4	Run parameters
The following run parameters should be calculated using the algorithm in § D4:
D5.2.5	Production of non-GSO earth station distribution
In the case that the non-GSO ES locations are defined by a distribution, the following method should be used:
Step 1:	Calculate the number of actual operating non-GSO earth stations that the representative earth station will represent using:
NUM_ES = ES_DISTANCE * ES_DISTANCE * ES_DENSITY
Step 2:	Calculate e.i.r.p. to use for each representative non-GSO earth station using:
REP_e.i.r.p. = ES_e.i.r.p. + 10log10(NUM_ES)
Step 3:	Define the GSO service area as the region enclosed by the contour representing a relative gain of 15 dB.
Step 4:	For every distance ES_DISTANCE in latitude and distance ES_DISTANCE in longitude within the service area defined in Step 3, locate a representative non-GSO earth station with radiating with REP_e.i.r.p.
If the supplied ES_DISTANCE is zero, then in Step 1 set NUM_ES = 1 and at Step 4 locate a single non_GSO ES at the boresight of the GSO satellite.
The NUM_ES is typically 1 for TDMA and FDMA systems and for CDMA systems equal to the number of co-frequency ES all operating on the same frequency at the same time and location. The ES_DISTANCE relates to the average distance between co-frequency beams.
The deployment method should be symmetric around the (latitude, longitude) of the GSO satellite’s boresight, as shown in Fig. 45.
Figure 45
Deployment method for non-GSO earth stations
No non-GSO ESs should be deployed below the minimum latitude or above the maximum latitude, where these two extreme values are derived using the methodology in § D3.2.3.
The separation in latitude in radians between non-GSO ES can be calculated from the distance using:
The separation in longitude in radians between non-GSO ES can be calculated using:
D5.2.6	Algorithms and calculation procedures
To calculate epfd↑ values from one non-GSO system into one GSO system satellite the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required:
Step 1:	Read in parameters for non-GSO system as specified in § D5.2.4.2.
Step 2:	Read in GSO parameters as specified in § D5.2.4.3.
Step 3:	If required calculate maximum epfd GSO location using the algorithm in § D3.2 otherwise use the GSO satellite and ES location requested.
Step 4:	If required calculate locations of non-GSO earth stations using the algorithm in § D5.2.5.
Step 5:	Initialize statistics by zeroing all bins of epfd↑ values.
Step 6:	If required calculate number of time steps and time step size using the algorithm in § D4 and hence calculate end time.
If a dual time step algorithm is included then use Sub-step 6.1, otherwise Ncoarse  1 all the time.
Sub-step 6.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 7:	Repeat Steps 8 to 24 for all time steps.
If a dual time step algorithm is included, then repeat Sub-step 7.1 to Step 22 until end time is reached.
Sub-step 7.1:	If it is the first-time step then set Tstep = Tfine.
Sub-step 7.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 7.3:	Otherwise if any of the  angles for the last time step were within coarse of the exclusion zone angle then set the Tstep = Tfine; otherwise, use Tstep = Tcoarse.
Step 8:	Update position vectors of all earth stations using algorithm in § D6.1.
Step 9:	Update position and velocity vectors of all non-GSO satellites using algorithm in § D6.3.2.
Step 10:		Update position vectors of GSO satellite using algorithm in § D6.2.
Step 11:		Initialise a list of possible links comprising triples of {non-GSO satellite, non-GSO ES, epfd↑I } to be an empty list.
Step 12:		Set the counter of times each satellite is used to zero for all satellites.
Step 13:		Set the counter of times each non-GSO ES is used to zero for all non-GSO ES.
Step 14:		Repeat Steps 15 to 24 for all non-GSO earth stations.
Step 15:		Determine if this non-GSO earth station is visible to the GSO satellite using the algorithm in § D6.4.1.
Step 16:		If the non-GSO earth station is visible to the GSO satellite then do Steps 17 to 24.
Step 17:		For all non-GSO satellites repeat Steps 18 to 24.
Step 18:		If this non-GSO satellite is a) visible to the non-GSO ES and b) above the minimum elevation angle 0[latitude][AzimuthNGSO] at the non-GSO for this latitude and the non-GSO satellite’s azimuth and c) outside the exclusion zone for this latitude 0[latitude], undertake Steps 19 to 24.
Step 19:		Calculate ES_e.i.r.p.[lat] (dB(W/BWraf)) of non-GSO earth station at its given latitude in direction of GSO satellite using non-GSO earth station e.i.r.p. mask in § C3.
REP_e.i.r.p. = ES_e.i.r.p.[lat, off-axis angle] + 10log10 (NUM_ES)
Step 20:		Calculate GRX = receive relative gain (dB) at GSO satellite using relevant gain pattern specified in the algorithms in § D6.5.
Step 21:		Calculate D = distance (km) between the non-GSO earth station and the GSO satellite using the algorithm in § D6.4.1.
Step 22:		Calculate the spreading factor LFS = 10log(4D2) + 60.
Step 23:		Calculate epfd↑i for this non-GSO satellite:
epfd↑i = REP_e.i.r.p. – LFS + GRX – Gmax
Step 24:		Add to the list of possible links this {non-GSO Satellite, non-GSO ES, epfd↑i }.
Step 25:		Sort the list of possible links by epfd↑i with the highest epfd↑i at the top.
Step 26:		Set epfd↑ = 0.
Step 27:		If the list of possible links is empty jump to Step 35 otherwise repeat Steps 28 to 34 for the link {non-GSO satellite, non-GSO ES, epfd↑i } on the list of possible link with the highest epfd↑i
Step 28:		Increment the epfd↑ by this link’s epfd↑i
Step 29: 	Increment the counter of the number of times this link’s non-GSO satellite has been used.
Step 30:		If this non-GSO satellite counter is equal to MAX_CO_FREQ_SAT then remove all remaining links on the list of possible links that use this non-GSO satellite.
Step 31: 	Increment the counter of the number of times this link’s non-GSO ES has been used.
Step 32:		If this non-GSO ES counter is equal to MAX_CO_FREQ then remove all remaining links on the list of possible links that use this non-GSO ES.
Step 33:		If the MIN_ANGLE_AT_ES is non-zero, then remove all links from the list that have an angle at the ES to this link’s non-GSO satellite is less than MIN_ANGLE_AT_ES.
Step 34:		If the MIN_ANGLE_AT_SAT is non-zero, then remove all links from the list that have an angle at the satellite to this link’s non-GSO satellite is less than MIN_ANGLE_AT_SAT.
Step 35:		Increment epfd↑ statistics by this epfd↑.
If a dual time step algorithm is included, then the step below should be used:
Sub-step 35.1:	Increment epfd↑ statistics by the epfd↑ for this time step by Tstep/Tfine entries.
Step 36:		Generate the epfd↑ CDF from the epfd↑ pdf using the algorithm in § D7.1.2.
Step 37:		Compare epfd↑ statistics with limits using the algorithm in § D7.1.
Step 38:		Output results in format specified in § D7.2.
D5.2.7	Calculation of e.i.r.p.
If the ES_e.i.r.p. mask is of the form ES_e.i.r.p.(lat)() then find the table with the nearest latitude to the non-GSO ES under consideration, and then use that to undertake linear interpolation in ES_e.i.r.p. against the off-axis angle at the non-GSO ES towards the GSO satellite.
If the ES_e.i.r.p. mask is of the form ES_e.i.r.p.(lat)(az)(el)(DeltaLongES) then find the table with the nearest latitude to the non-GSO ES under consideration. Within that table, find the (az)(el) array with the smallest angular offset to the (azimuth, elevation) of the non-GSO satellite as seen by the non-GSO ES. Use that array to undertake linear interpolation in ES_e.i.r.p. against the difference in longitude between the non-GSO ES and the GSO satellite.
D5.2.8	Outputs
The result of the algorithm is two arrays of size Nepfd↑ in format:
where PC_CALC[I] is the percentage of time epfd_UP_CALC[I] is exceeded.
D5.3	epfdis software description
This section describes the algorithm to calculate epfdis from non-GSO space stations into a GSO uplink. From the e.i.r.p. and off-axis angle for each space station, the epfdis at the GSO space station can be calculated. This is repeated for a series of time steps until a distribution of epfdis is produced. This distribution can then be compared with the limits to give a go/no go decision.
D5.3.1	Configuration parameters
This sub-section specifies the parameters required for all epfdis calculations. This would be a data-set of N sets of limits that can be shared between runs. The Table could be queried so that the required values can be used depending upon non-GSO system frequency.
For each set of limits the following would be defined as derived in § D2.1.
D5.3.2	Determination of maximum epfd configuration
The maximum epfd location of GSO satellite and beam centre is defined in § D3.3.
D5.3.3	Calculation of run steps
A single time step and number of time steps are calculated using the algorithm in § D4.
D5.3.4	Input parameters
This sub-section defines the input parameters for a particular non-GSO system scenario. In this case, input is a generic term that could include files or user input. Information is required for:
–	non-GSO system;
–	GSO system;
–	run configuration.
D5.3.4.1	Non-GSO system parameters
The following parameters, as specified in § B2.1 would be used:
For each satellite the following parameters specified in § B2.1 would be used, where the definitions of the parameters are specified in § D6.3.1 at the time of the start of the simulation.
Note that in the Table below, the indices [N] are present to indicate that there would be a different value for each satellite, and the N-th value corresponds to the N-th satellite.
Each satellite must have an independent set of six orbital parameters for orbit definition and subsequent propagation.
To define the characteristics of non-GSO space stations, the following parameters, as specified in § B4.3 would be used:
D5.3.4.2	GSO system parameters
The GSO system can either use worst-case parameters using the algorithm in § D5.2 or entered values. The required parameters are:
These parameters are defined in §§ D6.1 and D6.2.
D5.3.4.3	Run parameters
The following run parameters should be calculated using the algorithm in § D4:
D5.3.5	Algorithms and calculation procedures
In the calculation of the dual time step for the epfdis computation, Ncoarse = 1.
To calculate epfdis values from one non-GSO system into one GSO system satellite the following algorithm should be used. The algorithm can be used on multiple GSO systems in parallel if required:
Step 1:	Read in parameters for non-GSO system as specified in § D5.3.4.2.
Step 2:	Read in GSO parameters as specified in § D5.3.4.3.
Step 3:	If required calculate worst-case GSO location using algorithm in § D3.3.
Step 4:	Initialize statistics by zeroing all bins of epfdis values.
Step 5:	If required calculate number of time steps and time step size using algorithm in § D4 and hence calculate end time.
If a dual time step algorithm is included then use Sub-step 5.1, otherwise Ncoarse = 1 all the time.
Sub-step 5.1:	Calculate coarse step size Tcoarse = Tfine * Ncoarse.
Step 6:	Repeat Steps 7 to 19 for all time steps.
If a dual time step algorithm is included, then repeat Sub-step 6.1 to Step 17 until end time is reached.
Sub-step 6.1:	If it is the first-time step then set Tstep = Tfine.
Sub-step 6.2:	Otherwise if there are less than Ncoarse steps remaining then set Tstep = Tfine.
Sub-step 6.3:	Otherwise, if any of the α angles for the last time step were within coarse of the exclusion zone angle then set the Tstep = Tfine; otherwise, use Tstep = Tcoarse.
Step 7:	Update position and velocity vectors of all non-GSO satellites using algorithm in § D6.3.
Step 8:	Update position vectors of GSO satellite using algorithm in § D6.2.
Step 9:	Set epfdis = 0.
Step 10:	Repeat Steps 10 to 18 for all non-GSO space stations.
Step 11:	Determine if this non-GSO space station is visible to the GSO satellite using the algorithm in § D6.4.1.
Step 12:	If the non-GSO space station is visible to the GSO satellite then do Steps 13 to 18.
Step 13:	Calculate e.i.r.p. (dB(W/BWrif)) of non-GSO space station in direction of GSO satellite using the e.i.r.p. mask in § C3 for the non-GSO space station’s latitude.
Step 14:	Calculate GRX = receive relative gain (dB) at GSO satellite using relevant gain pattern specified in algorithms in § D6.5.
Step 15:	Calculate D = distance (km) between the non-GSO space station and the GSO satellite using the algorithm in § D6.4.1.
Step 16:	Calculate the spreading factor LFS = 10 log(4 D2) + 60.
Step 17:	Calculate epfdisi for this non-GSO satellite:
epfdisi = e.i.r.p. – LFS + GRX – Gmax
Step 18:	Increment epfdis by epfdisi.
Sub-step 19:	Increment epfdis statistics by this epfdis.
If a dual time step algorithm is included then the step below should be used:
Sub-step 19.1:	Increment epfdis statistics by the epfdis for this time step by Tstep/Tfine entries.
Step 20:	Generate the epfdis CDF from the epfdis pdf using the algorithm in § D7.1.2.
Step 21:	Compare epfdis statistics with limits using algorithm in § D7.1.
Step 22:	Output results in format specified in § D7.2.
D5.3.6	Outputs
The result of the algorithm is two arrays in format:
where PC_CALC[I] is percentage of time epfd_IS_CALC[I] is exceeded.
D6	Geometry and algorithms
This section describes the geometry that defines the core algorithms used in the software. One aspect is the conversion into a generic cartesian vector-based coordinate system. The precise orientation of the X vector is not specified in this Recommendation to allow alternative implementations by developers. The axis chosen should not impact the results as satellite and Earth coordinates are defined relative to the Earth.
To aid developers examples coordinate systems are used to show how to convert to and from generic vectors.
D6.1	Earth coordinates system
Figure 46 shows the reference coordinate system for earth stations.
Figure 46
Definition of latitude
The Earth is defined as a sphere with radius as specified in § A2.2 = Re. The Earth rotates around an axis, the Z axis, at a rate defined in § A2.2 = e. Perpendicular to the Z axis, crossing the Earth at the Equator, is the XY plane.
Earth stations are located on this sphere based upon two angles:
Latitude: angle between line from centre of Earth to earth station and XY plane;
Longitude: angle as shown in Fig. 47.
Figure 47
Definition of longitude
Earth stations are assumed to have constant (latitude, longitude) positions in time.
The orientation within the XY plane of the X and Y axes is not specified in this Recommendation as all locations are referenced to the Earth rather than one particular inertial frame. This allows different implementations to use different reference points if required without impacting on the results.
One possible implementation is what is described as the geocentric inertial system. For this example case, conversion from geographic coordinates is achieved using:
if y  0	(5)
if y  0	(6)
(7)
If this example coordinate system is used, then the conversion from geographic coordinates into geocentric inertial system coordinates is:
x = Re cos(lat) cos(long)	(8)
y = Re cos(lat) sin(long)	(9)
z = Re sin(lat)	(10)
where:
(x, y, z):	coordinates in the geocentric inertial system
long:	geographic longitude
lat: 	geographic latitude.
In this example geocentric inertial reference system, the equation for motion of a mass point on the Earth’s surface would be as:
(11)
where:
lat:	geographic latitude of the mass point on the Earth’s surface
lon:	geographic longitude of the mass point on the Earth’s surface
t:	time
e:	angular rate of rotation of the Earth.
D6.2	GSO satellite coordinate system
The geostationary arc is a circle in the XY plane at a distance of Rgeo from the Earth’s centre where Rgeo is specified in § A2.2. Individual geostationary satellites have location on this circle defined by a longitude as shown in Fig. 48.
Figure 48
Definition of GSO satellite longitude
Geostationary satellites are assumed to have constant longitude in time. The conversion to and from vectors can use the same algorithms as in the section above by setting the latitude to zero.
D6.3	Non-GSO satellite coordinate system
D6.3.1	Non-GSO satellite orbit parameters
This section defines the parameters that specify an orbit for non-GSO satellites. Non-GSO satellites move in a plane as shown in Fig. 49.
Figure 49
Orbit plane angles
The plane of the orbit is referenced to the Earth by two angles:
:	longitude of ascending node: This defines where the ascending orbit plane intersects the equatorial plane. As the orbit is fixed in inertial space while the Earth rotates, a time reference for which this angle is valid must be given. In this case it is the start of the simulation
i:	inclination angle: This is defined as the angle between the plane of the orbit and the equatorial plane.
The orbit and position of the non-GSO satellite within the orbit is then defined by further parameters as shown in Fig. 50.
Figure 50
Definition of non-GSO satellite in-plane angles
The shape of the orbit is defined by:
a = (Ra + Rp)/2	(12)
e = (Ra – Rp) / (Ra + Rp)	(13)
where:
a:	semi-major axis
e:	eccentricity
Ra:	distance from the centre of the Earth to the satellite at apogee
Rp:	distance from the centre of the Earth to the satellite at perigee.
The position of the perigee within the orbit plane is defined by:
:	argument of perigee, angle between the line of the nodes and perigee.
The position of a non-GSO satellite within the plane at a particular time is defined by:
v0:	angle between perigee and specified point on orbit.
For circular orbits,  can be set to zero and v0 assumed to be the same as the argument of latitude defined as:
(14)
Other useful terms are:
(15)
(16)
(17)
(18)
(19)
where:
p:	focal parameter
E:	eccentric anomaly
M:	mean anomaly
T:	period of orbit
R:	distance from centre of Earth to satellite when satellite is at position .
These can be used by the algorithm to predict the future position of the non-GSO satellite as described in § D5.
D6.3.2	Non-GSO satellite orbit predictor
Given the orbital elements in the section above, standard orbit mechanics can be used to predict the position of the satellite at future times. In addition there are three additional precession factors for the ascending node and argument of perigee as described below.
Line of nodes
(20)
where:
J2 = 	0.001082636
Orbit precession in ascending node longitude
The rate of ascending node longitude secular drift is defined as:
(21)
It follows from the above that polar orbits have zero precession rate and equatorial ones have a maximum precession rate. With direct satellite motion (i  90°) the ascending node shifts to the west (to  decreasing) and with reverse satellite motion (i  90°) it shifts to the east (to  increasing).
Perigee argument precession
Perigee argument secular shift rate is defined as:
(22)
Perigee argument precession rate at i = 0 and i = 180 is maximum. For i1 = 63 26' 06'' or i2 = 116° 33' 54'' the precession rate is zero. If i  i1 or i  i2, then the perigee precession is along a satellite motion direction, and if i1  i  i2, then it is in the opposite direction.
Use of precession terms
Perigee argument is defined as:
ω = ω0 + ωrt	(23)
where:
0:	perigee argument at an initial moment
r:	perigee argument precession rate.
A current value of an ascending node longitude is defined as:
Ω = Ω0 + Ωrt	(24)
where:
0:	ascending node longitude at an initial moment
r:	ascending node longitude precession rate.
The revised orbit period is then:
(25)
The conversion to generic cartesian-based vector would depend upon the direction of the X vector. For an example coordinate system and for circular orbits, the satellite motion expression in the geocentric inertial reference system could be defined as:
(26)
And the velocity vector could be defined as:
(27)
h: 	specific angular momentum
ECF (Earth Centered and Fixed) components of the position and velocity vectors could be defined as:
(28)
(29)
where  is a rotation rate of the earth  and  is the Greenwich hour angle of the Earth’s prime meridian, i.e. the angle between the inertial x axis and ECF x axis.
A satellite motion in an elliptical orbit is non-uniform; therefore, the Kepler expression and a concept of a mean anomaly would be used in the model to define the real anomaly as a function of time. Since an explicit dependence of the true anomaly on time is unavailable; the numerical methods of solving the below expressions were used for its definition. The expression is:
(30)
Kepler’s equation  can be solved with Newton-Raphson method to obtain the true anomaly:
(31)
(32)
D6.3.3	Conversion to Generic Cartesian-based Vectors
The conversion to generic Cartesian-based vector would depend upon the direction of the X vector, but an approach based upon the X vector aligned with the direction in which the ascending node longitude is zero is as follows:
1.	For the relevant time t in seconds since simulation start, calculate the values of the processing terms (, , ) as required using the decision tree in § D6.3.5.
2.	From M calculate the eccentric anomaly E using equation (16) and iteration.
3.	From E calculate the true anomaly  using equation (17).
4.	Hence calculate the radius vector R using equation (18).
5.	Calculate the position of the satellite within the orbital plane in (P, Q) coordinates defined as in Fig. 51 below using:
(33)
6.	Create the rotation matrix from satellite orbit coordinates to inertial xyz coordinates using:
(34)
where:
(35)
(36)
(37)
(38)
(39)
(40)
(41)
(42)
(43)
7.	Hence calculate the position of the satellite in xyz coordinates using:
(44)
Figure 51
Definition of satellite P, Q coordinates
D6.3.4	Non-GSO satellite orbit station keeping
An important aspect to station keeping is to simulate multiple passes of the non-GSO satellite through an earth station’s main beam with slightly different crossing directions. As changing the position within the plane does not affect this, then the main parameter to vary is the longitude of the ascending node.
The approach proposed is to give range Wdelta in longitude of ascending node. At the start of the simulation all stations in the constellation have this parameter offset by Wdelta. During the simulation this field would increase to 0 (at the run’s mid-point) and then increase to Wdelta.
This is implemented by rotating the station’s position and velocity vectors around the Z axis by the required angle as specified in § D6.3.4.
D6.3.5	Forced orbit precession
The standard orbit prediction algorithm is based upon point Earth mass plus correcting factors for J2 perturbations. There are two cases where this requires to be over-ridden:
a)	where administrations supply a detailed value of the orbit precession rate with respect to a point Earth mass to ensure a repeat ground track;
b)	for non-repeat orbits where an artificial precession rate is used to ensure the required spacing between equatorial passes.
D6.3.6	Combining the orbit models
The various options for the orbit model can be combined in three ways as shown Fig. 52.
Figure 52
Flowchart of orbit model options
Note that the equatorial orbit i = 0 constellation is a special case in that there is no station keeping but the ground track of each satellite repeats just after one orbit. It should therefore be treated as Case (1) but with forced precession set to zero as described in § D4.
The three cases have their key orbit angles in radians updated as follows:
Case 1
(45)
(46)
(47)
Case 2
(48)
(49)
(50)
Case 3
(51)
(52)
(53)
where:
r  = 	J2 precession of longitude of the ascending node in radians / second
r = 	J2 precession of the argument of perigee in radians / second
= 	orbit motion including the J2 term in radians / second
n0 = 	orbit motion for point mass in radians / second
= 	artificial precession in degrees / second
= 	admin supplied precession in degrees / second
Wdelta = 	station keeping range in degrees
t = 	simulation time in seconds
Trun = 	total run time of the simulation in seconds.
D6.3.7	Mapping orbit parameters from SRS data
The following orbit parameters are given in the SRS / IFIC database:
Table orbit:
–	Apogee height (km) = ha
–	Perigee height (km) = hp
–	Inclination angle (degrees) = INC
–	Right ascension (degrees) = RA
–	Longitude of ascending node (degrees) = LAN
–	Argument of perigee (degrees) = AP.
Table phase:
–	Phase angle (degrees) = PA.
For most of these fields it is possible to map nearly directly to the orbit parameters required, such as:
i = INC
= LAN
= AP
Note that this algorithm uses the ascending node definition based upon longitude rather than right ascension to ensure the orbit is correctly referenced to earth station longitude.
The last field to define is the true anomaly, , which can be derived from the phase angle. The phase angle is defined in RR Appendix 4 as:
The phase angle is shown in Fig. 53.
Figure 53
Definition of phase angle
The true anomaly can therefore be derived from the phase angle as follows:
or:
D6.4	Geometry
D6.4.1	Distance between two stations
Given two station’s position vectors in the form (x, y, z), the distance D between them can be calculated using:
D6.4.2	Distance to Earth horizon
The distance to the horizon Dh for a station with Earth centred position vector of magnitude R can be calculated as follows:
D6.4.3	Satellite visibility check
Two stations, whether earth stations or satellites, are visible if the direct distance between them is less than the sum of the distance to the horizon for each station, using the spherical Earth model described in § D6.1.
D6.4.4	Angle to GSO arc and Longitude
D6.4.4.1	Definition
Figure 54 shows the definition of the  angle.
Figure 54
Definition of  angle
The Figure shows a test earth station and non-GSO satellite.
For each test point Pi on the GSO arc, there is a line from the earth station that intersects that point. There is then an angle i between that line and a line from the earth station to the non-GSO satellite.
The  angle is the minimum of all the test points for which the line does not intersect the Earth, i.e.
The sign of  is determined by whether the line from the earth station to the non-GSO satellite intersects the XY plane at a distance less than or greater than the GSO radius as follows:
Given:
Earth station position vector: 	RES
Non-GSO satellite position vector: 	RNS
Construct line:
where:
This line crosses the XY plane when:
R(z) = 0
i.e. when
Hence:
The sign of , X is then determined by:
If  < 0 then Rz=0 = Infinity
In the case when the ES is in the northern hemisphere:
If Rz=0 < Rgeo then  is positive
If Rz=0 = Rgeo then  is zero
If Rz=0 > Rgeo or if z=0 ≤ 0 then  is negative.
In the case when the ES is in the southern hemisphere:
If Rz=0 > Rgeo then  is positive
If Rz=0 = Rgeo then  is zero
If Rz=0 < Rgeo or if z=0  0 then  is negative.
In the case when the ES is at the equator:
is the negative of the sign of
From the test point identified to give the  angle, the longitude can be calculated between the non-GSO sub-satellite point and the point on the GSO arc where the  angle is minimised, as shown in Fig. 55.
Figure 55
Definition of longitude
Hence:
Long = LongAlpha – LongNGSO
The  iteration should use test points that meet the requirements in § D1.4.
If there are two points on the GSO arc that give the same  (possibly the two edge of visibility points), then the one with the minimum absolute Long should be selected. If both have the same Long but with different signs, then the positive one should be used.
D6.4.4.2	Alpha search range
Note that the GSO arc will be visible to the non-GSO at a height of hnGSO and latitude latnGSO if the difference in longitude is less than:
where:
and:
The range of the GSO arc that will be visible to an ES can be calculated in a similar manner by setting x2 = 0.
D6.4.4.3	Sign of Alpha
Figures 56 and 57 below are provided to give clarity as to the sign of  as seen from the perspective of a non-GSO satellite or non-GSO ES in the northern and southern hemispheres.
When the non-GSO satellite is in the northern hemisphere:
Figure 56
Sign of  as seen by non-GSO satellite in Northern Hemisphere
Figure 57
Sign of  as seen by non-GSO ES in Northern Hemisphere looking South
The geometry for the case when the non-GSO satellite is in the southern hemisphere is shown in Figs 58 and 59 below.
Figure 58
Sign of  as seen by non-GSO satellite in Southern Hemisphere
Figure 59
Sign of  as seen by non-GSO ES in Southern Hemisphere looking North
D6.4.4.4	Analytic method to calculate  and
This section describes an analytic method to calculate the alpha angle and also associated  angles.
Analytic calculation of
The analytic method to calculate  starts with the following two inputs:
P = Position vector of GSO ES, typically with magnitude = radius of the Earth = Re
N = Position vector of non-GSO satellite
These are defined as:
Then assume:
G = Position vector of a point on GSO arc specified by angle  and radius of geostationary orbit Rgeo:
Then  is the minimum over all  of the angle between the lines PN and PG where:
This can be calculated using:
This will be minimised over  when:
Which is also when:
Writing this as:
Then f can be written as:
where:
And g can be written:
where:
Note that D = magnitude of PN is not dependent upon  and so is a constant which need not be considered further.
using:
and noting that:
when:
i.e. when:
using f’ to represent f differentiated by , this can be expanded using standard methods as:
This can be simplified to:
using:
Note there is an alternative solution that uses cos  instead of sin .
Simplified using a new set of parameters {a, b, c, d, e} this is:
where:
This can be expanded and then re-arranged into:
where:
This quartic equation can be solved using a number of techniques, including the use of the Newton-Raphson method. This approach aims to solve a function f of a variable x, using iteration, given an initial value and f’ = the derivative of f using:
where:
The Newton-Raphson method is considered to have converged when the absolute difference between xn and xn+1 is less than 1e-6.
For the starting value, both x = +1 and x = −1 can be used and two solutions derived, matching the two cases of the line from the GSO ES position P to the non-GSO satellite N forward or backwards.
This analytic method does not take account of the range of visibility of the GSO arc as seen by the GSO ES. It is therefore necessary to identify the maximum range of the visible GSO arc, using:
The points on the GSO arc that correspond to max can be considered additional possible solutions. The solution to use is one that is within the range −max to max that results in the smallest alpha angle.
The iterative method may be used as a fall-back should these methods fail to derive suitable solutions to the quartic equation but the preferred approach is analytic.
Analytic calculation of
The beta angle is defined in a similar way to that for  but is minimised over all possible positions of the non-GSO satellite with radius vector Rn and at latitude = lat but unknown longitude, for a given position of the GSO satellite.
The analytic method to calculate  starts with the following two inputs:
P = Position vector of GSO ES, typically with magnitude Rp = radius of the Earth = Re
G = Position vector of GSO satellite with magnitude Rg
These are defined as:
Then assume:
N = 	Position vector of non-GSO satellite at latitude = lat and angle  and radius of geostationary orbit Rn:
Then  is the minimum over all  of the angle between the lines PN and PG where:
This can be calculated using as similar approach above, with f and gr functions:
where:
and:
Note that D = magnitude of PG is not dependent upon  and so is a constant which need not be considered further.
When the parameter set {A, B, C, E, F, G} has been defined then a similar methodology can be used to solve for  as for  above. There can be cases, such as its use in the worst case geometry algorithm, where it is not required to check for visibility.
D6.4.4.5	DeltaLongES
The difference in longitude for a non-GSO ES and a point on the GSO arc, as used in the definition of the ES_e.i.r.p. mask, is defined as follows:
DeltaLongES = Longitude(GSO point) – Longitude(Non-GSO ES)
D6.4.5	Satellite and earth station azimuth and elevation
Figure 60 shows the definition of the azimuth and elevation angles used for the non-GSO satellite:
Figure 60
Definition of azimuth and elevation for non-GSO satellite
It should be noted that direction of the cartesian X, Y, Z vectors in this diagram are:
X:	+ve in the East direction from the non-GSO satellite
Y:	towards the centre of the Earth from the non-GSO satellite
Z:	+ve towards the North direction from the non-GSO satellite.
For the earth station, the definition of the azimuth and elevation angles are as in Fig. 61.
Figure 61
Definition of azimuth and elevation for earth station
It should be noted that direction of the cartesian X, Y, Z vectors in this diagram are:
X:	+ve in the East direction from the earth station in the horizontal plane
Y:	towards the North direction from the earth station in the horizontal plane
Z:	+ve towards the Zenith of the earth station perpendicular to the horizontal plane.
Furthermore, the normalized coordinates, u and v, can be computed from the azimuth and elevation angles as follows:
D6.5	Gain patterns
This section defines the gain patterns used in the algorithms for earth stations and satellites. Note that all formula includes the peak gain, so where relative gain is required, the peak gain should be subtracted.
D6.5.1	GSO earth station gain patterns
D6.5.1.1	FSS earth station gain pattern
The FSS earth station gain pattern to use is specified in Recommendation ITU-R S.1428.
D6.5.1.2	BSS earth station gain pattern
The BSS earth station gain pattern to use is specified in Recommendation ITU-R BO.1443.
D6.5.2	GSO satellite gain pattern
The values of peak gain and half power beamwidth and the antenna reference radiation pattern to use are specified in RR Article 22 based upon Recommendation ITU-R S.672.
The peak gain to use in analysis should be selected using Table 16.
TABLE 16
Peak gain to use with Recommendation ITU-R S.672
D7	Structure and format of results
D7.1	Go/No-go decision
D7.1.1	Overall description of the decision process
The simulation produces a probability distribution function (PDF) of the pfd. The PDF records, for each pfd level, the number of simulation time-steps at which that pfd level occurred divided by the sum of all bins. The PDF should be converted into a cumulative distribution function (CDF) which records for each pfd level the number of simulation time-steps at which that pfd level was exceeded normalized by the total number of simulation time steps.
Note that the term cumulative distribution function is meant to include the concept of the complementary cumulative distribution function depending upon context.
D7.1.2	Production of the CDF
The process detailed in § D5 generated a PDF of the pfd values. This PDF should be converted into a CDF which records for each pfd level an estimate of the percentage of time during which that pfd level is exceeded.
For each pfd value, the CDF should be calculated by:
CDFi = 100 (1 – SUM (PDFmin: PDFi))
where:
PDFx:	PDF table entry for a pfd value of X dB, normalized so that the total sum for all PDFx is 1.
D7.1.3	Comparison procedure
The next stage is the comparison of the pfd limit values in the RR with those in the probability table.
Step 1:	Perform Steps 2 through 4 for each specification limit i.
Step 2:	Read the pfd value/probability pair (Ji and Pi) from the database.
Step 3:	If the pfd value Ji has a higher precision than SB (currently 0.1 dB) round Ji to a lower value with a maximum precision of 0.1 dB.
Step 4:	From the CDF find Pt, the probability that pfd value Ji was exceeded as obtained by the software.
Step 5:	If Pi  Pt then record Pass: the CDF complies with this specification point. Else record Fail: the CDF does not comply with this specification point.
The final stage is the comparison of the maximum pfd value recorded during the software run with the limit specified for 100% time (if any).
From the CDF, find the maximum pfd value recorded during the software run, Jmax. Compare it with the pfd limit specified for 100% time, J100. If Jmax  J100 then record Pass: the CDF complies with this specification point. If Jmax  J100 then record Fail: the CDF does not comply with this specification point.
D7.1.4	Decision process
If a Pass result was recorded for all of the specification limits, then the non-GSO network complies with the specification. If any Fail results were recorded, then the non-GSO network does not comply with the specification.
D7.2	Background information to decision
The background information required is:
–	pfd data generated in the software run (including antenna diameter) and reference antenna pattern;
–	table of specification limits for various antenna diameters and reference antenna pattern.
D7.3	Format for output
The output format should be:
–	statement of the result of the test;
–	summary table;
–	CDF table (for information only).
D7.3.1	Statement of the result of the compliance test
The overall conclusion of the evaluation (Pass or Fail) as defined in § D7.1.4 should be output.
D7.3.2	Summary table
The summary table should show the following data (see Table 17):
TABLE 17
Summary table
D7.3.3	Probability table
The output should include for information the calculated CDF which was used in the decision-making process.
PART E
Testing of the reliability of the software outputs
E1	Evaluation of the computation accuracy of the candidate software
These tests could be performed by the software developer, and the results supplied to the BR along with the candidate software.
Software functions to be evaluated:
Orbit projection – Using a set of simplified parameters which result in a defined repeat period, run the software for the required simulation interval and check the actual (satellite vectors) against the predicted values.
Offset angles – Using appropriate sets of earth station and satellite locations, check the actual beam offset angle values against the predicted values. The sets of test data should cover the most complex trigonometrical cases: for example sites around longitude zero and longitude 180°.
Time step and simulation duration – Using appropriate sets of non-GSO network parameters, check the time step and simulation duration values generated by the software against the predicted values.
CDF generation – Using sets of test input files with known CDF results, verify the CDF generation software.
Go/no-go decision process – Using sets of CDF test input files, verify the accuracy of the go/no-go decision process.
Should multiple implementations be available then sensitivity analysis could be used to evaluate them, and their output can be compared to ensure consistency.
E2	Evaluation of the epfd(↓/↑) statistics obtained by the BR
These are tests which will be performed automatically by the software as part of each run, to confirm that the run did find the worst-case interference events.
epfd value for 100% time – the epfd↓ value for 100% time obtained during the run should be compared with a value calculated from analysis of the non-GSO constellation. The obtained value should be within ±0.X dB of the expected value.
E3	Verification of the pfd masks
The pfd masks are inputs to the BR validation tool to be provided by the notifying administration to the BR together with the software used for its calculation, the complete software description and parameters. The information required to generate the pfd mask could be made available to interested administrations to be used in case of dispute.
E4	Re-testing of the BR software after any modifications or upgrades
A set of tests should be defined for use on any occasions when the BR software or its operating environment has been modified or upgraded. Such tests could include:
a)	some or all of the tests defined in § E1 for the initial evaluation of the computational accuracy of the candidate software;
b)	repetition of a representative set of evaluations of actual non-GSO filings, and comparison of the results obtained by the original and modified software systems.
PART F
Software implementing this Recommendation
F1	Operating system
The software should run on Microsoft platforms under the Windows 10 or higher operating system.
F2	Interfaces to existing software and databases
The BR captures all incoming notices related to space services into one central database for alphanumeric data (SNS) and into another database for graphical data (GIMS) such as antenna diagrams and service areas. These databases are used for the publication of the data on DVD, in the Weekly Circular and its Special Sections. They are also used to provide input data to software packages performing RR Appendix 8 and pfd examinations. Graphical Interface for Batch Calculations (GIBC) is used to carry out examination using these different modules. This guarantees that the data published are also the data used in these examinations. The BR considers this important for both the notifying administration and for administrations the services of which may be affected by the new station. This is not only for the convenience of the BR, but to ensure consistency and transparency towards administrations.
F3	User manual
The purpose of the user manual is to tell the user how to run different tests to obtain certain results. Given the complexity of these tests, they need to be given in detail.

=== R-REC-S.1528-0-200106-I!!MSW-E.docx ===
RECOMMENDATION  ITU-R  S.1528
Satellite antenna radiation patterns for non-geostationary orbit satellite antennas operating in the fixed-satellite service below 30 GHz
(Question ITU-R 231/4)
(2001)
The ITU Radiocommunication Assembly,
considering
a)	that the use of space station antennas with the best available radiation patterns will lead to the most efficient use of the radio-frequency spectrum;
b)	that both elliptical and circular beam antennas are used on operational space stations;
c)	that although improvements are being made in the design of space station antennas, further information is still required before a reference radiation pattern can be adopted for coordination purposes;
d)	that the adoption of a design objective radiation pattern for space station antennas will encourage the fabrication and use of orbit-efficient antennas;
e)	that it is only necessary to specify space-station antenna radiation characteristics in directions of potential interference for coordination purposes;
f)	that for wide applicability the mathematical expressions should be as simple as possible consistent with effective predictions;
g)	that nevertheless, the expressions should account for the characteristics of practical antenna systems and be adaptable to emerging technologies;
h)	that measurement difficulties lead to inaccuracies in the modelling of spacecraft antennas at large off-axis angles;
j)	that the size constraints of launch vehicles lead to limitations in the D/ values of spacecraft antennas;
k)	that a multiple beam antenna on the non-geostationary-satellite orbit (non-GSO) has to provide an earth coverage field-of-view (FOV) of up to  30 half-cone angle from a medium earth orbit (MEO) satellite, and up to  60 from a low earth orbit (LEO) satellite;
l)	that most non-GSO fixed-satellite service (FSS) satellites are planned to use a large number of beams per satellite with either steerable or fixed beams;
m)	that the peak gain of a multiple beam antenna decreases while the side-lobe level increases as a function of the off-axis beam pointing angle;
n)	that the 1st and 2nd side lobes of a multiple beam antenna may be merged into the main beam when the beam is pointed toward or close to the edge of the Earth;
o)	that for a practical antenna, spill-over from the main reflector, subreflector, or diffraction from the supporting structure may significantly affect the accuracy of our estimates in the near-in and far-out side lobe regions;
p)	that actual radiation patterns of some kinds of multiple beam antennas may be significantly different from beam to beam,
recommends
1	that for multiple-beam non-GSO satellite antennas in the FSS having either circular or elliptical beams, the following radiation patterns should be used as a design objective or to perform interference analysis:
1.1	measured antenna patterns
Measured antenna patterns should be used in performing interference analysis whenever they are available.
When a measured pattern is not available, one or other of reference patterns given in the remaining sections may be used:
1.2	the reference pattern given by:
G()  Gm  3 ( /b)                      dBi	for	0	   ab	(1)
G()  Gm  LN  20 log (z)                       dBi	for	ab	   0.5 bb	(2a)
G()  Gm  LN                      dBi	for	0.5 bb	   bb	(2b)
G()  X – 25 log ()                      dBi	for	bb	   Y	(3)
G()  LF                      dBi	for	Y	   90	(4a)
G()  LB                      dBi	for	90	   180	(4b)
where:
X 	Gm + LN  25 log (bb)     and     Y  bb 100.04 (Gm  LN – LF )
b :	one-half the 3 dB beamwidth in the plane of interest (3 dB below Gm) (degrees)
b :	 for minor axis (use actual values if known) (degrees)
b :	(major axis / minor axis)  for major axis (use actual values if known) (degrees)
G() :	gain at the angle  from the main beam direction (dBi)
Gm :	maximum gain in the main lobe (dBi)
LN :	near-in-side-lobe level (dB) relative to the peak gain required by the system design
LF 	0 dBi far-out side-lobe level (dBi)
LB :	back-lobe level (dBi)
z :	(major axis/minor axis) for the radiated beam
LB  15  LN  0.25 Gm  5 log z dBi or 0 dBi, whichever is higher
D :	diameter of the antenna (m)
:	wavelength of the lowest band edge of interest (m).
The numeric values of a, b, and  for LN  –15 dB, –20 dB, –25 dB, and –30 dB side-lobe levels are given in Table 1. The values of a and  for LN  –30 dB require further study. Administrations are invited to provide data to enable the values of a and  for LN  –30 dB to be refined.
NOTE 1 – Patterns applicable to elliptical beams require experimental verification. The values of a and  in Table 1 are provisional.
TABLE  1
The radiation pattern in relative gain vs. /b is shown in Fig. 1.
1.3	the reference pattern given by:
For D /   35:
G()  Gm – 3 ( /b)2                   dBi	for	b	   Y
G()  Gm  Ls – 25 log ( /Y )                   dBi	for	Y	   Z
G()  LF                   dBi	for	Z	   180°
For MEO:
Ls  –12;     Y  2 b
G()  20 log (D / )  3.5 – 25 log ( /b)                   dBi	for	2 b	<   Z
For LEO:
Ls  –6.75;     Y  1.5 b
G()  20 log (D / )  5.65 – 25 log ( /b)                    dBi	for	1.5 b	<  < Z
where:
 :	off-axis angle (degrees)
G() :	gain at the angle  from the main beam direction (dBi)
Gm :	maximum gain in the main lobe (dBi)
b :	one half the 3 dB beamwidth in the plane of interest at the largest off-axis angle
Ls :	main beam and near-in side-lobe mask cross point (dB) below peak gain
LF :	far-out side-lobe level (dBi), ~ 0 dBi for ideal patterns
Y 	b (– Ls / 3)1/2
Z 	Y  100.04 (Gm  Ls – LF )
:	wavelength at the lower band edge of interest (m)
D :	diameter of antenna (m).
The reference pattern is shown in Fig. 2.
Recommended antenna patterns for non-GSO satellite multiple beam antennas operating in the FSS below 30 GHz are given in Annex 1;
1.4	the reference pattern given by an analytical function which models the side lobes of the non-GSO satellite.
In the study of frequency sharing between non-GSO systems, taking into account a non-GSO satellite antenna diagram as realistic as possible allows a more accurate analysis of the interference, while limiting the overestimation of it.
It is proposed to use a circular Taylor illumination function which gives the maximum flexibility to adapt the theoretical pattern to the real one. It takes into account the side-lobes effect of an antenna diagram.
To simplify the function, the peaks of the side lobes have been considered symmetrical which is a conservative assumption in the analysis of the interference.
where:
G(u) :	gain in the direction of the considered point (dB)
Gmax :	maximum gain of the diagram (dB)
1, 2, 3 :	three primary roots of the J1 Bessel function (rad).
where SLR is the side-lobe ratio of the pattern (dB), the difference in gain between the maximum gain and the gain at the peak of the first side lobe.
where l is the number of secondary lobes to consider in the pattern; J0( ) is the Bessel function.
u is a function of both the antenna characteristics and the angle between the sub-satellite point (S is the sub-satellite point) and the illuminated beam as seen from the non-GSO satellite.
where:
(, ) :	coordinates of the test point with respect to the centre of the illuminated beam in the satellite reference (see Fig. 4)
Lr and Lt :	radial and transverse sizes of the effective radiating area of the satellite transmit antenna (m).
The parameters Lr and Lt are to be provided by the non-GSO system as input parameters.
An example of pattern obtained with this analytical function is given in Annex 2.
Further studies are needed to define the bounds of the antenna gain for the nulls that appear when using a Bessel type of function.
ANNEX  1
Examples for recommends 1.3
Example:
LM-MEO satellite antennas (USAMEO-1)
A typical non-steerable MEO satellite antenna has an earth FOV of   22.5
Lens diameter, D /  :	22.6 wavelength at 18.8 GHz
Half power beamwidth, 2 b :	3.2 at 18.8 GHz, scanned 21 off-axis
Gain at 21 off-axis, Gm :	35 dBi
MEO reference radiation pattern
b		1.6			Gm		35
Ls		12			Y		2 b  3.2
LF		3			Z		20.0
G()		Gm – 3 ( /b)2                   dBi	for	b		  Y
	35 – 3 ( /1.6)2		1.6		  3.2
G()		Gm  Ls – 25 log ( /Y )                   dBi	for	Y		  Z
	23 – 25 log ( /3.2)		3.2		  20.0
	35.6 – 25 log ()
G() 	3                   dBi	for	20.0		  180
LEO reference radiation pattern
b		1.6			Gm		35
Ls		6.75			Y		1.5 b  2.4
LF		5			Z		20.4
G()		Gm – 3 ( /b)2                   dBi	for	b		  Y
=	35 – 3 ( /1.6)2
G()		Gm  Ls – 25 log ( /Y )                   dBi	for	Y		  Z
	28.25 – 25 log ( /2.4)		2.4		  20.4
	37.76 – 25 log ()
G()		5                   dBi	for	20.4		  180
Using Recommendation ITU-R S.672
b		1.6			Gm		35
Ls		25			Y		2.887 b  4.62
LF		0			Z		25.4
G()		Gm – 3 ( /b)2                   dBi	for	b	   Y
=	35 – 3 ( /1.6)2		1.6	   4.62
G()		Gm  Ls                   dBi	for 	Y	<   6.32 b
	10			4.62	   10.1
G()		Gm  Ls  20 – 25 log ( /b)                   dBi	for	6.32 b	   Z
	35.1 – 25 log 		10.1	   25.4
G() 	0                   dBi	for	25.4	   180
ANNEX  2
Examples for recommends 1.4
The antenna pattern presented is applicable to a non-GSO satellite system at an altitude of 1 469 km, generating beams on the ground covering a 350 km radius cell (see Fig. 5).
The study is performed at a frequency of 12 GHz.
The three primary roots of the J1 Bessel function are:
1  1.2
2  2.233
3  3.238
In each case, the SLR considered is 20 dB and the number of secondary lobes is four. These two parameters give A  0.95277 and   1.1692.
Lr and Lt are distances on the ground and depend on the beam roll-off (difference between the maximum gain and the gain at the edge of the illuminated beam). The calculation has been performed using roll-off of 7 dB, 5 dB and 3 dB.
The Lr and Lt input parameters to be used are given in Table 2.
TABLE  2*
For a pointing angle 0 of 0, relative to sub-satellite points (see Fig. 5) the results are plotted on the graph in Fig. 6.

=== R-REC-S.740-0-199203-I!!MSW-E.docx ===
RECOMMENDATION  ITU-R  S.740*
Technical coordination methods for 
fixed-satellite networks
(1992)
The ITU Radiocommunication Assembly,
considering
a)	that during the planning stage of a satellite network it is necessary to calculate levels of potential interference between planned and existing networks;
b)	that the methods to determine the need for coordination of satellite networks are given in Appendix S8 to the Radio Regulations and Recommendations ITU-R S.738 and ITU-R S.739;
c)	that once the need for coordination has been identified, it would be necessary to make a technical assessment of the potential for interference between satellite networks;
d)	that ITU-R has reviewed various approaches to the management of the geostationary-satellite orbit;
e)	that the approach used in the detailed technical coordination process is left to the administrations concerned;
f)	that if the potential interference exceeds the allowable criterion, the administrations concerned must agree on the conditions for the operation of their respective networks;
g)	that Recommendations ITU-R S.466, ITU-R S.671, ITU-R S.483, ITU-R S.523 and ITU-R S.735 provide permissible levels of interference between networks of the fixed-satellite service;
h)	that in certain cases there may be a need for multilateral coordination,
recommends
1	that in undertaking detailed technical coordination of fixed-satellite networks, the techniques listed below and described in Annex 1 may be used, by agreement between the administrations concerned in the absence of any other mutually agreed approach:
–	carrier power technique;
–	power density averaging bandwidth technique;
–	isolation technique,
2	that Note 1 should be considered part of this Recommendation:
NOTE 1 – Annexes 2, 3 and 4 contain the methods for the detailed calculations of the above techniques.
ANNEX  1
Technical coordination methods 
for fixed-satellite networks
1	General approach
For the purpose of this Annex, the network seeking access to the orbit is designated A. It is assumed that T calculations, based on information as required under Appendix S4 of the Radio Regulations and as published by the Radiocommunication Bureau for registered networks (a registered network is one whose assignments have been recorded in the Radiocommunication Bureau Master Register), for networks not yet registered but already coordinated, and for networks which are in the process of being coordinated, have established the need to coordinate with networks B, C, D, etc. which may fall in any of the above categories. All such networks have precedence over the applicant’s network A.
2	Coordination process
The coordination process can, for purposes of discussion, be divided into three phases.
The first involves the inspection of the actual or planned transmissions of the involved networks and an assessment of their interaction against “standard” interference criteria.
The second phase of the process is an investigation of potential changes to the transmission plan elements (transmission characteristics, frequency plans) or orbital locations which could lead to a solution of any interference problems identified in phase 1. Generally, the applicant administration will tend to have more latitude in considering such changes to its network than the administration operating an existing system; however, phase 2 would not expect either network to consider the acceptance of serious constraints on its current or planned mode of operation, type, distribution and quality of service. This phase should, through very detailed consideration of all technical and operational parameters, be capable of resolving specific and apparently relatively severe interference situations.
The third phase, if necessary, would be consideration and negotiation of system modifications and adjustments on either or both involved networks. Such changes may affect the quality and type of service and the future growth options of either or both networks.
In dealing with the resolution of interference conditions it must be borne in mind that any specific solutions found for the two networks under consideration may generate or aggravate problems with other networks; this may be particularly significant when considering space station relocations.
3	Technical considerations
Fundamentally, there are two initial facets to the coordination process:
–	agreement on acceptable interference criteria; and
–	agreement on the calculations of the interference.
ITU-R Recommendations may be used for interference criteria but other criteria may be used by mutual acceptance. The calculations generally involve a translation of receiver output criteria to receiver input (RF) criteria and the RF interference path parameters. Since many of the parameters amenable to modification are associated with the RF domain, it may be convenient to classify approaches to coordination in this domain, i.e. based on RF criteria.
3.1	Interference domains
A first step in the coordination process is identification of the interference domains. Each band or band segment common to both networks for each satellite beam in the two space segments must be identified. Within each such band or band segment, those portions over which the space station and earth station receiving sensitivities (G/T) and space station and earth station e.i.r.p. densities remain constant in either network are identified.
This process yields all the interference domains. Certain portions of the spectrum may appear several times because they may represent intra-satellite frequency re-use. Where uplink frequencies and downlink frequencies or satellite beams or both may be paired in a variety of ways (switching of beam connectivity in a space station), all possible operational configurations need to be considered. Further, the number of domains will usually be bounded, at least in current space stations, by the transponder arrangement in the space stations and may, in simple space stations, encompass several or all transponders. Where two space stations have single satellite antenna beams (i.e. common-coverage transmit and receive beams) and all their transponders have uniform characteristics over the common frequency band there would be only one interference domain.
3.2	Coordination approaches
The selection of the methods used to effect coordination is determined by agreement between the participating administrations. The characteristics of the affected networks and the potential severity of the interference will influence the choice of the approach to be used for coordination.
Interference coordination can, in practice, be achieved with a variety of techniques. Among these are:
–	the comparison of the total carrier power characteristics of transmissions with criteria of acceptable received interfering power;
–	the comparison of the power density characteristics of transmissions with criteria of acceptable received interfering power density;
–	the comparison of available inter-network isolation (normalized inter-network coupling loss) with criteria of required isolation between transmissions (normalized wanted-to-unwanted carrier ratio).
For the first case, RF criteria can be expressed as I/N or C/I and for the second case as I0/N0 or C0/I0 where I is the interference power, N is the internal link noise power and C is the desired carrier power and subscript “0” indicates power/Hz averaged over a reference bandwidth. In the third case, interference criteria are expressed in terms of the required C/I between two transmissions, normalized by the carrier-to-noise density ratios C/N0 which characterize the performance requirements of the two transmissions.
3.2.1	Carrier power technique
This technique is most applicable to the following cases:
–	in frequency bands in which satellite networks are well developed and in which the satellite population is relatively high;
–	for modulations which are well defined and may be of any type, e.g. SCPC, analogue, digital, FM/TV, etc.;
–	in frequency bands in which this approach has been extensively used.
The mandatory information required under Appendix S4 of the Radio Regulations is not sufficient to serve as a basis for coordination under an I/N or C/I approach. It is necessary for the applicant administration to submit more detailed information on his network. Other administrations having networks with which the need to coordinate has been established must also furnish more detailed information. To effect coordination using the I/N or C/I approaches requires a full exchange of Appendix S4 data including superscript information for each carrier type, earth-station type and satellite antenna beam within all bands or band segments common to both networks; and where available, individual frequency plans. Since this information is adequate for the C/I approach, it would appear desirable to proceed on this approach, since it provides a more accurate estimate of interference.
The interference domains must first be identified. For each of these it is necessary to identify the transmission (carrier) types which are used or are planned to be used in both networks. In the absence of known frequency plans the worst interference combination of the carriers of the two networks should be assumed. In most cases, this would correspond to frequency coincidence of the carriers. Where frequency plans are known, or where only one arrangement of transmissions in the two networks within a given interference domain is possible, the interference analyses are simplified.
For each domain, interference from each transmission type of one network into each transmission type of the other is calculated for coincident frequency assignments (or, where available, for the actual or planned frequency assignments) in each direction (i.e., from network A into network B and vice versa). Each interfering transmission is assumed to originate at the lowest-gain antenna of a transmitting earth station (i.e., the one having the highest off-axis e.i.r.p.) which does or is expected to use it. When the interfering transmission occupies a bandwidth much less than that of the interfered-with transmission, it should be assumed that transmissions of the interfering type occupy, at appropriate intervals, the whole band occupied by the interfered-with transmission.
It is then necessary to compare the resulting calculated values of C/I with the mutually acceptable single entry values. If these calculations show that acceptable values of C/I result in all cases, then a successful coordination has been effected.
If the interference criteria are not satisfied in one or more cases, then each case must be individually considered. Where the criteria are only slightly exceeded, it may be agreed that these interference levels could be tolerated by either network. In particular, the applicant administration may decide unilaterally that interference into its network, although somewhat exceeding the criteria value(s), would be acceptable and, if there is no other area of disagreement, it could claim immediately successful coordination. Otherwise, a number of measures may need to be considered in order to meet the mutually acceptable criteria.
Annex 2 provides the method for calculating the C/I for GSO satellite networks.
3.2.2	Power density technique
This technique may be most applicable to the following cases:
–	in frequency bands in which satellite networks are in the early stages of development and in which the satellite population is small;
–	for modulations which have a nearly uniform power spectral density, e.g., digital modulations;
–	where initial T/T calculations result in values which are acceptable to each administration. This may be the case for some common domains between the networks;
–	where there is a considerable degree of flexibility in one or both networks so that power density values can be modified.
In this approach, the initial assessment of interference may be made using the Appendix S4 data for each of the interference domains. This assessment can identify the particular domains in which potential interference is most severe and also whether uplink or downlink interference is most dominant. Each party could use the I0/N0 values acceptable to him based on his carrier modulation types.
It is possible that these calculations could result in mutually acceptable values of I0/N0, in which case a successful coordination would have been effected. If the I0/N0 values are not acceptable, then several other steps may be taken. If uplink interference is the dominant source, changes in the uplink power densities and transmission gains may be made to reduce the mutual interference. Additionally, rearrangement of accesses by band segments may be made i.e., a modification of interference domains, so that a greater degree of homogeneity exists between the two networks, thus reducing the mutual interference.
The average power density in a transponder can be used to determine a minimum practical satellite spacing which may be an effective measure of achievable satellite spacing in the coordination process. Since power of a transponder is limited, the power density averaged over the transponder bandwidth is also limited. Using this average power density, a satellite spacing can be determined for a given interference criteria, taking into account expected inhomogeneities in traffic in detailed coordination between the networks. This satellite spacing can be used in the coordination process as a basis for determining achievable satellite spacings. If power densities higher than this average power density exist in a portion of the bandwidth of the transponder, then power densities lower than the average must also exist in other portions of the transponder bandwidth; a condition which can be used in a coordination process.
It may also be appropriate to use reference or averaging bandwidths consistent with the carriers employed instead of the 4 kHz and 1 MHz reference bandwidths of the Radio Regulations. These will generally result in lower values of I0/N0, and can facilitate the coordination process, particularly where narrow-band carriers in one satellite operate opposite wideband carriers in another satellite. In this case, a satellite spacing based upon narrow-band carrier interference criteria may be used to obtain an acceptable interference criteria for the wideband carriers, thus avoiding detailed carrier frequency planning. Interference to narrow-band carriers from wideband carriers will be relatively uniform if the wideband carrier power density is relatively uniform.
The techniques enumerated above have formed a basis for the development of a power density-averaging bandwidth method of determining interference between satellite networks. The method is based on providing a sufficient number of power density-averaging bandwidth data points so that the interference in any bandwidth of interest may be reasonably approximated using the methods described in Appendix S8 of the Radio Regulations. This method may also be used in determining the need to coordinate. The details of this method are described in Annex 3.
Where wideband carriers exhibit higher power densities in small portions of a transponder (analogue FM-TV or high density, low index FDM-FM), minimum satellite spacing may be achieved by the narrow-band carriers avoiding the high power density regions. In this situation, better spectrum utilization may be achieved if triangular function energy dispersal is not used on wideband carriers. However, there may be other factors which would justify the use of some minimal energy dispersal, e.g. consideration of existing systems and protection of terrestrial radio systems.
The C0/I0 approach to coordination is essentially an extension of the I0/N0 approach. In this approach, an additional parameter, the minimum power density in each network is identified. It may be determined that mutually acceptable C0/I0 values are achievable even though acceptable I0/N0 values were not achievable. This approach allows consideration of power compensation in transponders i.e., higher powers could be assigned transmissions subject to greater interference and less power to those with little interference, thus eliminating or moderating individual interference severity. Power compensation would be an operational measure. This C0/I0 approach needs further study and clarification.
3.2.3	Isolation techniques
The conventional and link isolation concepts discussed in Annex 4 offer another coordination method which does not involve the use of transmitted powers, power densities and noise powers.
3.2.3.1	Conventional isolation method
Under the conventional isolation approach a comparison is made between the available inter-network isolation – a measure of the electromagnetic coupling between two networks – and the isolation required between two interfering transmissions.
The required isolation is a fairly precise measure of the interference “incompatibility” between two transmissions, larger required isolation values indicating greater incompatibility. It is expressed in terms of the permissible wanted-to-unwanted carrier power ratio between two transmissions and their respective performance requirements (in the form of the required total link carrier-to-noise density ratio, C/N0, for each transmission).
To apply the isolation concept, one identifies the isolation domains and determines in each domain the available isolation. An isolation domain is characterized by any two networks’ earth and space station antenna radiation characteristics, their receiving system noise temperatures and their link transmission gains.
In each domain, the interfering combinations of carriers are identified. From tables or graphs the required isolation between any two specific carriers is obtained and compared with the isolation available in the appropriate domain. A combination of carriers whose required isolation exceeds the available isolation in the pertinent domain requires that these carriers be coordinated with each other.
The difference between required and available isolation is a quantitative measure of the severity of the incompatibility; its magnitude is a useful guide for the steps to be taken to bring compatibility about.
3.2.3.2	Link isolation method
In this method, the available link isolation is also compared with the required carrier isolation to determine the need for coordination. When the value of available link isolation is less than the required carrier isolation, detailed coordination would be necessary.
Under this approach, the available link isolation is determined on the basis of information concerning the input and output back-offs of the transponder, the satellite e.i.r.p. and saturation flux density together with the major link design parameters. It is not necessary to resort to detailed carrier parameters as needed for the conventional isolation method.
The required carrier isolations are expressed in terms of the applicable single entry wanted-to-unwanted carrier power ratios between two transmissions and their respective downlink carrier-to-noise density ratios.
4	Multilateral coordination
Although the coordination process is typically performed on a bilateral basis, coordination can also be performed on a multilateral basis. This could be the most expeditious means for achieving coordination when satellite networks of more than two administrations are affected. The general methods and techniques described in this Recommendation which may be employed during coordination are applicable to both bilateral and multilateral processes. Several more specific concepts and methods have been developed.
ANNEX  2
Method of calculating carrier-to-interference ratios
in fixed-satellite service networks
1	Method
The interference geometry between two satellite networks is shown in Figs. 1a and 1b. The minimum topocentric (as seen from a point on the Earth) satellite spacing angles should take into account the nominal geocentric satellite spacing angle, the satellite position uncertainties (longitude of the orbit nodes and orbit inclinations) and the geographical locations of the earth stations. The use of the geocentric angular spacing, , instead of the topocentric satellite spacing angle, is simpler for the computation and its use is justified by the fact that the two angles are nearly equal. Also, the topocentric spacing angle is always greater than the geocentric spacing angle and hence the calculations based on geocentric spacing angles are conservative.
Radiocommunication satellites require frequency assignments in two frequency bands, one for the uplink and the other for the downlink. It is current practice for frequency bands to be associated in pairs, one band being used for uplinks and the other for downlinks. Case I below, is concerned with the possibility of interference between two networks which have been assigned frequency bands in this way; thus interference from an uplink enters the wanted uplink and interference from a downlink enters the wanted downlink. However, some networks may use a pair of frequency bands in the reverse sense, the uplink band for one network being the same as the downlink band for the network using an adjacent satellite; in these circumstances interference from an uplink enters the wanted downlink and interference from a downlink enters the wanted uplink. This is Case II.
1.1	Case I
The following propagation conditions are assumed to apply to the uplink and downlink wanted-to-interfering carrier ratios:
–	due to propagation effects and local precipitation both the wanted and the interfering signals which are transmitted by earth stations situated at different points on the Earth’s surface will fluctuate. Unless the e.i.r.p.s of the earth stations are adjusted so that the levels received by the satellites are always the same, a margin should be introduced in calculating the mean interference value to the uplink equation;
–	the ratio of the wanted signal level to the interference level on the downlink does not vary with time. Any interference strong enough to have an appreciable effect would be caused by other satellites close to those of the wanted network so that the discrimination due to the directivity of the earth-station antenna is insufficient to separate the wanted from the interfering signals. Hence the wanted and interfering signals will be attenuated to the same degree when propagation conditions vary, since they will travel through the same disturbed areas. Consequently, fluctuations caused in the received wanted signal will have no significant effect on the level of interference produced in the baseband and, therefore, a downlink margin may usually be neglected.
The computation procedure requires solution of the two equations:
(1)
and
(2)
where:
(C/I)U, D :	uplink and downlink wanted-to-interfering carrier ratios (dB)
Pt, pt :	transmit powers of wanted and interfering carriers delivered to the associated earth-station antenna (dBW)
G1, G4 :	transmit and receive antenna gains of one or more wanted earth stations (dB)
LU :	path loss differential in the uplink to the wanted satellite from the two earth stations,
L  Lwanted – Linterfering               dB
LD :	path loss differential in the downlink to the wanted earth station from the two satellites, L as above (dB)
MU :	uplink margin in the wanted network (dB)
g1() :	antenna gain component at the unwanted earth station towards the wanted satellite (dB)
 :	geocentric minimum angular satellite spacing at the interfering earth station
G2 :	differential in receive antenna gains at the wanted satellite toward the two earth stations,
G2  G2 wanted – G2 interfering               dB
YU :	minimum polarization discrimination between interfering uplink carrier and wanted satellite receive antenna (dB)
YD :	minimum polarization discrimination between interfering downlink carrier and wanted earth-station receive antenna (dB)
E, e :	e.i.r.p. of the wanted and interfering carriers in the direction of the wanted earth station (dBW)
G4() :	antenna gain component at the wanted earth station toward the interfering satellite (dB).
Notes on some of the factors in the above equations:
–	Powers and antenna gains associated with the wanted network are in capitals, those associated with the interfering network use lower case letters. Suffixes associated with the various antenna gains follow the signal path, viz: 1  earth-station transmit, 2  satellite receive, 3  satellite transmit, 4  earth-station receive.
–	The antenna gains g1() and G4() should, if possible, be computed using measured earth-station antenna patterns. However, for preliminary calculations, the generalized earth-station antenna radiation pattern given in Recommendation ITU-R S.465 may be applied.
–	For very precise calculations the topocentric angles may be used in the expressions for g1 and G4.
–	The terms G2, E and e should, if possible, be computed using measured satellite antenna patterns. Variations of path geometry with time may affect these terms; however, these variations are likely to be small and may usually be neglected.
–	In the absence of information on satellite antenna polarization, the factors YU and YD must be set at 0 dB. The subject of polarization discrimination is discussed in ex-CCIR Volume IV.
1.2	Case II
When a given uplink frequency assignment in a wanted network is the same as the downlink frequency assignment in an interfering network, the uplink carrier-to-interference ratio in the wanted network may be approximated by:
(3)
where (in addition to the preceding definitions):
:	differential in receive antenna gains at the wanted satellite, in the directions of the wanted transmitting earth station and the interfering satellite:
e :	satellite e.i.r.p. of the interfering carrier in the direction of the wanted satellite (dBW)
Y  :	minimum polarization discriminations between the interfering-satellite carrier and the wanted-satellite receive antenna (dB)
 :	geocentric minimum angular satellite spacing for the wanted earth station (degrees).
The calculation of interference from an unwanted uplink to the wanted downlink, that is, from an earth-station transmitter into the wanted earth station receiver should be based on the techniques discussed in ex-CCIR Volume IV/IX, Part 2. However, it should be possible to reduce such interference to a negligible level by a careful choice of earth station sites.
1.3	Link wanted-to-interfering carrier ratio
–	For Case I, the overall wanted-to-interfering carrier ratio is obtained by combining the results of equations (1) and (2) using the following:
(4)
–	For Case II, the wanted-to-interfering carrier ratio* is obtained directly from equation (3).
2	General algorithm
A step-by-step method for the calculation of carrier-to-interference levels between two fixed-satellite networks for one set of parameters encompasses the following:
2.1	designate one satellite as the “wanted”, the other as the “interfering” satellite;
2.2	choose the parameters required to solve equations (1), (2) or (3) for one of the potential interference entries and designate the parameters in accordance with § 2.1 above;
2.3	solve, for the set of parameters chosen, equations (1), (2) or (3);
2.4	determine the network wanted-to-interfering carrier ratio in accordance with § 1.3 of this Annex, as applicable;
2.5	using the result of § 2.4 and the modulation and frequency spacing data pertaining to the carriers under investigation, determine, by means of Recommendation ITU-R S.741 the interference noise power in the interfered-with carrier;
2.6	repeat the above steps with the designations of “wanted” and “interfering” satellites reversed, wherever applicable;
2.7	repeat the above steps for all combinations of carrier and earth stations which might be expected to cause interference in the two networks.
NOTE 1 – In some cases a given carrier will be subject to interference from more than one interfering carrier. In such cases, it is permissible to add interference noise contributions on a power basis.
ANNEX  3
A power density-averaging bandwidth method of determining
interference between satellite networks*
1	Introduction
In the process of computing interference between satellite networks, three levels of detail may be postulated:
a)	the initial T/T calculations using Appendix S8 of the Radio Regulations (RR) and RR Appendix S4 data;
b)	if the T/T threshold is exceeded more detailed calculations based on additional information (such as might be contained in RR Appendix S4) where the interference power in carrier bandwidths of interest are estimated; and
c)	if unacceptable interference remains after b), carrier frequency planning may be necessary.
A simple method for determining the interference between satellite networks at the level of detail postulated in a) and b) above is described in the following sections.
2	Description
This method for estimating the mutual interference levels among satellite networks is based on providing sufficient information to allow computation of the interference power I in any interfered-with carrier bandwidth. The interference power I is proportional to the interfering power density p0 times the interfered-with bandwidth of interest br. The worst-case p0 is determined for any transmitting bandwidth bt by finding the portion of a band having a bandwidth bt in which the total power p is maximum and thus p0(bt)  p/bt.
In order to determine I for any carrier bandwidth br it is necessary to have a quantitative power density-averaging bandwidth function over the bandwidths of interest. The total band over which such a function would be provided, is the band over which contiguous or potentially contiguous carriers could exist. This would typically be a transponder bandwidth for the fixed-satellite service. It can be demonstrated that only a small number of averaging bandwidths with associated power densities are needed to reasonably accurately describe a complete power density-averaging bandwidth function over a transponder bandwidth. Judicious selection of the values of averaging bandwidths can result in small reconstruction errors for the total functions (see Appendix 1, § 1 of this Annex).
These power density-averaging bandwidth data points would be provided for the up path (values of Pe and associated bandwidths) and for the down path (values of Ps and associated bandwidths) including the values of Pe and Ps for the currently defined averaging bandwidths. An administration with an interfered-with network could then construct a total function.
Using these reconstructed functions, or the appropriate equations, values for Ts and Te can be computed for all carrier bandwidths of interest using RR Appendix S8. From these values, T/T ’s can be computed for all carriers and the interference power for all carriers can also be computed; i.e. I  T  k  br where k is Boltzmann’s constant. Thus the administration with the interfered-with network can compute for each carrier: T/T, I, I/N, and (knowing the carrier power C), C/I. From this interference information an administration can decide if there is a need to coordinate or that more detailed analyses are required, or that the interference levels are acceptable.
An important requirement for any interference determination method is the ability to properly account for multiple interference sources into a wider band carrier; for example: a number of SCPC carriers transmitted from different earth stations and received by different earth stations in one network which are common sources of interference to a wide bandwidth carrier in an interfered-with network. This method addresses this requirement and accounts for multiple source interference in the determination of the power densities where this situation exists. The power density values where multiple carriers must be taken into account would be limited to very few averaging bandwidths. The important point to note is that these would be determined by the administration for its own network.
Where the transmitting earth stations are identical the power densities and off-axis e.i.r.p. densities can be obtained and will have the same power density-bandwidth functions as the satellite transponder function. When there are differences in the earth-station transmitting antenna gains, the composite power density-bandwidth function can be different from the e.i.r.p. density function. One method which may be used to provide information for estimating up-path interference in a given bandwidth is to provide a power density-bandwidth function for each station type (carriers into all earth stations of one type are assumed to be in one earth station of that type). The off-axis interference from each earth station type can then be computed for bandwidths of interest. The worst-case interference for a given bandwidth can then be estimated by comparing the values from the different earth station types.
A specific implementation of this method is described in Appendix 1 to this Annex and examples are given using this specific implementation to indicate the improvement in accuracy that may be achieved when compared to the current RR Appendix S8 method.
APPENDIX  1

TO  ANNEX  3
Application of the power density-averaging bandwidth method
1	General formulation
Given a band of contiguous, or potentially contiguous, carriers, the worst-case power density p0 in a bandwidth b is determined by finding the portion of the band having a bandwidth b in which the total power p is maximum.
p0  p/b	(5)
Given values of power density p01 and p02 for bandwidths b1 and b2, the maximum value of p0 between b1 and b2 is limited as follows:
for     b1    b    b2 (p02 /p01)	(6)
for     b2 (p02 /p01)    b    b2	(7)
and the minimum p0 between b1 and b2 is:
for     b1    b    b2 (p01 /p02)	(8)
for     b1 (p02 /p01)    b    b2	(9)
The difference between these functions obtained by connecting the data points is the maximum possible error.
When the power densities are expressed in dB(W/Hz), and plotted against bandwidth on a logarithmic scale, the error parallelogram is formed as shown in Fig. 2. As shown in the Figure, the same process is used between subsequent points (P02, b2 and P03, b3, etc.). The error is a function of b and (P01 – P02).
For an equal error between points (P01, b1), (P02, b2), (P03, b3), (P04, b4) etc., a geometric spacing i.e. b2/b1  b3/b2  b4/b3 etc., should be used.
2	Specific formulation
The power density, p, averaged over any bandwidth, b, can be computed by the following expressions, which apply to both the Earth-to-space and space-to-Earth directions:
(10)
and continuing to b  bt.
Single carrier case
The data point (p1, b1) is currently required data. The next most important data point is (pt, bt). For the FSS, bt is most commonly a transponder bandwidth and pt is the transponder power limit pt divided by bt for the space-to-Earth direction. For the Earth-to-space direction pt would be limited to the earth-station transmitter power required to produce the maximum transponder output.
The data point (pt, bt) limits the bandwidth over which p1 can exist and thus extrapolation of p1 to larger bandwidths will not result in unrealistic total powers. Thus with these two data points:
(11)
This represents a worst-case power density-averaging bandwidth envelope for a single carrier of bandwidth bt and for the case of multiple carriers in a given bandwidth.
Multiple carrier case
When multiple carriers are contained in bt it is likely that the power densities for averaging bandwidths between b1 and bt will be lower than given by equation (11). A third data point can be derived for this case from the following information:
–	the largest single carrier power pa and
–	the carrier power pb and its occupied bandwidth bb of the carrier in which pb /bb is largest.
Thus pb /bb is p2 and b2 is bb pa /pb. The worst-case density for any bandwidth b is:
(12)
3	Examples
Single carrier case
A common single carrier access would be a FM/TV carrier. For an example, 36 MHz transponder operating in the 6/4 GHz band with a maximum output power of 4 W is assumed and this carrier uses a 1 MHz frame rate spreading. From this for the space-to-Earth direction:
Pt		6 dBW(4 W) (maximum transponder power)
bt		36 MHz (transponder bandwidth)
b1		4 kHz (averaging bandwidth per RR Appendix S8)
P1		6 – 10 log (1 MHz)  – 54 dB(W/Hz) (maximum power density in 4 kHz due to frame rate energy dispersal).
For this case equation (11) defines the worst case for density as a function of averaging bandwidth:
The Earth-to-space function for a particular earth station would be the same shape with different values for Pt and P1. Example parameters for determining the Earth-to-space power density-averaging bandwidth function are:
Earth-station transmitting antenna gain  55 dB
Earth-station antenna receiving gain  51 dB
Satellite transmitting antenna gain  22 dB
Satellite receiving antenna gain  22 dB
Transmission gain  – 13 dB
Equivalent link noise temperature  275 K.
The earth-station transmitting power to produce a transponder output power of 6 dBW is 19 dBW. Using a bar to designate up-path parameters:
19 dBW (maximum earth-station transmitter power)
36 MHz (width corresponding to )
4 kHz (averaging bandwidth per RR Appendix S8)
19 – 10 log (1 MHz)  – 41 dB(W/Hz) (maximum power density in 4 kHz).
From which the worst-case power density as a function of average bandwidth is:
These up-path and down-path functions are shown in Fig. 3.
Multiple carrier case
For an example of a multiple carrier accessed transponder the same transponder parameters are assumed as for the single carrier case. The single carrier with the highest power Pa is assumed to be a FDM/FM carrier requiring – 3 dBW of transponder power and has a bandwidth ba of 2 MHz. The bandwidth of this carrier should be greater than the reference averaging bandwidth, in this case 4 kHz. The value of Pa /ba is – 66 dB(W/Hz). FM/SCPC carriers are also assumed each requiring -18 dBW of transponder power Pb and 25 kHz of bandwidth bb. The value of Pb /bb is - 62 dB(W/Hz) which is higher than that of the carrier with the highest power. For this type SCPC, Pb can exist in 4 kHz so that P1 is – 54 dB(W/Hz) which is assumed to be the highest power density averaged over 4 kHz in the transponder. Equation (12) applies and the pertinent parameters for the space-to-Earth direction are:
Pt  	6 dBW(4 W) (maximum transponder power)
bt  	36 MHz (transponder bandwidth)
Pa  	– 3 dBW (highest single carrier power)
ba  	2 MHz (bandwidth of Pa)
Pb  	– 18 dBW (power of carrier with highest (Pb /bb))
bb  	25 kHz (bandwidth of Pb)
P1  	– 54 dB(W/Hz) (maximum power density in 4 kHz)
b1  	4 kHz (averaging bandwidth per RR Appendix S8).
Thus the worst-case power density for any averaging bandwidth between 4 kHz and 36 MHz is:
Example parameters for determining the Earth-to-space power density-averaging bandwidth functions are those given for the single carrier access example above plus the following additional earth-station parameters:
Earth-station transmitting antenna gain  47 dB
Earth-station receiving antenna gain  43 dB
Transmission gain  – 21 dB
Equivalent link noise temperature  212 K
These earth-station antenna gains correspond to an antenna diameter of about 4.5 m, while those given previously correspond to a diameter of about 11 m. The 2 MHz carriers are not used with the 4.5 m earth-station antennas. The SCPC carriers are used between any combination of 4.5 m and 11 m earth-station antennas. From this, a set of parameters for each earth-station type is developed. For example purposes, a very worst case is assumed for the Pt for each earth-station type, i.e. the Pt which would produce maximum transponder output power. Again using a bar to denote up-path parameters, the following are the parameters for each earth-station type.
For the 11 m earth stations
19 dBW	 36 MHz
10 dBW	 2 MHz
– 5 dBW	 25 kHz
– 41 dB(W/Hz)	 4 kHz
For the 4.5 m earth stations
27 dBW	 36 MHz
Pb    3 dBW	  25 kHz
– 33 dB(W/Hz)	 4 kHz
Applying equation (12) results in the following:
For the 11 m earth stations
For the 4.5 m earth stations
These functions are shown in Figs. 4 and 5.
The up-path interference is also a function of the off-axis earth-station transmitting antenna gains as well as the power densities. If the off-axis gains were the same for the above examples, then the envelope of the two functions is the worst-case power density for any averaging bandwidth. If the off-axis gains are different, then a worst-case off-axis e.i.r.p. density function can be developed.
Using the above multiple carrier example, T/T calculations may be made where p(b)max is used for ps and  is used for pe in RR Appendix S8. A topocentric angle of 4°, an earth station side-lobe envelope of 29 – 25 log  and co-coverage conditions are assumed. The interfered-with network has the same characteristics as the interfering network except for the carriers. The results of these calculations are shown in Fig. 6. The current RR Appendix S8 calculations show a T/T of 36% for all interfered-with bandwidths. Using this method a T of 14% is indicated for interfered-with carrier bandwidths of 25 kHz to 126 kHz and the T is less than 6% for interfered-with carrier bandwidths greater than 600 kHz. With this method, the numerical value of T/T is equal to the I/N in the interfered-with carrier bandwidth.
4	Data requirements
This power density-averaging bandwidth method has been developed with the view of minimizing the amount of additional data required and the availability of that data and at the same time providing a very significant improvement in the interference estimates.
The data required for the specific implementation can be related to Appendix S4 items of the Radio Regulations.
TABLE  1
Data requirements
*	Optional items: the additional data for Appendix 3 are the asterisk items which are:
–	the power and bandwidth of two particular carriers for both up path and down path; and
–	the aggregate earth station transmitter powers for each earth-station type.
5	Example based on additional information available during coordination
The previous examples were based on information which could be available at the time of submission of RR Appendix S4 data. The following example is used to demonstrate how this method may be used during coordination where the network parameters are more accurately known.
The example parameters given in the multiple carrier case will be used in the following discussion. Since the example considers two different carrier types and two different earth station types, it is sufficient to describe the process that can be used for larger numbers of carrier types and earth-station types. The additional information consists of transponder power by carrier types between the two earth-station types; i.e. number of carriers by type for each earth station connectivity. Table 2 shows an example of the carrier types for different connectivities.
TABLE  2
For the down path, the worst-case power density-averaging bandwidth function is obtained by ordering the connectivities in decreasing power density values; i.e., worst-case carrier frequency placement. The power density-averaging function is determined by the cumulative power in the associated cumulative bandwidth.
This function is shown in Fig. 7 along with the function developed for a multiple carrier case shown in Fig. 4. A substantial reduction in power density for some bandwidth ranges is shown.
For the up path, the earth-station off-axis antenna gain is a factor in determining the interference to another satellite network. If the off-axis gain function is the same for all earth stations, an up-path power density-averaging bandwidth function may be derived in the same manner as the downlink function. If this is not the case, then an off-axis e.i.r.p. density-averaging bandwidth function needs to be developed. To demonstrate this case, it is assumed that the 11 m antenna has a 29 – 25 log  off-axis gain while the 4.5 m antenna has a 32 – 25 log  off-axis gain. The earth-station power densities given in Table 2 are multiplied by the constant in the off-axis gain function and the connectivities are arranged in decreasing off-axis e.i.r.p. density constants. The power density-averaging bandwidth function for this case is shown in Fig. 8 along with the worst-case function for the multiple access case given in Fig. 5. A substantial reduction in power density is shown for bandwidths greater than 500 kHz.
Given these up-path and down-path density functions, the interference power to another network can be computed for any interfered-with carrier bandwidth.
However, it is noted that there is a difference in the connectivity ordering between the up path and down path, i.e. the worst-case earth station carrier placements are different than the satellite. Thus using the two functions given in Figs. 7 and 8 one may overestimate the sum of up-path and down-path interferences. If down-path interference is dominant, then an up-path function based on the down-path carrier connectivity could be used or, vice versa, if up-path interference is dominant. If the up-path and down-path interferences are comparable, then the higher interference level of the down-path or up-path arrangement might be used.
ANNEX  4
Isolation method
1	The concept of isolation
1.1	Conventional isolation method
The isolation between two networks can be derived as follows: in the basic c/i equation (see Table 3 of this Annex for a definition of symbols):
(13)
the ratios and  can be substituted from the internal uplink and downlink power budgets in the interfering and interfered-with networks as follows:
(14)
(15)
Defining
(16)
(17)
and transferring b,  (c/n) and (c/n) to the left-hand side produces the “isolation equation”:
(18)
The left-hand side of equation (18) contains only parameters describing interfering transmissions and their interaction, and its magnitude is called the required isolation; the right-hand side comprises predominantly major network design characteristics, is equal to the inter-network coupling loss and is called the available isolation. Since the two parameters  and  are topocentric inter-satellite spacings, the available isolation is a function of intersatellite spacing.
TABLE  3
Definition of symbols used
From equation (14), required and available isolation may be defined as follows:
Required isolation is defined as the wanted-to-unwanted carrier power ratio c/i required to protect one transmission against unacceptable interference from another, normalized with respect to the necessary carrier-to-noise density ratios c/n0 of the two transmissions.
and:
Available isolation (inter-network coupling loss) of a network A relative to a network B is defined as the ratio of powers received at two points from a transmission originating in network B, normalized with respect to the effective noise temperatures at the points of reception. The two points of reception are the receivers in network B and network A, respectively.
The basic isolation equation is subject to further refinement:
–	when an interfering transmission has a smaller necessary bandwidth than the wanted transmission, some allowance for additional interference contributions in the c/i term must be made. It would be convenient to assume that, in such a case, all interference would be due to an array of interfering carriers of the same type, equally spaced in frequency. In the case of interfered-with FM transmissions, if (c/i)req j were to denote the required c/i ratio for the j-th interfering carrier, and if it were assumed to produce the total permitted interference, the effective c/i which should be used for the c/i term of the left-hand side of equation (18) would be:
(19)
with the summation of the contributions of all carriers whose necessary bandwidths overlap that of the interfered-with carrier. An equivalent expression can be derived for the case of a digital transmission that is subject to interference;
–	in some cases, uplink and downlink polarization discrimination may be available. Such discrimination would increase the available isolation or decrease the required inter-satellite spacing. Good estimates of polarization discrimination are available for conditions of satellite collocation and co-coverage (,  , ,   0). For other conditions, additional data should be collected;
–	the terms ,  and  are not independent of the transmission parameters assumed. The term is controllable through the incorporation of suitable satellite gain steps in the satellite design and the choice of appropriate settings, thereby affecting uplink power requirements. The link noise temperatures  and  could be split into transmission-dependent and transmission-independent components; the transmission-dependent components could be made part of required isolation;
–	the isolation concept needs to be adapted to be usable with networks which have only uplink or only downlink interference, or have other than simple frequency-translating satellite transponders;
–	account needs to be taken of the condition  and/or    0, i.e. where service areas overlap.
One type of homogeneity implies equality of all major design and operating parameters in the two (or more) networks. Another type of homogeneity implies equal reciprocal required intersatellite spacing for two networks. Equality in the value of available isolation for two networks, each with respect to the other, generally does not imply equality in the corresponding required intersatellite spacing, i.e. equal reciprocal available isolation does not produce intersatellite spacing homogeneity. The same holds true for the generalized parameters C/I and T/T. Two systems are homogeneous if while calculating actual interference, a permissible value in one direction is achieved at a satellite angular separation 1-2 and inversely at 2-1, and 1-2  2-1. These homogeneous systems may change their parameters and still have the same required isolation.
Examples of application
Table 4 shows a matrix of carrier types, giving the isolation that would be required between networks to limit the single-entry interference to 600 pW0p and to 4% of the baseband noise for TV.
TABLE  4*
Required isolation** between transmissions (dB)
1.2	Link isolation method
In the link isolation method, equation (18) is further modified by replacing the c/n cluster in the right-hand bracketed term by appropriate alternative terms. From ITU-R Recommendation ITU-R S.738 Annex 1 with a slight modification of equation (14):
(20)
where:
u :	wavelength of uplink carrier
bi, b0 :	input and output transponder back-off, respectively
esat :	transponder saturated e.i.r.p.
fsat :	saturation power flux-density.
Combining the parameters of (20) for the wanted and interfering networks and inserting its result into (18) yields:
(21)
It is noted that although the square-bracketed term of equation (21) is basically independent of carrier-combination,  and  are both carrier specific.
The dependency of the available isolation on the carrier parameters is dealt with in the following way.
The link noise temperature  is expressed as follows:
(22)
where T4 is the receive noise temperature of the earth station. By substituting equation (22) into equation (21), the terms (c/n) and (c/n) appear on both sides of equation (21) and they can be eliminated. Furthermore, moving the terms (c/n)d and (c/n)d to the left-hand side yields the link isolation equation as follows:
(23)
where h  b1/b0 and  Since h and h are the transponder operating parameters, they are constants for all carriers involved in the concerned links* (linear and non linear transponder operations would yield different constant values of h and h).
By analogy with the conventional isolation method, the left-hand side of equation (23) is called the required carrier isolation and the right-hand side is the available link isolation.
The available link isolation is uniquely determined given information on transponder gain-setting and operating back-offs along with the major network characteristics including transmit and receive earth-station types. The available link isolation for a pair of links is, therefore, constant irrespective of the specific carriers transmitted on either link.
The required carrier isolations are link-specific, but representative values can be determined through theoretical analysis and/or statistical analysis of data available for existing satellite networks.
Examples of the required isolation values for some carrier combinations are given in Table 5. These values were obtained by analysing operational carrier parameters as well as using appropriate ITU-R criteria for single entry interference.
If interference is either in the uplink only or in the downlink only, a slightly different expression for equation (23) will result. However, the main features of the link isolation method described above remain the same.
TABLE  5
Means and standard deviations of required carrier isolation,
derived from the link isolation method (dB)
